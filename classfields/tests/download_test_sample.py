from vsml_common.utils.yt import download_from_yt
import subprocess

if __name__ == '__main__':
    # pytest_history_sample folder is generated by
    # https://yql.yandex-team.ru/Operations/Xqgj9p9LnhPbtJWPrIlFI-U7UAdiYY-11K0gCAmZIwM=
    download_from_yt('//home/verticals/realty/users/vykukushkin/vin-tf/pytest_history_sample',
                     'history_sample.json', format_='json')
    download_from_yt('//home/verticals/realty/users/vykukushkin/vin-tf/pytest_features_sample',
                     'features_sample.json', format_='json')
    download_from_yt('//home/verticals/realty/users/vykukushkin/vin-tf/pytest_probas_sample',
                     'probas_sample.json', format_='json')

    for file in ['history_sample.json',
                 'features_sample.json',
                 'probas_sample.json']:
        subprocess.run(f"gzip {file}.gz {file}", shell=True)
