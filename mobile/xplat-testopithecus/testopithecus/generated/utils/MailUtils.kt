// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM utils/mail-utils.ts >>>

package com.yandex.xplat.testopithecus

import com.yandex.xplat.common.*
import com.yandex.xplat.eventus.common.*
import com.yandex.xplat.eventus.*
import com.yandex.xplat.mapi.*
import com.yandex.xplat.testopithecus.common.*

public fun reduced(id: ID): String {
    val s = id.toString()
    return s.slice(s.length - 3, s.length)
}

public fun getRandomInt32(max: Int): Int {
    return doubleToInt32(floorDouble(randomDouble() * int32ToDouble(max))) % max
}

public fun display(email: Email): String {
    return "${email.login}@${email.domain}"
}

public fun formatFolderName(folderName: FolderName, parentFolders: YSArray<FolderName> = mutableListOf()): FolderName {
    val result = copyArray(parentFolders)
    result.add(folderName)
    return result.joinToString("|")
}

public fun fakeMid(): Long {
    return int64(-1)
}

public fun <T> resolveThrow(action: () -> T, defVal: T): T {
    try {
        return action()
    } catch (e: RuntimeException) {
        return defVal
    }
}

public fun removeAllNonLetterSymbols(str: String): String {
    val tags = mutableListOf("<br />", "<p>", "</p>", "<br>", "\r", "\n")
    var result = str
    tags.forEach(__LBL__MailUtils_1@ {
        tag ->
        result = stringReplaceAll(result, tag, "")
    })
    return result
}

public fun formatLogin(login: String): String {
    val index = login.lastIndexOf("-")
    return "${login.slice(0, index)}.${login.slice(index + 1, login.length)}"
}

public open class TextGenerator {
    open fun generateRandomString(charSet: String, length: Int): String {
        val result: YSArray<String> = mutableListOf()
        while (result.size < length) {
            result.add(charSet.split("")[getRandomInt32(charSet.length)])
        }
        return result.joinToString("")
    }

    companion object {
        @JvmStatic var basicLatin: String = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_-+=/|~:; "
        @JvmStatic var lowerCaseLatin: String = "abcdefghijklmnopqrstuvwxyz"
    }
}

