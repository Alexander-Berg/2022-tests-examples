// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM model/unbind-card-model.ts >>>

package com.yandex.xplat.testopithecus.payment.sdk

import com.yandex.xplat.common.*
import com.yandex.xplat.eventus.common.*
import com.yandex.xplat.testopithecus.common.*
import com.yandex.xplat.payment.sdk.*

public open class UnbindCardModel(private val paymentMethodsListModel: PaymentMethodsListModel, private val paymentButtonModel: PaymentButtonModel): UnbindCard {
    private var doneButtonShown: Boolean = false
    private var editButtonShown: Boolean = false
    open override fun waitForUnbindCard(mSec: Int): Boolean {
        return true
    }

    open override fun getCards(): YSArray<String> {
        return this.paymentMethodsListModel.getMethods().filter( {
            pm ->
            !mutableListOf(PaymentMethodName.otherCard, PaymentMethodName.sbp).contains(pm)
        }).filter( {
            pm ->
            !pm.startsWith(PaymentMethodName.familyPayPrefix)
        })
    }

    open override fun unbindCard(index: Int): Unit {
        this.paymentMethodsListModel.deleteMethod(this.getCards()[index])
    }

    open override fun isDoneButtonShown(): Boolean {
        return this.doneButtonShown
    }

    open override fun tapOnDoneButton(): Unit {
        this.doneButtonShown = false
        this.editButtonShown = this.checkHasCardsToUnbind()
        this.paymentButtonModel.setButtonText(PaymentButtonLabel.select)
    }

    open override fun isEditButtonShown(): Boolean {
        return this.editButtonShown
    }

    open fun checkHasCardsToUnbind(): Boolean {
        return this.getCards().size > 0
    }

    open fun setEditButtonShowingStatus(shown: Boolean): Unit {
        this.editButtonShown = shown
    }

    open override fun tapOnEditButton(): Unit {
        this.doneButtonShown = true
        this.editButtonShown = false
    }

}

