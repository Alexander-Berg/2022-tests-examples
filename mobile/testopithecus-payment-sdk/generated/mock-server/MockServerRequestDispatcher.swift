// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM mock-server/mock-server-request-dispatcher.ts >>>

import Foundation

open class MockServerRequestDispatcher: HttpRequestHandler {
  private let matchers: YSArray<MockServerRequestMatcher> = YSArray()
  private let notFoundRequestHandler: HttpRequestHandler
  public init(_ notFoundRequestHandler: HttpRequestHandler) {
    self.notFoundRequestHandler = notFoundRequestHandler
  }

  @discardableResult
  open func handleRequest(_ request: HttpRequest) -> HttpResponse {
    for handler in self.matchers {
      if handler.canHandleRequest(request) {
        return handler.handleRequest(request)
      }
    }
    return self.notFoundRequestHandler.handleRequest(request)
  }

  @discardableResult
  open func match(_ matcher: MockServerRequestMatcher) -> MockServerRequestDispatcher {
    self.matchers.push(matcher)
    return self
  }

  @discardableResult
  open func matchPath(_ path: String, _ handler: HttpRequestHandler) -> MockServerRequestDispatcher {
    self.matchers.push(MockServerRequestMatchers.path(path, handler))
    return self
  }

  @discardableResult
  open func matchPathPrefix(_ pathPrefix: String, _ handler: HttpRequestHandler) -> MockServerRequestDispatcher {
    self.matchers.push(MockServerRequestMatchers.pathPrefix(pathPrefix, handler))
    return self
  }

}

