components: geoproduct
testing:
  - regress
tags:
  - advertisement

specs:
  Отображение рекламной строки в миникарточке организации с геопродуктом:
    - info: |
        На спане карты отображается город Москва
    - do: Тап по строке поиска
    - assert: Отображается экран поиска
    - do: Тап по одной из поисковых категорий (например "Красота")
    - assert: |
        Отображается экран поисковой выдачи на карте
        На карте отображаются пины поисковой выдачи
    - do: Свайп вниз по списку организаций
    - assert: Список организаций свернулся до микросостояния
    - do: Тап по пину организации с геопродуктом и ярлыком акции (например Салон красоты Сахар)
    - assert: |
        Пин организации поднялся
        Отображается мини карточка организации:
          Вверху карточки отображается название организации с бейджом геопродукта, список рубрик и рейтинг организации
          Ниже отображается рекламная строка с текстом зеленого цвета
    - do: Тап по рекламной строке
    - assert: |
        Отображается карточка "Подробности акции"
        В карточке отображается условия акции
        Может отображаться кнопка "Перейти на сайт"
        В верхнем правом углу карточки отображается кнопка "Закрыть"
    - do: Тап по "Перейти на сайт" (при наличии)
    - assert: Отображается веб-вью сайта
    - do: Тап на Закрыть
    - assert: Отображается карточка "Подробности акции"

    - platforms:
       - ios
       - android
    - testing:
       - acceptance_maps
    - tags:
       - assessors
       - use_map


  Отображение новой рекламной строки в полной карточке организации с геопродуктом:
    - info: |
        На спане карты отображается город Москва
    - do: Тап по строке поиска
    - assert: Отображается экран поиска
    - do: Тап по одной из поисковых категорий (например 'Красота')
    - asssert: |
        Отображается экран поисковой выдачи на карте
        На карте отображаются пины поисковой выдачи
        Среди пинов поисковой выдачи отображаются пины организаций с геопродуктом (зеленые пины)
        Внизу экран отображается список организаций
        Если организация с геопродуктом, то рядом с ее названием отображается бейдж геопродукта (белая стрелка в зеленом круге)
        Новый геопродукт отличает наличие ярлыка акции возле пина на карте (зеленый ярлык с изображением процента), аналогичным ярлыком возле текста рекламы в поисковом сниппете и зеленым текстом рекламы -
        В результатах поиска может отображаться брендированный геопродукт с картинкой на пине
    - do: Свайп вниз по списку организаций
    - assert: |
        Список организаций свернулся
        Результаты поиска свернуты
        Над поисковой строкой фильтры
    - do: Тап по пину организации с геопродуктом с ярлыком акции (например Салон красоты Сахар)
    - assert: |
        Пин организации поднялся
        Отображается мини карточка организации:
          Вверху карточки отображается название организации с бейджом геопродукта, список рубрик и рейтинг организации
          Напротив названия отображается крестик
          Ниже отображается время работы организации, напротив расстояние и может отображаться время доезда
          Ниже отображается рекламная строка с текстом зеленого цвета
          Внизу миникарточки отображается блок с экшн-кнопками: маршрут, зеленая рекламная кнопка, позвонить, поделиться, добавить в закладки, сайт (обязательно отображается только кнопка маршрута и сохранения в закладки, другие могут отсутствовать)
    - do: Тап по мини карточке организации
    - assert: Отображается полная карточка организации
    - do: Тап по рекламной строке
    - assert: |
        Отображается карточка “Подробности акции”
        В карточке отображается условия акции
        В верхнем правом углу карточки отображается кнопка 'Закрыть'
        Может присутствовать кнопка 'Перейти на сайт'
    - do: Найти карточку с акцией в которой присутствует кнопка 'Перейти на сайт'
    - do: Тап по 'Перейти на сайт'
    - assert: Отображается веб-вью сайта
    - do: Тап на Закрыть
    - assert: Отображается карточка “Подробности акции”

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
      - lite_acceptance_maps
    - tags:
      - assessors
      - use_map
      - newbie


  Отображение блока От бизнеса в карточке организации с геопродуктом:
    - info: |
        (Блок может отсутствовать, тогда скип)
        На спане карты отображается город Москва
    - do: Выполнить поиск организации, у которой в карточке присутствует блок ”От бизнеса“, например, ”SOS.CAFE' / Свои -  Москва, ул.Мясницкая 11, Москва
    - assert: |
        Пин поднялся
        Отображается мини карточка организации:
          - Вверху карточки отображается название организации с бейджом геопродукта, список рубрик и рейтинг организации
          - Напротив названия отображается крестик
          - Ниже отображается время работы организации, напротив время доезда и расстояние
          - Ниже может отображаться рекламная строка
          - Внизу миникарточки отображается блок с экшн-кнопками: маршрут, может отображаться зеленая рекламная кнопка, позвонить, поделиться, добавить в закладки, сайт (обязательно отображается только кнопка маршрута и сохранения в закладки, другие могут отсутствовать)
    - do: Тап по миникарточке организации
    - assert: Отображается полная карточка организации
    - do: Просвайпать карточку до блока с детальной информацией об организации (например телефон, сайт, кухня, средний счет и тд)
    - assert: |
        Под кнопкой iOS 'Исправить неточность' / Android 'Исправить информацию об организации' отображается блок 'От бизнеса'
        Напротив заголовка отображается дисклеймер 'Реклама'
        В блоке прописана информация об организации
        Если текст не вмещается в блок, то в нижем левом углу блока отобразится кнопка 'Еще'
    - do: Тап по тексту блока 'От бизнеса'
    - assert: Ничего не произошло
    - do: Тап по кнопке 'Еще'
    - assert: Отображается полный текст блока 'От бизнеса' - Кнопка 'Еще' изменила состояние на 'Свернуть'
    - do: Тап по кнопке 'Свернуть'
    - assert: Блок 'От бизнеса' свернулся до дефолтного - Кнопка 'Свернуть' изменила состояние на 'Еще'

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - use_map


  Отображение блока Товары и услуги в карточке организации без геопродукта:
    - info: |
        Отображается главный экран приложения
        ММП в Москве
    - do: |
        Открыть негеопродуктовую карточку организации с блоком Товары и услуги
        Напр., [collapsed-image](https://jing.yandex-team.ru/files/linakolpakova/орг.png){title=QR-код}

        `https://yandex.ru/maps/org/salon_krasoty_artsalon/105808470928`
        Напр., [collapsed-image](https://jing.yandex-team.ru/files/linakolpakova/орг2.png){title=QR-код}

        `https://yandex.ru/maps/org/kristina/1937273214`
    - do: Проскроллить до блока 'Товары и услуги'
    - assert: |
        Если в блоке 'Витрина' не добавлены фотографии:
        Отображается вертикальный список товаров и услуг, указано название товара/услуги и цена, фото не отображаются
        Если в блоке 'Витрина' добавлены фотографии:
        Над блоком 'Вызвать такси' отображается блок 'Товары и услуги'
        Отображается горизонтальный список товаров/услуг, у каждого товара/услуги отображается фотография, название и цена
        В нижней части блока 'Витрина' отображается кнопка “Посмотреть все товары и услуги” с иконкой в виде раскрытого буклета меню

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors


  Проверка работы СTA-кнопки для перехода на сайт организации в вебвью:
    - info: Открыт экран поиска
    - do: |
        Выполнить поисковый запрос по категории и тап по сниппету геопродукта
        [collapsed-image](https://jing.yandex-team.ru/files/vmnpopkova/cta.png){title=QR-код}

        `https://yandex.ru/maps/org/bocconcino/1051563161`
    - assert: Отображается миникарточка организации
    - do: Открыть полную карточку организации
    - assert: |
        Открыта полная карточка организации
        Под блоком с рекламой отображается геопродуктовая рекламная кнопка
        В нижнем баре с кнопками рекламная кнопка не отображается
    - do: Свернуть карточку до миникарточки
    - assert: |
        Отображается миникарточка
        Рекламная кнопка отображается в баре с другими кнопками
    - do: Развернуть миникарточку
    - assert: |
        Открыта полная карточка организации
        Под блоком с рекламой отображается геопродуктовая рекламная кнопка
        В нижнем баре с кнопками рекламная кнопка не отображается
    - do: Тап на рекламную кнопку
    - assert: Осуществляется переход на сайт организации
    - do: Вернуться в Карты
    - assert: |
        Отображается полная карточка организации
        Под блоком с рекламой отображается геопродуктовая рекламная кнопка

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - newbie


  Отображение карточки Подробности акции c фото:
    - info: |
        Устройство в вертикальной ориентации
        На спане карты отображается г. Москва
        Отображается поисковая выдача по запросу Где поесть
        Список организаций свёрнут
    - do: Тап на пин с геопродуктом ('%' в правом верхнем углу пина)
    - assert: |
        Отображается мини-карточка организации
        Отображается геопродуктовая акция
    - do: Тап по акции
    - assert: |
        Отображается карточка Подробности акции
        - Под заголовком карточки отображается фото
        - В правом верхнем углу карточки отображается кнопка закрытия
        - Ниже отображается текстовая информация об акции - На фотографии отображается дисклеймер 'реклама'
        - Если рекламный текст не помещается в карточке рекламы, то карточку можно проскроллить
        - Внизу может быть кнопка Перейти на сайт
        [collapsed-image](https://jing.yandex-team.ru/files/trofim9911/Подробности%20акции.png){title=QR-код}
    - do: Изменить ориентацию устройства
    - assert:  |
        Устройство в горизонтальной ориентации
        Отображается карточка Подробности акции
        Остаётся возможность скролла карточки, если контент не умещается в видимой области
    - do: Тап по кнопке Перейти на сайт
    - assert: Отображается сайт организации в веб-вью
    - do: Тап по Закрыть
    - assert: Отображается карточка рекламы
    - do: Тап по 'Закрыть'
    - assert: |
        Карточка рекламы закрылась
        Отображается мини-карточка организации

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
      - lite_acceptance_maps
    - tags:
      - assessors
      - use_map
      - newbie


  Отображение карточки Подробности акции без фото:
    - info: |
        Устройство в вертикальной ориентации
        На спане карты отображается г. Москва
        Отображается поисковая выдача по запросу Где поесть
        Список организаций свёрнут
    - do: Открыть карточку организации с акцией в строке с геопродуктом, без изображения в рекламе
    - assert: |
        Отображается мини-карточка организации
        В мини-карточке организации отображается геопродуктовая акция
    - do: Тап по акции
    - assert: |
        Отображается карточка Подробности акции
        - В правом верхнем углу карточки отображается кнопка закрытия
        - Ниже отображается текстовая информация об акции
        - Внизу может отображаться кнопка Перейти на сайт
        - Фото в карточке рекламы не отображается
        - Место под фото не выделено
    - do: Тап по кнопке Перейти на сайт
    - assert: Отображается сайт организации в веб-вью
    - do: Тап по Закрыть
    - assert: Отображается карточка рекламы
    - do: Изменить ориентацию устройства
    - assert:  |
        Устройство в горизонтальной ориентации
        Отображается карточка Подробности акции
        Остаётся возможность скролла карточки, если контент не умещается в видимой области
    - do: Тап по кнопке Перейти на сайт
    - assert: Отображается сайт организации в веб-вью
    - do: Тап по Закрыть
    - assert: Отображается карточка рекламы
    - do: Тап по Закрыть
    - assert: |
        Карточка рекламы закрылась
        Отображается мини-карточка организации

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - assessors
        - use_map


  Отображение старой рекламной строки в карточке организации:
    - info: |
        Старая рекламная строка (реклама без акции) отображается в карточке черным цветом (в темном режиме белым)
        Сейчас в некоторых карточках геопродукта может не быть рекламы, это нормально.

        Precondition:
          1. На спане карты отображается город Москва
          2. Произведён поиск по категории 'Где поесть'
    - do: Тап по рекламной строке без акции в поисковом сниппете
    - assert: Отображается полная карточка организации. Экран подробностей акции не отображается в старом геопродукте
    - do: Тап на крестик
    - assert: |
        Отображается поисковая выдача по категории.
        Отображается пины результатов поиска на карте
        Отображается список результатов поиска
    - do: Свайпнуть карту или изменить масштаб
    - assert: Список организаций свернулся
    - do: Тап по пину геопродукта без ярлыка с изображением процента
    - assert: |
        Пин организации поднялся.
        Отображается мини карточка организации:
          - Вверху карточки отображается название организации с бейджом геопродукта, список рубрик и рейтинг организации
          - Напротив названия отображается крестик
          - Ниже отображается время работы организации, напротив время доезда и расстояние
          - Ниже отображается рекламная строка, текст рекламы черный (в темном режиме белый)
          - Внизу миникарточки отображается блок с экшн-кнопками: маршрут, зеленая рекламная кнопка, позвонить, поделиться, добавить в закладки, сайт (обязательно отображается только кнопка маршрута и сохранения в закладки, другие могут отсутствовать)

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors
      - use_map


  Отображение карточки с геопродуктом без рекламного текста:
    - info: |
        На спане карты отображается город Москва
    - do: Тап по строке поиска
    - assert:  Открылся экран поиска
    - do: Тап по поисковой категории 'Где поесть'
    - assert: |
        Отображается поисковая выдача по категории
        Отображается пины результатов поиска на карте
        Отображается список результаов поиска
    - do: Тап по карточке геопродукта без изображения процента без текста в блоке под рейтингом
    - assert: |
        Отображается полная карточка организации
        Возле названия присутствует бейдж геопродукта (зеленый)
        Под блоком рейтинга рекламный блок не отображается

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors
      - use_map


  Брендированный геопродукт:
    - do: Тап по строке поиска
    - assert: Открылся экран поиска
    - do: Произвести поиск по запросу Где поесть
    - assert: |
        Отображаются результаты поиска по запросу Где поесть
        На карте отображаются поисковые пины
    - do: Свернуть список свайпом вниз
    - assert: |
        Список свернут
        Среди пинов на карте присутствует брендированные пины
    - do: Тап на брендированный пин
    - assert: |
        Пин активен
        Открылась мини-карточка организации
        Возле названия организации отображается зеленый бейдж геопродукта
        Под блоком с рейтингом может присутствует рекламный блок с рекламным текстом и дисклеймером 'Реклама'
    - do: Раскрыть карточку до полной
    - do: Пролистать карточку
    - assert: |
        Отображается надпись 'Владелец следит за актуальностью информации'
        Ниже бейдж геопродукта и текст 'Приоритетное размещение'
    - do: Тап на блок Владелец следит за актуальностью информации
    - assert: Отображается информация с кнопкой Подробнее
    - do: Тап на Подробнее
    - assert: Отображается веб-вью с информацией о знаке "Информация подтверждена владельцем"

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors
      - use_map
      - mapkit_ready
      - newbie
    - integration_run:
      - mapkit


  Отображение подмешанного геопродукта:
    - info: |
        Подмешанные пины отображаются жирным шрифтом, а при удалении поиска данный пин развыделяется
        Если пин не отображается, попробовать поменять спан карты
        Отображается главный экран приложения
        На спане Москва
    - do: Тап по строке поиска
    - assert: Открылся экран поиска
    - do: Ввести название организации (напр., Макдоналдс)
    - do: Тап Найти
    - assert: |
        Отображается поисковая выдача
        Отображаются пины искомого заведения
        В списке поисковой выдачи искомое заведение
        На карте отображаются пины подмешанного геопродукта
        На пинах могут присутствовать признаки акций (проценты и т.п.)
    - do: Тап по пину подмешанного геопродукта
    - assert: |
        Отображается миникарточка организации
        Пин активен
        Цвет пина не меняется
    - do: Закрыть карточку организации
    - assert: |
        Миникарточка организации закрывается
        Поисковая выдача свернута (если была свернута ранее)
        Пин не активен
        Цвет пина не меняется
    - do: Тап по пину искомой организации
    - assert: |
        Открыта миникарточка организации
        Пины подмешанного гепродукта не исчезают с карты
    - do: Открыть полную карточку организации
    - do: Перейти в таб Филиалы
    - assert: В табе не отображается подмешанный геопродукт

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors
      - use_map
      - newbie
    - integration_run:
      - kotlin


  Отображение подмешанного геопродукта при поиске одной организации:
    - info: Отображается главный экран приложения
    - do: Тап по поисковой строке
    - assert: Отображается экран поиска
    - do: Ввести в поисковую строку название организации (напр., Грека Гирос в Москве, Шарден в Туле)
    - assert: Отображается список подсказок организаций с похожими названиями
    - do: Тап по подсказке с организацией
    - assert: |
        Отображается миникарточка искомой организации
        Отображается поднятый пин организации на карте
        Отображаются пины подмешанного геопродукта
    - do: Тап по пину подмешанного геопродукта
    - assert: |
        Отображается миникарточка организации
        В карточке может отображаться рекламная информация

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - integration_run:
      - mapkit
    - tags:
      - use_map
      - assessors
      - mapkit_ready


  Отображение подмешанного геопродукта при поиске по сетевому запросу:
    - info: Открыт спан Тулы
    - do: Тап по строке поиска
    - assert: Открылся экран поиска
    - do: Произвести поиск по названию сетевой организации (напр., Мр Кап в Туле)
    - assert: |
        Отображается поисковая выдача по запросу
        Отображается поисковая строка с запросом
        На карте отображаются пины искомой организации
        Отображаются пины подмешанного геопродукта
    - do: Тап на пин подмешанного геопродукта
    - assert: |
        Отображается миникарточка организации
        Пин увеличился в размере
        Цвет пина не изменился
        В карточке может отображаться рекламная информация

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - use_map
      - assessors
      - mapkit_ready
    - integration_run:
      - mapkit


  Карусель Похожих / популярных организаций рядом в карточке негеопродуктовых организаций:
    - info: |
        Признак геопродукта - зеленая стрелка после названия организации
        Синяя стрелка означает, что у организации есть владелец
    - do: Открыть карточку организации без признака геопродукта
    - assert: Отображается карточка организации
    - do: Раскрыть полную карточку и пролистать до конца
    - assert: В карточке присутствует карусель с похожими местами рядом
    - do: Тап по любой предложенной организации
    - assert: Отображается карточка выбранной организации

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps
    - tags:
        - assessors


  Отсутствие карусели Похожих / популярных организаций рядом в карточке геопродукта:
    - info: |
        Проверить, что в карточке геопродуктовых организаций карусель похожих или популярных организаций не отображается.
    - do: Тап на пин организации, которая является геопродуктом
    - assert:  На карте поднятый пин и точки входа (если присутствуют). Отображается миникарточка организации
    - do: Раскрыть полную карточку организации и пролистать до конца
    - assert:  Убедиться, что карусель в карточке не отображается
    - do: Повторить предыдущие шаги с другими геопродуктами
    - assert:  Убедиться, что карусель в карточке не отображается

    - platforms:
      - android
      - ios
    - testing:
      - acceptance_maps
    - tags:
      - assessors


  Кликабельность объявлений геопродукта:
    - info: |
        Объявление геопродукта:
        содержит заголовок (жирным шрифтом) и текст объявления (обычным шрифтом), разделенные вертикальной чертой
        может отображаться как в начале так и в конце карточки геопродуктовой организации
        по тапу на него открывается сайт организации (тапабельно не у всех геопродуктовых организаций)
        [collapsed-image](https://jing.yandex-team.ru/files/ekusheleva/Снимок%20экрана%202022-01-26%20в%2014.57.40.png){title=Визуальное отличие от объявлений директа}
        Открыта карточка геопродуктовой организации с тапабельным объявлением геопродукта (например, "Траттория Vabene!", Москва)
    - do: Пролистать до объявления геопродукта
    - assert: Отображается объявление геопродукта
    - do: Тап на объявление геопродукта
    - assert: Открыт сайт организации
    - do: Вернуться на карточку организации
    - assert: |
        Открыта карточка организации
        Отображается объявление геопродукта

    - platforms:
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - newbie


  Карусель популярных организаций рядом в карточке геопродуктовых организаций:
    - info: |
        Признак геопродукта - зеленая стрелка после названия организации
        Синяя стрелка означает, что у организации есть владелец
    - do: Открыть карточку организации с признаком геопродукта
    - assert: Отображается карточка организации
    - do: Раскрыть полную карточку и пролистать до конца
    - assert: В карточке присутствует карусель с похожими местами рядом
    - do: Тап по любой предложенной организации
    - assert: Отображается карточка выбранной организации

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps


  Открытие рекламного блока геопродукта через карточку:
    - info: Отображается поисковая выдача по запросу Где поесть
    - do: Тап на организацию с геопродуктом который имеется рекламный блок со знаком '%'
    - assert: |
        Открылась карточка организации
        В карточке присутствует рекламный блок со знаком '%'
    - do: Тап на рекламный рекламный блок
    - assert: |
        Отображается карточка "Подробности акции"
        В карточке отображаются условия акции

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors


  Открытие рекламного блока геопродукта через серп:
    - info:
        Отображается поисковая выдача по запросу Где поесть
        В поисковой выдаче отображаются организации с геопродуктом
    - do: Тап на рекламный блок организации которая имеет со знаком '%'
    - assert: |
        Открылась карточка организации
        Открылась карточка "Подробности акции"
        В карточке отображаются условия акции

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
