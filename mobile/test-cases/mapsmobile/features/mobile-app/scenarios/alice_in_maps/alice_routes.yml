components: alice_routes
testing:
  - regress
tags:
  - assessors
  - not_suitable_for_farm
integration_run:
  - alicekit

aliases:
  - &info_voice_activation_on_and_mic_on
    - info: Установлена локаль на устройстве ru_RU
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Включить Алису (Меню -> Настройки -> Основные -> Алиса)
    - do: Включить голосовую активация Алисы (Меню -> Настройки -> Основные -> Алиса)
    - do: В настройках приложения на устройстве выдать доступ к микрофону девайса
    - do: Открыть главный экран приложения

  - &on_exp_alice_choose_route
    - do: |
        Использовать интент:
        [collapsed-image](https://jing.yandex-team.ru/files/linakolpakova/эксперимент.png){title=QR-код}

        `yandexmaps://add_exp?alice_choose_route`
    - do: Перезапустить приложение

specs:
  Построение маршрута к любой улице в городе ММП с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Произнести "Поехали на улицу (указать любую улицу в городе ММП)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Построение маршрута в любой город с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Алиса, поехали (указать любой город)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready


  Построение маршрута к крупному магазину в городе ММП с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Алиса, поехали (указать любой крупный магазин в городе ММП)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready


  Построение маршрута к заправке с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Поехали на заправку"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса
    - do: Сказать "Алиса, поехали (указать любой адрес в городе ММП)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Построение маршрута к любому адресу в городе ММП с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Алиса, поехали (указать любой адрес в городе ММП)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready


  Переход в автоведение с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - do: Выключить эксперимент `alice_choose_route` (Меню -> Настройки -> дебаг-панель -> Experiments)
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Произнести "Поехали (указать любую улицу/город/адрес)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран автоведения
        Начинается симуляция ведения
        Конечная точка установлена в месте запроса

    - platforms:
        - android
        - ios
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Построение маршрута с помощью Алисы к закладке:
    - info: Добавлены места в закладки (напр., дача, любимый магазин и т.п)
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Вызвать Алису
    - do: Сказать "Поехали в (указать название одной из закладок (напр. дача)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута
        Конечная точка установлена в месте созданной закладки

    - platforms:
        - android
        - ios
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Переход в автоведение при построении маршрута к закладке с помощью Алисы:
    - info: Добавлены места в закладки (напр., дача, любимый магазин и т.п)
    - *info_voice_activation_on_and_mic_on
    - do: Выключить эксперимент `alice_choose_route` (Меню -> Настройки -> дебаг-панель -> Experiments)
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Поехали в (указать название одной из закладок (напр. дача)"
    - assert: |
        Алиса подтверждает действие
        Отображается экран автоведения
        Начинается симудяция ведения
        Конечная точка установлена в месте созданной закладки

    - platforms:
        - android
        - ios
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Построение маршрута до парковки с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Построй маршрут до парковки"
    - assert: |
        Алиса подтверждает действие
        Включается парковочный слой
        Строится маршрут до парковки

    - platforms:
        - android
        - ios
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Переход в автоведение при построении маршрута до парковки с помощью Алисы:
    - *info_voice_activation_on_and_mic_on
    - do: Выключить эксперимент `alice_choose_route` (Меню -> Настройки -> дебаг-панель -> Experiments)
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Построй маршрут до парковки"
    - assert: |
        Алиса подтверждает действие
        Включается парковочный слой
        Отображается экран автоведения
        Конечная точка маршрута - парковка

    - platforms:
        - android
        - ios
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Добавление точки Дом при построении маршрута домой:
    - info: Не добавлен адрес дома в закладки
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Домой"
    - assert: |
        На экране отображается запрос
        Алиса спрашивает, где находится дом
    - do: Указать адрес дома в городе текущего ММП
    - assert: Алиса уточняет новый адрес дома
    - do: Подтвердить
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута до указанного адреса

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - newbie
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Построение маршрута до дома:
    - info: Адрес дома добавлен в закладки
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "Домой"
    - assert: |
        На экране отображается запрос
        Отображается экран выбора маршрута до дома

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - newbie
        - refactor_ready


  Алиса. Добавление точки Работа при построении маршрута на работу:
    - info: Не добавлен адрес работы в закладки
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "На работу"
    - assert: |
        На экране отображается запрос
        Алиса спрашивает, где находится работа
    - do: Указать адрес дома в городе текущего ММП
    - assert: Алиса уточняет новый адрес работы
    - do: Подтвердить
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута до указанного адреса

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - newbie
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Построение маршрута до работы:
    - info: Адрес работы добавлен в закладки
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: Сказать "На работу"
    - assert: |
        На экране отображается запрос
        Отображается экран выбора маршрута до работы

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - newbie
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Построение маршрута с промежуточными точками - "по":
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - do: |
        Указать две точки в запросе с помощью предлога "по"
        Например, "Поехали до Москвы по проспекту Ленина"
    - assert: |
        Алиса отвечает как можно добраться
        Отображается экран выбора маршрута
        В маршруте отображается промежуточная точка

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Построение маршрута с промежуточными точками - "через":
    - *info_voice_activation_on_and_mic_on
    - *on_exp_alice_choose_route
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Вызвать Алису
    - assert: |
        Отображается штора Алисы
        Ведение по маршруту продолжается
    - do: |
        Указать две точки в запросе с помощью предлога "через"
        Например, "до Зеленограда через Кутузовский проспект"
    - assert: |
        Алиса подтверждает действие
        Отображается экран выбора маршрута с промежуточной точкой

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Сколько мне ещё ехать? - длинный маршрут:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить маршрут в дальнюю от себя часть города/поселка
    - do: Перейти в ведение
    - do: Вызвать Алису
    - do: Cпросить "Сколько мне еще ехать / Сколько мне осталось ехать / Когда я доеду и т.п."
    - assert: |
        Алиса сообщает текстом и голосом, сколько километров и минут до прибытия
        Ведение по маршруту продолжается

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Сколько мне ещё ехать? - маршрут менее 100 м:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить автомаршрут менее в 100 метрах от текущего ММП
    - do: Тап на Поехали
    - do: Вызвать Алису
    - do: Cпросить "Сколько мне еще ехать / Сколько мне осталось ехать / Когда я доеду и т.п."
    - assert: Алиса отвечает "Почти приехали"

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Сколько мне ещё ехать? - нет маршрута:
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - do: Cпросить "Сколько мне еще ехать / Сколько мне осталось ехать / Когда я доеду и т.п."
    - assert: Алиса спрашивает о том, куда нужно добраться

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Во сколько я приеду? - в движении по маршруту:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить произвольный автомаршрут
    - do: Тап на Поехали
    - do: |
        Вызвать Алису и спросить любой из вариантов:
        - Во сколько приеду
        - Во сколько буду
        - Во сколько приедем
    - assert: Алиса сообщает расчетное время прибытия

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Во сколько я приеду? - нет маршрута:
    - *info_voice_activation_on_and_mic_on
    - do: |
        Вызвать Алису и спросить следующие варианты:
        - Во сколько приеду
        - Во сколько буду
        - Во сколько приедем
    - assert: Алиса спрашивает о том, куда нужно добраться

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Обзор проложенного маршрута:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить произвольный маршрут
    - do: Тап на Поехали
    - assert: Отображается экран ведения по маршруту
    - do: Вызвать Алису
    - do: Сказать "Покажи весь маршрут / Обзор маршрута / Покажи маршрут и т.п."
    - assert: |
        Алиса подтверждает действие
        Отображается экран ведения в режиме обзора маршрута

    - platforms:
        - ios
        - android
    - tags:
        - parity
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Сброс проложенного маршрута - есть маршрут:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить произвольный маршрут
    - do: Тап на Поехали
    - assert: Отображается экран ведения по маршруту
    - do: Вызвать Алису
    - do: Сказать "Сбрось маршрут / Отмени маршрут / Удалить маршрут и т.п."
    - assert: |
        Алиса подтверждает действие
        Маршрут завершен
        Отображается главный экран приложения

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Сброс проложенного маршрута - нет маршрута:
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - do: Сказать "Сбрось маршрут / Отмени маршрут / Удалить маршрут и т.п."
    - assert: Алиса отвечает, что движения нет

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Сколько стоять в пробке?:
    - *info_voice_activation_on_and_mic_on
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Включить слой пробок
    - do: Построить маршрут, пролегающий через длинную пробку
    - do: Тап на Поехали
    - assert: Отображается экран ведения по маршруту
    - do: Сказать "Надолго пробка / Сколько еще стоять будем / Какой длины пробка и т.п."
    - assert: |
        Алиса отвечает голосом и текстом
        В сообщение указана длина пробки кратная 100 метрам и примерное время нахождения в ней

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Сколько ехать до места?:
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - do: Спросить "Сколько ехать до (назвать любой город)?"
    - assert: Алиса отвечает голосом и текстом о время в пути до указанного города

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - refactor_ready


  Вызов Алисы с действующими аннотациями:
    - info: |
        В девайс установлена сим-карта
    - *info_voice_activation_on_and_mic_on
    - do: Построить произвольный автомаршрут
    - do: Тап на Поехали
    - do: Вызвать Алису
    - assert: |
        Отображается штора Алисы
        Аннотации замьючены

    - platforms:
        - ios
        - android
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Работа Алисы при входящих звонках с действующими аннотациями:
    - info: |
        В девайс установлена сим-карта
    - *info_voice_activation_on_and_mic_on
    - do: Построить произвольный автомаршрут
    - do: Тап на Поехали
    - do: Вызвать Алису
    - do: Активно общаться с Алисой
    - assert: Разговор с Алисой НЕ прерывается
    - do: |
        Позвонить на телефон
        - при активной записи речи
        - при воспроизведении фразы Алисы
    - assert: Алиса продолжает свою речь/запись речи
    - do: Закрыть Алису
    - assert: Экран Алисы скрылся
    - do: Дождаться маневра
    - assert: Аннотации озвучиваются

    - platforms:
        - ios
        - android
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Включение слоя пробок:
    - info: Слой пробок выключен
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - assert: Открылась штора Алисы
    - do: Сказать "Включи пробки"
    - assert: |
        Алиса дает подтверждение голосом
        Слой пробок включен

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Выключение слоя пробок:
    - info: Слой пробок включен
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - assert: Открылась штора Алисы
    - do: Сказать "Включи пробки"
    - assert: |
        Алиса дает подтверждение голосом
        Слой пробок включен

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Смена голоса диктора. Предустановленные голоса:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть экран настроек звука (Меню -> Настройки -> Маршруты -> Звук)
    - do: Тап на Голос
    - assert: Отображается экран выбора голоса диктора
    - do: Произнести "Алиса"
    - assert: Отображается штора Алисы
    - do: Сказать "Включи голос Дмитрия"
    - assert: |
        Алиса подтверждает запрос
        Приветствие НЕ звучит
        Выбранный голос активен
    - do: Сказать "Включи голос Оксаны"
    - assert: |
        Алиса подтверждает запрос
        Приветствие НЕ звучит
        Выбранный голос активен
    - do: Сказать "Включи свой голос"
    - assert: |
        Алиса подтверждает запрос
        Через некоторое время звучит приветствие запрошенным голосом
        Выбранный голос активен

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Смена голоса диктора. Доступные для скачивания голоса:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть экран настроек звука (Меню -> Настройки -> Маршруты -> Звук)
    - do: Тап на Голос
    - assert: |
        Отображается экран выбора голоса диктора
        Присутствует блок доступных для скачивания голосов
    - do: Произнести "Алиса"
    - assert: Отображается штора Алисы
    - do: Попросить Алису включить любой нескачанный голос
    - assert: |
        Алиса подтверждает запрос
        Через некоторое время звучит приветствие запрошенным голосом
        Выбранный голос активен

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
