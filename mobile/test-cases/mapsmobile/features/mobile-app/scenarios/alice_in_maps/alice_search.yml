components: alice_search
testing:
  - regress
tags:
  - assessors
  - not_suitable_for_farm
integration_run:
  - alicekit

aliases:
  - &info_voice_activation_on_and_mic_on
    - info: Установлена локаль на устройстве ru_RU
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Алиса включена (Меню -> Настройки -> Основные -> Алиса)
    - do: Включена голосовая активация Алисы (Меню -> Настройки -> Основные -> Алиса)
    - do: В настройках приложения на устройстве выдан доступ к микрофону девайса
    - do: Открыт главный экран приложения

specs:
  Поиск Яндекс.Заправок с помощью Алисы на главном экране:
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - do: Произнести "Покажи Яндекс.Заправки"
    - assert: |
        Алиса подтверждает запрос
        Отображаются результаты поиска по запросу Яндекс.Заправки
        На карте отображаются пины Яндекс.Заправок

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready


  Поиск Яндекс.Заправок с помощью Алисы в автоведении:
    - *info_voice_activation_on_and_mic_on
    - do: Выключить эксперимент `alice_choose_route` (Меню -> Настройки -> дебаг-панель -> Experiments)
    - do: Включить симуляцию ведения `Demo movement` (Меню -> Настройки -> дебаг-панель -> Routes)
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Построить автомаршрут
    - do: Тап на Поехали
    - assert: |
        Отображается экран ведения по маршруту
        Начинается симуляция ведения
    - do: Тап по экрану
    - do: Тап на кнопку вызова Алисы
    - do: Произнести "Яндекс.Заправки"
    - assert: |
        Алиса подтверждает запрос
        На карте отображаются пины Яндекс.Заправок вдоль маршрута
        Ведение по маршруту продолжается

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Поиск мест:
    - *info_voice_activation_on_and_mic_on
    - do: |
        Произнести "Алиса, найди (указать любую категорию)"
        Напр., "Алиса, найди где поесть"
    - assert: |
        Отображаются результы поиска
        На карте отображаются поисковые пины

    - platforms:
        - ios
        - android
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Поиск ММП - выдан доступ к МПП:
    - *info_voice_activation_on_and_mic_on
    - info: Выдан доступ к ММП
    - do: Проскроллил карту так, чтоб метка ММП была за пределами экрана
    - do: Вызвать Алису
    - do: Спросить "Где я? / Адрес моего местоположения / В каком я городе? / Найди меня / Где я сейчас нахожусь"
    - assert: |
        Ответ Алисы текстом и голосом адрес ММП пользователя
        После завершения произношения сообщения Алисой, карта центрируется на пользователе
        Штора с Алисой скрывается

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Поиск ММП - нет доступа к ММП:
    - *info_voice_activation_on_and_mic_on
    - info: Доступ к ММП не выдан
    - do: Вызвать Алису
    - do: Спросить "Где я? / Адрес моего местоположения / В каком я городе? / Найди меня / Где я сейчас нахожусь"
    - assert: |
        Ответ Алисы текстом и голосом примерное ММП пользователя
        После завершения произношения сообщения Алисой, отображается запрос на доступ к ММП
        Штора с Алисой скрывается

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready


  Алиса. Определение ММП после смены геолокации:
    - info: |
        Выдан доступ к ММП
        Для подмены ММП использовать (Android) Mosk Location / (iOS) Enter your route
    - *info_voice_activation_on_and_mic_on
    - do: Вызвать Алису
    - do: Спросить "Где я? / Адрес моего местоположения / В каком я городе? / Найди меня / Где я сейчас нахожусь"
    - assert: |
        Ответ Алисы текстом и голосом адрес ММП пользователя
        После завершения произношения сообщения Алисой, карта центрируется на пользователе
        Штора с Алисой скрывается
    - do: Изменить ММП на другой город
    - do: Вызвать Алису
    - do: Спросить "Где я? / Адрес моего местоположения / В каком я городе? / Найди меня / Где я сейчас нахожусь"
    - assert: |
        Ответ Алисы текстом и голосом адрес ММП пользователя после подмены
        После завершения произношения сообщения Алисой, карта центрируется на пользователе
        Штора с Алисой скрывается


    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready



  Алиса. Поиск адреса:
    - *info_voice_activation_on_and_mic_on
    - do: |
        Произнести "Алиса, найди (указать любой адрес)"
        Напр., "Алиса, найди улицу Льва Толстого 16"
    - assert: |
        Отображаются результы поиска
        На карте отображаются поисковые пины

    - platforms:
        - ios
        - android
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Поиск по названию:
    - *info_voice_activation_on_and_mic_on
    - do: |
        Произнести "Алиса, найди (указать название)"
        Напр., "Алиса, найди Бургер Кинг"
    - assert: |
        Отображаются результы поиска
        На карте отображаются поисковые пины

    - platforms:
        - ios
        - android
    - tags:
        - newbie
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps
