components: alice_cashes
testing:
  - regress
tags:
  - assessors
  - not_suitable_for_farm
integration_run:
  - alicekit

aliases:
  - &info_voice_activation_on_and_mic_on
    - info: Установлена локаль на устройстве ru_RU
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Включить Алису (Меню -> Настройки -> Основные -> Алиса)
    - do: Включить голосовую активацию Алисы (Меню -> Настройки -> Основные -> Алиса)
    - do: В настройках приложения на устройстве выдать доступ к микрофону девайса
    - do: Открыть главный экран приложения

specs:
  Алиса. Загрузка кэша - карты не найдены:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть спан карты в месте, для которого нет карты для загрузки (напр., город Кананга республики Конго)
    - do: Вызвать Алису
    - do: Сказать "Скачай / Загрузи карту"
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
    - do: Вызвать Алису
    - do: |
        Сказать "Загрузи карту (указать город/страну/область)"
        В запросе указать место, для которого нет карты для загрузки (напр., Солнечногорск)
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
        Отображается текст об отсутствии карты

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Загрузка кэша - найдена одна карта:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть спан карты в месте, для которого есть одна карта для загрузки (напр., город Будёновск, Ставропольский край)
    - do: Вызвать Алису
    - do: Сказать "Скачай / Загрузи карту"
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
        Начинается загрузка кэша текущего спана
    - do: |
        Сказать "Загрузи карту (указать город/страну/область)"
        В запросе указать место, для которого бы предлагалось одна карта для загрузки (напр., Рязанская область, Эстония)
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
        Начинается загрузка найденного кэша


    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Загрузка кэша - найдено несколько карт:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть спан карты в месте, для которого есть несколько карт для загрузки (напр., Волгоград)
    - do: Вызвать Алису
    - do: Сказать "Скачай / Загрузи карту"
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
        Для скачивания предлагается несколько карт
        Загрузка кэша текущего спана не происходит
    - do: Вызвать Алису
    - do: |
        Сказать "Загрузи карту (указать город/страну/область)"
        В запросе указать место, для которого бы предлагалось несколько карт для загрузки (напр., Москва)
    - assert: |
        Алиса подтверждает начало поиска
        Открывается экран поиска карт
        Для скачивания предлагается несколько карт
        Загрузка кэша текущего спана не происходит

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
    - testing:
        - acceptance_maps


  Алиса. Попытка загрузить уже скачанный кэш:
    - *info_voice_activation_on_and_mic_on
    - do: Открыть меню
    - do: Тап на Загрузка карт
    - assert: Отображается экран Офлайн-карты
    - do: Загрузить любой кэш
    - do: Вернуться на главный экран приложения
    - do: Вызвать Алису
    - do: Попросить Алису загрузить только что скачанную карту
    - assert: |
        Отображается экран поиска кэша
        Загрузка скачанного ранее кэша не происходит

    - platforms:
        - ios
        - android
    - tags:
        - not_suitable_for_farm
        - refactor_ready
