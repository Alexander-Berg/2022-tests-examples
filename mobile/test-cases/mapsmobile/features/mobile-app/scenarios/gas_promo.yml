testing:
  - regress
components: gas_promo
integration_run:
  - tanker_sdk
import-steps:
  - ../../features/mobile-app/steps/common.yml

specs:
  Ввод промокода через карточку заправки:
    - info: |
        Включена тычка Debug Panel -> Environment -> Refuel environment -> TESTING
        (IOS) Тап Various -> Load refuel stations for current location и установить геопозицию на заправку
        Android: любая заправка
        Пользователь авторизован
        Таб Скидки и бонусы может не отображаться
    - do: Тап на Заправиться в карточке АЗС с оплатой картой
    - assert: Открывается экран заправки
    - do: Тап по любой колонке (кроме 6)
    - assert: Открывается экран выбора топлива
    - do: Выбрать топливо
    - do: Тап на Оплатить
    - assert: Отображается экран выбора заправщика и способа оплаты
    - do: Тап на плашку скидок и бонусов вверху экрана
    - assert: Отображается экран Скидки и бонусы
    - do: Тап на Ввести промокод
    - assert: |
        Отображается экран ввода промокода
        Кнопка "Активировать" неактивна
    - do: Ввести в поле ввода хаотичное сочетание цифр и латинских букв
    - assert: Кнопка Активировать активна
    - do: Тап на Активировать
    - assert: Появляется сообщение Неверный промокод

    - tags:
        - assessors
    - testing:
        - acceptance_maps
    - platforms:
        - ios
        - android


  Ввод промокода через настройки приложения:
    - info: |
        Открыт экран Меню > Яндекс.Заправки > Скидки и бонусы
    - do: Тап на Ввести промокод
    - assert: |
        Отображается экран ввода промокода
        Кнопка “Активировать” неактивна
    - do: Ввести в поле ввода хаотичное сочетание цифр и латинских букв
    - assert: Кнопка Активировать активна
    - do: Тап на Активировать
    - assert: Появляется сообщение Неверный промокод

    - tags:
        - assessors
    - testing:
        - acceptance_maps
    - platforms:
        - ios
        - android


  Отображение баннера заправок на экране построения маршрута:
    - info: |
        Включен эксперимент show_gas_stations_banner_in_route_points
        Устройство в вертикальной ориентации
    - do: Тап на таб Маршрут
    - assert: |
        Открылся экран Маршрут
        Отображается баннер заправок
        Присутствует кнопка Подробнее
    - do: Сменить ориентацию устройства
    - assert: |
        Устройство в горизонтальной ориентации
        Отображается баннер заправок
        Присутствует кнопка Подробнее
    - do: Тап на Подробнее
    - assert: Открыт CustomTab Как оплатить заправку в Картах
    - do: Сменить ориентацию устройства
    - assert: |
        Устройство в вертикальной ориентации
        Открыт CustomTab Как оплатить заправку в Картах
        В Custom Tab присутствует кнопка Посмотреть заправки
    - do: Тап на Посмотреть заправки
    - assert: |
        Открыт экран результатов поиска с запросом АЗС с оплатой в Картах

    - tags:
        - assessors
    - testing:
        - acceptance_maps
    - platforms:
        - ios


  Отображение баннера заправок на экране добавления точки маршрута:
    - info: |
        Включен эксперимент show_gas_stations_banner_in_route_points
        Устройство в вертикальной ориентации
        Построен произвольный авто-маршрут
    - do: Тап на Откуда/Куда
    - assert: |
        Открылся экран Откуда/Куда
    - do: Тап на Добавить точку
    - assert: |
        Открылся экран добавления точки
        Отображается баннер заправок с кнопкой Подробнее
    - do: Сменить ориентацию устройства
    - assert: Элементы экрана не съехали и не пропали
    - do: Тап на Подробнее в баннере заправок
    - assert: Открывается CustomTab Как оплатить заправку в Картах
    - do: Сменить ориентацию устройства
    - assert: Элементы экрана не съехали и не пропали
    - do: Тап на Посмотреть заправки
    - assert: Открылся экран поиска с запросом АЗС с оплатой в Картах

    - tags:
        - assessors
    - platforms:
        - ios


  Отображение саджеста АЗС с сервисом Транспорт:
    - info: |
        Пользователь авторизован
        На Android у пользователя добавлены закладки Дом/Работа
        Включены эксперименты (Debug Panel - Experiments):
          - show_gas_stations_in_suggest
          - no_route_suggest_on_main_screen
        Выключен эксперимент service_architecture
        Выключен эксперимент kicksharing_on
        Выключен эксперимент service_gas_stations
        Отображается главный экран приложения
        Слой общественного транспорта выключен
    - do: Тап на таб Транспорт
    - assert: |
        Слой ОТ включен
        Саджест заправок не отображается
    - do: Тап на таб Транспорт
    - assert: |
        Слой ОТ выключен
        Саджест АЗС отображается после саджеста Дом/Работа
    - do: Тап по саджесту заправки
    - assert: Отображается СЕРП c заправками
    - do: Закрыть СЕРП
    - assert: |
        Отображается главный экран приложения
        Саджест АЗС отображается после саджеста Дом/Работа

    - tags:
        - assessors
    - testing:
        - acceptance_maps
    - platforms:
        - android


  Саджест заправок в табе Навигатора:
    - info: |
        Устройство в вертикальной ориентации
        Пользователь авторизован
        Включен эксперимент show_gas_stations_in_suggest
        Открыт главный экран приложения
    - do: Включить таб Навигатора
    - assert: |
        Таб Навигатора стал активным
        Внизу в саджестах отображается "Я.Заправки"
    - do: Сменить ориентацию устройства
    - assert: |
        Экран приложения в горизонтальной ориентации
        В саджестах отображается "Я.Заправки"

    - platforms:
        - ios
    - tags:
        - assessors
