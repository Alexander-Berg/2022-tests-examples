components: parkings_menu
testing:
  - regress

aliases:
  - &exp_and_environment_auth_with_auto
    - info: |
        Авторизоваться тестовым аккаунтом: yndx.tula.testers@yandex.ru / thisislegitpassword
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Открыть спан Москвы
    - do: Тап Слои -> Парковки
    - do: Закрыть экран слоев

  - &exp_and_environment_auth_with_auto1
    - info: |
        Авторизоваться тестовым аккаунтом: yndx.tula.testers@yandex.ru / thisislegitpassword
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение


  - &exp_and_environment_auth_without_auto
    - info: Авторизоваться аккаунтом с добавленным номером телефона у которого отсутствует добавленное авто
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Открыть спан Москвы
    - do: Тап Слои -> Парковки
    - do: Закрыть экран слоев


  - &create_auto
    - do: На экране карты выбрать парковку и тап по шильдику с ценой
    - do: Тап "Оплатить парковку"
    - do: Тап на блок с номером авто


specs:
  Добавление автомобиля через карточку выбора времени парковки:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап "Добавить автомобиль"
    - do: Ввести корректный номер авто (Например, Y720OT90)
    - assert: |
        Отображается введеный номер автомобиля
        Кнопка сохранения неактивна
    - do: Ввести любое название
    - assert: |
        Отображается введенное название
        Кнопка сохранения активна
    - do: Удалить несколько символов из номера авто
    - assert: |
        Отображается новый указанный номер авто
        Кнопка сохранения неактивна

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Добавление автомобиля через карточку парковки:
    - *exp_and_environment_auth_without_auto
    - do: Тап "Оплатить парковку"
    - assert: Открыт экран добавления авто
    - do: Ввести корректный номер авто (Например, Y720OT90)
    - assert: |
        Отображается введеный номер автомобиля
        Кнопка сохранения неактивна
    - do: Ввести любое название
    - assert: |
        Отображается введенное название
        Кнопка сохранения активна
    - do: Тап "Сохранить"
    - assert: |
        Открыта карточка выбора времени парковки
        В блоке авто указан номер добавленного авто

    - platforms:
        - ios
        - android
    - tags:
        - newbie


  Валидация номера автомобиля при добавлении через карточку парковки:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап "Добавить автомобиль"
    - do: Ввести любое название для авто
    - assert: |
        Отображается введенное название
        Кнопка "Продолжить" неактивна
    - do: Тап на поле для ввода госномера автомобиля
    - do: Ввести 1 любую букву отличную от А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буква не вводится
    - do: Ввести 1 любую букву из А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буква вводится
    - do: |
        Ввести любую букву
        Ввести 6 любых цифр
    - assert: |
        Буквы не вводятся
        Вводятся только первые 3 цифры
    - do: Ввести 2 любых буквы отличных от А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буквы не вводятся
    - do: Ввести 3 любых буквы из А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Вводятся только первые 2 буквы
    - do: Ввести 2 любых цифры
    - assert: |
        Цифры вводятся
        Кнопка "Продолжить" становится активной

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Редактирование названия автомобиля через карточку парковки:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап на меню у авто
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Редактировать"
    - assert: |
        Открыт экран "Добавить машину"
        Отображаются: госномер и название
        Кнопка "Продолжить" неактивна
    - do: |
        Изменить название авто
        Тап "Продолжить"
    - assert: |
        Открывается экран "Сохраненные машины"
        Название редактируемой машины изменилось на новое

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Редактирование номера автомобиля через карточку парковки:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап на меню у авто, выбранного по умолчанию
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Редактировать"
    - assert: |
        Открыт экран "Добавить машину"
        Отображаются: госномер и название
        Кнопка "Продолжить" неактивна
    - do: |
        Изменить госномер авто
        Тап "Продолжить"
    - assert: |
        Открывается экран "Сохраненные машины"
        Госномер редактируемой машины изменился на новый
    - do: Закрыть экран Сохраненных машин
    - assert: |
        Экран cохраненных машин закрыт
        Открыта карточка выбора времени парковки
        В блоке "Автомобиль" отображается измененный номер авто по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Удаление единственного авто через карточку парковки:
    - *exp_and_environment_auth_without_auto
    - do: Открыть Меню -> Парковки -> Автомобиль -> Добавить машину
    - do: Ввести корректный номер авто (Например, Y720OT90)
    - do: Ввести любое название
    - do: Тап "Сохранить"
    - *create_auto
    - do: Тап на меню у авто
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Удалить"
    - assert: |
        Авто удалено
        Отображается кнопка "Добавить машину"
    - do: Открыть главный экран
    - do: На экране карты выбрать парковку и тап по шильдику с ценой
    - do: Тап на кнопку “Оплатить парковку”
    - assert: |
        Произошел переход на экран добавления авто
        Отображается 2 поля "Госномер" и "Название"
        Присутсвует неактивная кнопка сохранения

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - newbie


  Удаление авто через карточку парковки:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап на меню у авто не выбранного по умолчанию
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления, выбора машины
    - do: Тап "Удалить"
    - assert: |
        Авто удалено
        Авто не отображается в списке
    - do: |
        Тап на меню у авто, выбранного по умолчанию
        Тап "Удалить"
    - assert: |
        Авто по умолчанию удалено
        Авто не отображается в списке
        Выбрано другое авто по умолчанию
    - do: Закрыть экран Сохраненных машин
    - assert: |
        Экран cохраненных машин закрыт
        Открыта карточка выбора времени парковки
        В блоке "Автомобиль" отображается номер нового авто по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Выбор автомобиля по умолчанию через карточку парковки до начала парковочной сессии:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап на меню у авто не выбранного по умолчанию
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления, выбора машины
    - do: Тап "Выбрать"
    - assert: Выбрано новое авто по умолчанию
    - do: Закрыть экран сохраненных машин
    - assert: |
        Экран cохраненных машин закрыт
        Открыта карточка выбора времени парковки
        В блоке "Автомобиль" отображается номер нового авто по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - newbie


  Выбор тапом автомобиля по умолчанию через карточку парковки до начала парковочной сессии:
    - *exp_and_environment_auth_with_auto
    - *create_auto
    - do: Тап на авто, невыбранного по умолчанию
    - assert: Выбран новый автомобиль по умолчанию
    - do: Тап на другое авто
    - assert: Выбран новый автомобиль по умолчанию
    - do: Закрыть экран Сохраненных машин
    - assert: |
        Экран cохраненных машин закрыт
        Открыта карточка выбора времени парковки
        В блоке "Автомобиль" отображается номер нового авто по умолчанию

    - platforms:
        - ios
    - tags:
        - assessors


  Отсутствие смены автомобиля по умолчанию через карточку парковки после начала парковочной сессии:
    - *exp_and_environment_auth_with_auto
    - do: На экране карты выбрать парковку и тап по шильдику с ценой
    - do: Тап "Оплатить парковку"
    - do: Тап "Оплатить"
    - assert: |
        Карточка выбора времени парковки закрылась
        Открылась карточка активной парковочной сессии
    - do: Тап "Продлить"
    - assert: |
        Открыта карточка выбора времени для парковки
        Блок с номером авто неактивен
    - do: Тап на блок с номером авто
    - assert: Экран Сохраненных машин не открывается - не происходит смена авто

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Добавление автомобиля через меню приложения:
    - *exp_and_environment_auth_with_auto1
    - do: Тап Меню -> Парковка -> Автомобиль -> Добавить машину
    - do: Ввести корректный номер авто (Например, Y720OT90)
    - assert: |
        Отображается введеный номер автомобиля
        Кнопка сохранения неактивна
    - do: Ввести любое название
    - assert: |
        Отображается введенное название
        Кнопка сохранения активна
    - do: Удалить несколько символов из номера авто
    - assert: |
        Отображается новый указанный номер авто
        Кнопка сохранения неактивна

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Валидация номера автомобиля при добавлении через меню приложения:
    - *exp_and_environment_auth_with_auto1
    - do: Тап Меню -> Парковка -> Автомобиль -> Добавить машину
    - do: Ввести любое название для авто
    - assert: |
        Отображается введенное название
        Кнопка "Продолжить" неактивна
    - do: Ввести 1 любую букву отличную от А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буква не вводится
    - do: Ввести 1 любую букву из А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буква вводится
    - do: |
        Ввести любую букву
        Ввести 6 любых цифр
    - assert: |
        Буквы не вводятся
        Вводятся только первые 3 цифры
    - do: Ввести 2 любых буквы отличных от А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Буквы не вводятся
    - do: Ввести 3 любых буквы из А, В, Е, К, М, Н, О, Р, С, Т, У и Х
    - assert: Вводятся только первые 2 буквы
    - do: Ввести 2 любых цифры
    - assert: |
        Цифры вводятся
        Кнопка "Продолжить" становится активной

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Редактирование названия автомобиля через меню приложения:
    - *exp_and_environment_auth_with_auto1
    - do: Тап Меню -> Парковка -> Автомобиль
    - do: Тап на меню у авто
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Редактировать"
    - assert: |
        Открыт экран "Добавить машину"
        Отображаются: госномер и название
        Кнопка "Продолжить" неактивна
    - do: |
        Изменить название авто
        Тап "Продолжить"
    - assert: |
        Открывается экран "Сохраненные машины"
        Название редактируемой машины изменилось на новое

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Редактирование номера автомобиля через меню приложения:
    - *exp_and_environment_auth_with_auto1
    - do: Тап Меню -> Парковка -> Автомобиль
    - do: Тап на меню у авто, выбранного по умолчанию
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Редактировать"
    - assert: |
        Открыт экран "Добавить машину"
        Отображаются: госномер и название
        Кнопка "Продолжить" неактивна
    - do: |
        Изменить госномер авто
        Тап "Продолжить"
    - assert: |
        Открывается экран "Сохраненные машины"
        Госномер редактируемой машины изменился на новый
    - do: Открыть карточку парковки с оплатой в приложении(тап по шильдику с целой)
    - do: Тап "Оплатить парковку"
    - assert: |
        Открыта карточка выбора времени парковки
        В блоке "Автомобиль" отображается измененный номер авто по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Удаление единственного автомобиля через меню приложения:
    - *exp_and_environment_auth_without_auto
    - do: Открыть Меню -> Парковки -> Автомобиль -> Добавить машину
    - do: Ввести корректный номер авто (Например, Y720OT90)
    - do: Ввести любое название
    - do: Тап "Сохранить"
    - do: Тап на меню у авто
    - assert: |
        Открыто меню с кнопками: закрытия, редактирования, удаления машины
    - do: Тап "Удалить"
    - assert: |
        Авто удалено
        Отображается кнопка "Добавить машину"
    - do: |
        Открыть главный экран
        На экране карты выбрать парковку и тап по шильдику с ценой
        Тап на кнопку “Оплатить парковку”
    - assert: |
        Произошел переход на экран добавления авто
        Отображается 2 поля "Госномер" и "Название"
        Присутсвует неактивная кнопка сохранения

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - newbie


  Удаление автомобиля через меню приложения:
    - *exp_and_environment_auth_with_auto1
    - do: Тап Меню -> Парковка -> Автомобиль
    - do: Тап на меню у авто не выбранного по умолчанию
    - assert: |
        Открыто меню с кнопками:
        - закрытия
        - редактирования
        - удаления
        - выбора машины
    - do: Тап "Удалить"
    - assert: |
        Авто удалено
        Авто не отображается в списке
    - do: |
        Тап на меню у авто, выбранного по умолчанию
        Тап "Удалить"
    - assert: |
        Авто по умолчанию удалено
        Авто не отображается в списке
        Выбрано другое авто по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Отсутствие смены автомобиля по умолчанию после начала парковочной сессии через меню приложения:
    - *exp_and_environment_auth_with_auto
    - do: На экране карты выбрать парковку и тап по шильдику с ценой
    - do: Тап "Оплатить парковку"
    - do: Тап "Припарковаться"
    - assert: |
        Карточка выбора времени парковки закрылась
        Открылась карточка активной парковочной сессии
    - do: Закрыть карточку активной парковочной сессии
    - do: Открыть экран "Сохраненные автомобили" (Меню -> Парковка -> Автомобиль)
    - assert: Экран с сохраненными авто не открывается

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Форма обратной связи в парковках:
    - info: Пользователь авторизован в аккаунт с привязанным номером телефона
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Открыть настройки парковок(Меню-> Парковки)
    - assert: Среди пунктов меню отображается "Поддержка"
    - do: Тап "Поддержка"
    - assert: |
        Открывается WebView обратной связи:
          - Пользователь авторизован в WebView
          - Отображаются поля в форме(например: Имя, почта, Выберите тему обращения и другие)

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - newbie


  Группировка по дням в истории парковок:
    - info: |
        Пользователь авторизован в аккаунт с привязанным номером телефона
        На девайсе выставить дату 18.11.2021
        Девайс подключен к снифферу
        В сниффере подменить ответ на https://mobmaps-proxy-api-ext.c.maps.yandex.net/v1/parking/get_parking_session_history?limit=10 через MapLocal, используя готовый [JSON](https://jing.yandex-team.ru/files/kuznetsova22/HistoryForTestCase.json)
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустит приложение
    - do: Открыть экран истории парковок(Меню -> Парковки -> История парковок)
    - asseet: |
        Открылся экран "История парковок"
        Отображаются парковочные сессии:
          - Присутствуют даты в формате ДД месяц, день недели
          - Для парковки текущего дня пишется "Сегодня"
          - Для парковки вчерашнего дня пишется "Вчера"
          - Отображается длительность паркови и номер парковочной зоны(Например, "5 ч 30 мин, парковка №0309")

    - platforms:
        - ios
        - android


  Проверка UI пагинации в истории парковок:
    - info: |
        Пользователь авторизован
        Девайс в горизонтальном положении
        У пользователя добавлены данные об автомобиле
        У пользователя было оплачено более 10 парковок
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустит приложение
    - do: Перейти в раздел Меню -> Парковка -> История
    - assert: Отображается список совершенных парковок
    - do: Проскроллить вниз список парковок до конца
    - assert: При проскролле списка загружаются данные о более ранних парковочных сессиях
    - do: Проскроллить вверх список парковок
    - assert: При проскролле списка загружаются данные о более поздних парковочных сессиях

    - platforms:
        - ios
        - android


  Проверка UI пагинации в истории парковок. Смена ориентации:
    - info: |
        Пользователь авторизован
        Девайс в горизонтальном положении
        У пользователя добавлены данные об автомобиле
        У пользователя было оплачено более 10 парковок
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустит приложение
    - do: Перейти в раздел "Настройки", "История" в карточке оплаты парковки
    - assert: Отображается список совершенных парковок
    - do: Проскроллить вниз список парковок до конца
    - assert: При проскролле списка загружаются данные о более ранних парковочных сессиях
    - do: |
        - Сменить ориентацию девайса на вертикальную
        - Проскроллить вверх список совершенных парковок
    - assert: |
        - При смене ориентации порядок в списке не нарушается
        - При проскролле списка загружаются данные о более поздних парковочных сессиях

    - platforms:
        - ios
        - android


  Проверка UI пагинации в истории парковок. Смена темы:
    - info: |
        Пользователь авторизован
        Девайс в горизонтальном положении
        У пользователя добавлены данные об автомобиле
        У пользователя было оплачено более 10 парковок
        Перезапустить приложение
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустит приложение
    - do: Перейти в раздел "Настройки", "История" в карточке оплаты парковки
    - assert: Отображается список совершенных парковок
    - do: |
        Дождаться смены темы на противоположную
        Проскроллить вниз список парковок до конца
    - assert: |
        Артефакты противоположной темы в списке отсутствуют
        При проскролле списка загружаются данные о более ранних парковочных сессиях

    - platforms:
        - ios
        - android


  Пустая история парковок:
    - info: |
        Пользователь авторизован в аккаунт с привязанным номером телефона
        На аккаунт добавлено авто, отсутствуют оплаченные парковки
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустит приложение
    - do: Тап "Меню"
    - do: Тап "Парковка"
    - do: Тап "История парковок"
    - assert: |
        Открывается экран "История заказов"
    ##Ждем тут дизайна

    - platforms:
        - android
        - ios
    - tags:
        - assessors


  Открытие настроек парковок через меню неавторизованным пользователем:
    - info: |
        Пользователь неавторизован
        Открыт главный экран приложения
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/parking.png){title=QR-код}

        `yandexmaps://add_exp?parking_payment_enabled`
    - do: Дебаг-панель -> Environment -> Mobmaps Proxy host -> testing
    - do: Закрыть дебаг-панель
    - do: Перезапустить приложение
    - do: Тап "Меню"
    - assert: |
        Открылось меню
        Среди пунктов присутствует "Парковки"
    - do: Тап "Парковки"
    - assert: Открывается Аккаунт Менеджер
    - do: Авторизоваться
    - do: Тап "Парковки"
    - assert: |
        Открывается экран "Настройки парковок"
        Присутствуют пункты:
          - История парковок
          - Автомобиль
          - Способы оплаты
          - Поддержка

    - platforms:
        - ios
        - android
    - tags:
        - assessors
