components: geolocation
testing:
  - regress

specs:
  Исчезновение значка геоданных из статусбара:
    - info: Определение местоположения в настройках девайса включено для всех источников или только для спутников
    - do: Запустить МЯК
    - assert:
        Значок геоданных появляется на статусбаре.
        Кнопка определения местоположения работает
    - do: Свернуть приложение
    - assert: Значок геоданных пропадает из статусбара через несколько секунд
    - do: Развернуть МЯК
    - assert: Значок геоданных снова появляется в статусбаре
    - do: Выгрузить МЯК из памяти
    - assert: Значок геоданных пропадает из статусбара через несколько секунд

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - assessors
        - newbie


  Определение местоположения при помощи мобильных сетей:
    - info:
        В настройках девайса определение местоположения включена опция 'По координатам сети'.
        Определение по GPS/Глонасс отключено.
        Сеть Wi-fi отключена
    - do: Запустить приложение
    - assert:
        На карте отображается метка 'Я'.
        Вокруг метки 'Я' выделен область в форме окружности. Её диаметр может меняться в зависимости от качества сигнала.
        Кнопка определения местоположения работает
    - platforms:
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map
        - newbie


  Определение местоположения при помощи Wi-Fi:
    - info:
        В настройках определения местоположения включена опция 'По координатам сети'.
        Определение по GPS/Глонасс отключено.
        Сеть Wi-fi включена.
        Передача данных по мобильным сетям отключена
    - do: Запустить приложение
    - assert:
        На карте отображается метка 'Я'.
        Вокруг метки 'Я' выделена область в форме окружности.
        Её диаметр меньше, чем диамтер для мобильных сетей.
        Кнопка определения местоположения работает
    - platforms:
        - android
    - tags:
        - use_map
        - assessors


  Определение местоположения при помощи всех источников:
    - info: В настройках девайса определение местоположения включена опция 'По всем источникам' (режим повышенной точности)
    - do: Запустить приложение
    - assert:
        На карте отображается метка 'Я'.
        Вокруг метки “Я” выделена область в форме окружности.
        Кнопка определения местоположения работает
    - platforms:
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map
        - newbie


  Определение местоположения только по спутникам:
    - info: Кэш города скачан. Передача данных по Wi-fi и по мобильным сетям отключена
    - do: Запустить приложение
    - assert:
        На карте отображается метка 'Я'.
        Вокруг метки 'Я' выделена область в форме окружности.
        Кнопка определения местоположения работает
    - platforms:
        - android
        - ios
    - tags:
        - assessors
        - use_map
        - newbie


  Диалог о доступе к геолокации:
    - info:
        Установить приложение Яндекс.Карты
    - do: Запустить МЯК
    - assert:
        Отображается запрос пермишина на доступ к местоположению.
        В запросе 3 кнопки 'Запретить', 'Разрешить один раз' и 'При использовании приложения'
        Количество кнопок и формулировка может меняться в зависимости от версии iOS
    - do: Тап 'Запретить'
    - assert: Запрос пермишина пропал, отображается главная карта, местоположение не определено
    - do: Тап на кнопку определение местоположения
    - assert:
        Появился поп-ап 'Карты не знают, где вы находитесь'.
        На поп-апе кнопки 'Настройки' и 'Отменить'
    - do: Тап 'Настройки'
    - assert:
        Открываются настройки девайса на странице МЯКа.
        В поле 'Геопозиция' указано 'Никогда'
    - do: Разрешить МЯКу доступ к геопозиции и вернуться в приложение
    - assert:
        Открыт главный экран приложения с картой.
        Местоположение определено.
        Отображается пин текущего местоположения

    - platforms:
        - ios
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - assessors
        - use_map
        - newbie


  Поиск местоположения при построении маршрута:
    - info: |
        Выключена геолокация:
        на iOS Настройки->Приватность->Службы геолокации;
        на Android Настройки->Защита и местоположение->Местоположение
        Отключен интернет
        Скачан офлайн-кэш
        Приложение выгружено из памяти перед запуском
    - do: Построить маршрут в любую точку/объект на карте
    - assert:
        Открыт экран выбора вариантов маршрута
        Маршрут не построен
        ММП не определено
        По истечении ~5секунд появляется возможность повторить запрос
    - do: Включить геолокацию
    - do: Тап на контрол ММП
    - assert: |
        Местоположение определено
    - do: Тап на Повторить
    - assert: |
        Маршрут построен

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map
        - newbie
