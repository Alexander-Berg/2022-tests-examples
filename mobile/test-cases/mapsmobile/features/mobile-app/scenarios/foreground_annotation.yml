components: foreground_annotation
testing:
  - regress
integration_run:
  - mapkit
tags:
  - mapkit_ready

specs:

  Автозавершение ведения по маршруту в фоне:
    - info: |
        В ведении должна происходить симуляция движения:
        Debug-panel > Routes > Demo movement
        Меню - Настройки - Маршруты - Фоновое ведение - Вкл
    - do: |
        Построить автомаршрут с маневрами
        Подтвердить маршрут
    - assert: Открыт экран ведения по маршруту
    - do: Свернуть приложение
    - do: Доехать до конца маршрута
    - assert: В момент, когда пользователь доезжает до конца маршрута - звучит аннотация "Вы приехали"
    - do: Развернуть приложение
    - assert: |
        Маршрут завершен
        Аннотации не воспроизводятся
        Отображается главный экран приложения с картой
        Карта представлена в режиме 2D и "Север сверху"

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - assessors


  Фоновое ведение. Перестроение маршрута:
    - info: |
        Меню - Настройки - Маршруты - Фоновое ведение - Вкл
        В ведении должна происходить симуляция движения:
        На Android: через Mock Location
        На iOS: через Enter your route в дебаг-панели
    - do: Не сбрасывая симуляцию ведения по маршруту, построить маршрут в другую точку
    - do: Подтвердить его (тап на "Поехали")
    - do: Свернуть приложение
    - assert: |
        Приложение в фоне
        Воспроизводятся голосовые аннотации по маршруту
    - do: Дождаться расхождения построенного маршрута и симуляции
    - assert: Звучит аннотация о перестроении маршрута
    - do: Развернуть приложение
    - assert: |
        Движение по маршруту продолжается
        Маршрут перестроен

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - tags:
        - newbie


  Фоновое ведение. Маршрут по платной дороге:
    - info: |
        Меню - Настройки - Маршруты - Фоновое ведение - Вкл
        В ведении должна происходить симуляция движения:
        Debug-panel > Routes > Demo movement
    - do: |
        Построить маршрут через платную дорогу (в саджестах маршурта на экране выбора маршрутов должен быть значок рубля)
        Подтвердить маршрут
    - assert: Открыт экран ведения по маршруту
    - do: Свернуть приложение
    - assert: |
        Приложение в фоне
        Воспроизводятся голосовые аннотации по маршруту
    - do: Дождаться съезда на платную дорогу
    - assert: Звучит аннотация "Впереди платная дорога"
    - do: Вернуться в приложение
    - assert: |
        Отображается экран ведения по маршруту
        Воспроизводятся голосовые аннотации по маршруту

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - tags:
        - newbie


  Фоновое ведение. Перестроение маршрута на маршрут, проходящий по платной дороге:
    - info: |
        Меню - Настройки - Маршруты - Фоновое ведение - Вкл
        В ведении должна происходить симуляция движения:
        На Android: через Mock Location
        На iOS: через Enter your route в дебаг-панели
    - do: Не сбрасывая симуляцию ведения по маршруту, построить маршрут, проходящий по платной дороге (в саджестах маршурта на экране выбора маршрутов должен быть значок рубля)
    - do: Подтвердить его (тап на "Поехали")
    - do: Свернуть приложение
    - assert: |
        Приложение в фоне
        Воспроизводятся голосовые аннотации по маршруту
    - do: Дождаться расхождения построенного маршрута и симуляции
    - assert: Звучит аннотация, что маршрут перестроился и теперь на нем платный участок
    - do: Развернуть приложение
    - assert: |
        Движение по маршруту продолжается
        Маршрут перестроен
        На маршруте присутсвует платный участок

    - platforms:
        - ios
        - android
    - tags:
        - assessors