components: night_mode
testing:
  - regress

specs:
  Включение/Выключение Тёмного режима:
    - info: |
        Выбран слой карты 'Схема'
        Системное оформление доступно только для:
          iOS 13 и выше
          Android 9 (Samsung & Xiaomi)
          Android 10 и выше
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран Меню-> Настройки-> Основные
    - do: Тап по строке 'Тёмный режим' (iOS)/ 'Ночной режим' (Android)
    - assert: Отображается экран 'Тёмный режим'/'Ночной режим' с вариантами настроек
    - do: Выбрать вариант 'Включён'
    - assert: |
        Цветовая схема приложения отображается в тёмном режиме
        Сейчас Ночь: ВЫКЛ -> ВКЛ (из светлой темы переходит в темную)
        Автомат -> ВКЛ (темная тема была, темная и осталась)
        iOS 13+ / Android 9+: Системное (светлое) -> ВКЛ (из светлой темы переходит в темную)
        Системное (тёмное) -> ВКЛ (темная тема была, темная и осталась)
        Сейчас День: ВЫКЛ -> ВКЛ (из светлой в тёмную)
        Автомат -> ВКЛ (из светлой в тёмную)
        iOS 13+ / Android 9+: Системное (светлое) -> ВКЛ (из светлой темы переходит в темную)
        Системное (тёмное) -> ВКЛ (темная тема была, темная и осталась)
    - do: Выбрать вариант 'Выключен'
    - assert: |
        Цветовая схема приложения отображается в светлом режиме
        Сейчас Ночь: ВКЛ -> ВЫКЛ (из тёмной темы переходит в светлую)
        Автомат -> ВЫКЛ (из тёмной темы переходит в светлую)
        iOS 13+ / Android 9+: Системное (светлое) -> ВЫКЛ (светлая тема была, светлая и осталась)
        Системное (тёмное) -> ВЫКЛ (из тёмной темы переходит в светлую)
        Сейчас День: ВКЛ -> ВЫКЛ (из тёмной темы переходит в светлую)
        Автомат -> ВЫКЛ (светлая тема была, светлая и осталась)
        iOS 13+ / Android 9+: Системное (светлое) -> ВЫКЛ (светлая тема была, светлая и осталась)
        Системное (тёмное) -> ВЫКЛ (из тёмной темы переходит в светлую)

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
      - lite_acceptance_maps
    - tags:
      - assessors


  Автоматическое переключение Тёмного режима (закат):
    - info: |
        description: Тёмный режим переключается автоматически в зависимости от времени восхода и заката солнца.
        info:
          1. В настройках девайса выставлено время за 5 минут до наступления заката солнца в текущем местоположении( в настройках телефона выставлен часовой пояс для соответствующего региона)
          2. В меню выбран слой карты 'Схема'
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран 'Основные' в настройках.
    - do: Тап в строку 'Тёмный режим'
    - assert: Появился экран 'Тёмный режим' с чекбоксами, подсказкой и кнопкой 'Основные' слева сверху
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Тёмный режим' может изменится цветовая схема приложения.
        ВЫКЛ -> Автомат (светлая была, светлая осталась)
        ВКЛ -> Автомат (из тёмной темы переходит в светлую)
        [iOS 13]: Системное (светлое) -> Автомат (светлая тема была, светлая и осталась)
        [iOS 13]: Системное (тёмное) -> Автомат (из тёмной темы переходит в светлую)
    - do: Выйти из настроек
    - assert:  Открыт главный экран приложения с картой  Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert:  Открылась миникарточка организации На карте поднялся пин
    - do: Подождать 5 минут
    - assert: После пересечения времени заката цветовая схема изменяется на тёмную (присутствует задержка до 10 мин) МЯК полностью адаптируется под изменённую цветовую схему

    - platforms:
      - ios
    - tags:
      - assessors
      - newbie


  Отмена выбора режима переключения Ночного режима:
    - info: |
        info: В меню выбран слой карты 'Схема'.
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран 'Настройки'.
    - do: В блоке 'Основные' тап по строке 'Ночной(Android)/Темный(iOS) режим'
    - assert: Появился поп-ап (Android) 'Ночной режим' с чекбоксами, подсказкой и кнопкой 'Отменить'
    - do: Тап 'Отменить', или тап 'Back', или тап в область за пределами окна 'Ночной режим' (Android)
    - assert: Поп-ап 'Ночной режим' закрылся. Цветовая схема приложения и автарка не изменились.

    - platforms:
      - ios
      - android
    - tags:
      - assessors


  Автоматическое переключение Ночного режима:
    - info: |
          В настройках девайса выставлено время за несколько минут до наступления восхода или заката солнца в текущем местоположении
          Время заката/восхода можно увидеть в саджесте при запросе 'Закат/восход время' в поисковике Яндекс
          В меню выбран слой карты 'Схема'
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран 'Основные' в настройках.
    - do: Тап на строку 'Ночной режим'
    - assert: Появился попап 'Ночной режим' с радио-кнопками, подсказкой и кнопкой 'Отменить'
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Ночной режим' может изменится цветовая схема приложения.
        Сейчас Ночь:ВЫКЛ -> Автомат (из светлой темы переходит в темную)ВКЛ -> Автомат (темная тема была, темная осталась)
        Сейчас День:Выкл -> Автомат (светлая была, светлая осталась)ВКЛ -> Автомат (из темной в светлую)
    - do: Выйти из настроек
    - assert: |
        Открыт главный экран приложения с картой
        Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert: |
        Открылась миникарточка организации
        На карте пин стал активным
    - do: Подождать несколько минут пока наступит время восхода/заката
    - assert: |
        Цветовая схема изменяется на противоположную (присутствует задержка до 10 мин)
        Интерфейс МЯК полностью адаптируется под измененную цветовую схему

    - platforms:
      - ios
      - android
    - tags:
      - assessors
    - testing:
      - lite_acceptance_maps


  Включение/выключение Системного оформления:
    - info: |
        description: Системное оформление доступно на iOS 13 и выше, Android 9 и выше
        На данных ОС можно в настройках устройства сменить системное оформление на светлое/тёмное.
        Проверяем, что оформление карт автоматически провязывается с системным оформлением.
        iOS: Изменить системное оформление на устройстве:
          1. Открыть настройки
          2. 'Экран и яркость'
          3. Выбрать светлое или тёмное
        Android: Изменить системное оформление на устройстве (примерные шаги):
          1. Открыть настройки
          2. Экран
          3. Включить/выключить тумблер 'Тёмная тема'

        info:
          1. На устройстве выбрано светлое оформление
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран настроек 'Основные' (Меню  Основные)
    - do: | 
        IOS: Тап по строке 'Тёмный режим'
        Android: Тап по строке 'Ночной режим'
    - assert: Появился экран 'Тёмный режим' с чек-боксами, подсказкой и кнопкой 'Основные' слева сверху
    - do: Выбрать вариант 'Системное оформление'
    - assert: |
        Цветовая схема приложения изменилась в соответствии с системным оформлением
        ВКЛ -> Системное (из тёмной темы переходит в светлую)
        ВЫКЛ -> Системное (светлая тема была, светлая и осталась)
        Автомат (сейчас ночь) -> Системное (из тёмной темы переходит в светлую)
        Автомат (сейчас день) -> Системное (светлая тема была, светлая и осталась)
    - do: Выгрузить приложение из памяти и изменить системное оформление на тёмное
    - assert: Системное оформление устройства изменено на тёмное
    - do: Войти в приложение
    - assert: Цветовая схема приложения изменена в соответствии с устройством Цветовая схема приложения соответствует тёмному режиму
    - do: Тап Меню  Основные Тёмный режим
    - assert: |
        Напротив строки 'Системное оформление' стоит активный чекбокс.
        Цветовая схема приложения соответствует оформлению устройства
    - do: Выбрать любой другой вариант
    - assert: |
        Цветовая схема приложения изменилась в соответствии с выбранным вариантом
        Системное -> ВКЛ (тёмная тема была, тёмная и осталась)
        Системное -> ВЫКЛ (из тёмной темы переходит в светлую)
        Системное -> Автомат (день) (из тёмной темы переходит в светлую)
        Системное -> Автомат (ночь) (тёмная тема была, тёмная и осталась)

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_maps
    - tags:
      - assessors


  Установка приложения на девайс с системной темной темой:
    - info: |
        description:  Актуально для android 9 (Samsung & Xiaomi), и  android 10.
        Проверяем сопряженность оформления приложения и системной настройки девайса.

        info:  В настройках девайса выбрана темная тема  Запустить установку приложения
    - do: Запустить приложение
    - assert:  Экран-заставка отображается в ночном режиме
    - do:  Просмотреть слайды сопровождения нового пользователя
    - assert:  Все элементы отображаются в ночном режиме
    - do: Тап по кнопке меню
    - assert:  Открывается главное меню экрана
    - do: Тап по кнопке 'Настройки'
    - assert: |
        Открывается экран 'Настройки'
        Вверху отображается стрелка назад и заголовок 'Настройки'
        Ниже блок с кнопками: 'Основные', 'Карта', 'Маршруты', 'Офлайн-карты', 'О  приложении'
        Далее отображается блок с кнопкой 'Попробовать бета-версию'
        Еще ниже блок с кнопкой 'Очистить  историю поиска' Блок с дебаг-панелью ( в зависимости от сборки)
    - do: Открыть раздел 'Ночной режим'
    - assert: |
        Отображается экран с настройками ночного режима.
        В нем отображаются: Заголовок 'Ночной режим',  Чекбокс и параметр 'Включен', Чекбокс и параметр 'Выключен', Чекбокс и параметр 'Автоматически' с описанием
        Чекбокс и параметр 'Системная тема' с описанием ( выбран по умолчанию),
        Активный чекбокс  подсвечивается

    - platforms:
      - android
    - tags:
      - assessors


  Автоматическое переключение Тёмного режима (рассвет):
    - info: |
        description: Тёмный режим переключается автоматически в зависимости от времени восхода и заката солнца.
        info:
          1. В настройках девайса выставлено время за 5 минут до наступления восхода солнца в текущем местоположении
          2. В меню выбран слой карты 'Схема'
    - do: Выключить эксперименты `use_datasync_settings` и `new_maps_settings` (Меню -> Настройки -> Debug-Panel - Experiments)
    - do: Перезапустить приложение
    - do: Открыт экран 'Основные' в настройках.
    - do: Тап в строку 'Тёмный режим'
    - assert: Появился экран 'Тёмный режим' с чекбоксами, подсказкой и кнопкой 'Основные' слева сверху
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Тёмный режим' может изменится цветовая схема приложения.
        ВЫКЛ -> Автомат (из светлой темы переходит в темную)
        ВКЛ -> Автомат (темная тема была, темная осталась)
        [iOS 13]: Системное (светлое) -> Автомат (из светлой темы переходит в темную)
        [iOS 13]: Системное (тёмное) -> Автомат (темная тема была, темная и осталась)
    - do: Выйти из настроек
    - assert:  Открыт главный экран приложения с картой  Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert:  Открылась миникарточка организации На карте поднялся пин
    - do: Подождать 5 минут
    - assert: После пересечения времени восхода цветовая схема изменяется на светлую (присутствует задержка до 10 мин) МЯК полностью адаптируется под изменённую цветовую схему

    - platforms:
      - ios
    - tags:
      - assessors
      - newbie


  #новые настройки

  Новые настройки. Включение/Выключение Тёмного режима:
    - info: |
        Выбран слой карты 'Схема'
        Системное оформление доступно только для:
          iOS 13 и выше
          Android 9 (Samsung & Xiaomi)
          Android 10 и выше
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран Меню-> Настройки-> Карта и интерфейс
    - do: Тап по пункту Тема
    - assert: Отображается экран Тема
    - do: Тап на Тёмная
    - assert: |
        Цветовая схема приложения отображается в тёмном режиме
    - do: Тап на Светлая
    - assert: |
        Цветовая схема приложения отображается в светлом режиме

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - new_settings


  Новые настройки. Автоматическое переключение Тёмного режима (закат):
    - info: |
        description: Тёмный режим переключается автоматически в зависимости от времени восхода и заката солнца.
        info:
          1. В настройках девайса выставлено время за 5 минут до наступления заката солнца в текущем местоположении( в настройках телефона выставлен часовой пояс для соответствующего региона)
          2. В меню выбран слой карты 'Схема'
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран 'Основные' в настройках.
    - do: Тап в строку 'Тёмный режим'
    - assert: Появился экран 'Тёмный режим' с чекбоксами, подсказкой и кнопкой 'Основные' слева сверху
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Тёмный режим' может изменится цветовая схема приложения.
        ВЫКЛ -> Автомат (светлая была, светлая осталась)
        ВКЛ -> Автомат (из тёмной темы переходит в светлую)
        [iOS 13]: Системное (светлое) -> Автомат (светлая тема была, светлая и осталась)
        [iOS 13]: Системное (тёмное) -> Автомат (из тёмной темы переходит в светлую)
    - do: Выйти из настроек
    - assert: Открыт главный экран приложения с картой  Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert: Открылась миникарточка организации На карте поднялся пин
    - do: Подождать 5 минут
    - assert: После пересечения времени заката цветовая схема изменяется на тёмную (присутствует задержка до 10 мин) МЯК полностью адаптируется под изменённую цветовую схему

    - platforms:
        - ios
    - tags:
        - assessors
        - new_settings


  Новые настройки. Отмена выбора режима переключения Ночного режима:
    - info: |
        info: В меню выбран слой карты 'Схема'.
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран 'Настройки'.
    - do: В блоке 'Основные' тап по строке 'Ночной(Android)/Темный(iOS) режим'
    - assert: Появился поп-ап (Android) 'Ночной режим' с чекбоксами, подсказкой и кнопкой 'Отменить'
    - do: Тап 'Отменить', или тап 'Back', или тап в область за пределами окна 'Ночной режим' (Android)
    - assert: Поп-ап 'Ночной режим' закрылся. Цветовая схема приложения и автарка не изменились.

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - new_settings


  Новые настройки. Автоматическое переключение Ночного режима:
    - info: |
        В настройках девайса выставлено время за несколько минут до наступления восхода или заката солнца в текущем местоположении
        Время заката/восхода можно увидеть в саджесте при запросе 'Закат/восход время' в поисковике Яндекс
        В меню выбран слой карты 'Схема'
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран 'Карта и интерфейс' в настройках.
    - do: Тап на строку 'Тема'
    - assert: Отображается экран настроек 'Тема' с радио-кнопками, подсказкой и кнопкой 'Закрытия'
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Ночной режим' может изменится цветовая схема приложения.
        Сейчас Ночь:ВЫКЛ -> Автомат (из светлой темы переходит в темную)ВКЛ -> Автомат (темная тема была, темная осталась)
        Сейчас День:Выкл -> Автомат (светлая была, светлая осталась)ВКЛ -> Автомат (из темной в светлую)
    - do: Выйти из настроек
    - assert: |
        Открыт главный экран приложения с картой
        Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert: |
        Открылась миникарточка организации
        На карте пин стал активным
    - do: Подождать несколько минут пока наступит время восхода/заката
    - assert: |
        Цветовая схема изменяется на противоположную (присутствует задержка до 10 мин)
        Интерфейс МЯК полностью адаптируется под измененную цветовую схему

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - new_settings
    - testing:
        - acceptance_maps


  Новые настройки. Включение/выключение Системного оформления:
    - info: |
        description: Системное оформление доступно на iOS 13 и выше, Android 9 и выше
        На данных ОС можно в настройках устройства сменить системное оформление на светлое/тёмное.
        Проверяем, что оформление карт автоматически провязывается с системным оформлением.
        iOS: Изменить системное оформление на устройстве:
          1. Открыть настройки
          2. 'Экран и яркость'
          3. Выбрать светлое или тёмное
        Android: Изменить системное оформление на устройстве (примерные шаги):
          1. Открыть настройки
          2. Экран
          3. Включить/выключить тумблер 'Тёмная тема'

        info:
          1. На устройстве выбрано светлое оформление
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран настроек 'Карты и интерфейс' (Меню -> Настройки -> Карты и интерфейс)
    - do: Тап по строке 'Тема'
    - assert: Появился экран 'Тема' с чек-боксами, подсказкой и кнопкой 'Закрыть' справа сверху
    - do: Выбрать вариант 'Системная'
    - assert: |
        Цветовая схема приложения изменилась в соответствии с системным оформлением
        ВКЛ -> Системное (из тёмной темы переходит в светлую)
        ВЫКЛ -> Системное (светлая тема была, светлая и осталась)
        Автомат (сейчас ночь) -> Системное (из тёмной темы переходит в светлую)
        Автомат (сейчас день) -> Системное (светлая тема была, светлая и осталась)
    - do: Выгрузить приложение из памяти и изменить системное оформление на тёмное
    - assert: Системное оформление устройства изменено на тёмное
    - do: Войти в приложение
    - assert: Цветовая схема приложения изменена в соответствии с устройством Цветовая схема приложения соответствует тёмному режиму
    - do: Тап Меню  Основные Тёмный режим
    - assert: |
        Напротив строки 'Системное оформление' стоит активный чекбокс.
        Цветовая схема приложения соответствует оформлению устройства
    - do: Выбрать любой другой вариант
    - assert: |
        Цветовая схема приложения изменилась в соответствии с выбранным вариантом
        Системное -> ВКЛ (тёмная тема была, тёмная и осталась)
        Системное -> ВЫКЛ (из тёмной темы переходит в светлую)
        Системное -> Автомат (день) (из тёмной темы переходит в светлую)
        Системное -> Автомат (ночь) (тёмная тема была, тёмная и осталась)

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - new_settings


  Новые настройки. Автоматическое переключение Тёмного режима (рассвет):
    - info: |
        description: Тёмный режим переключается автоматически в зависимости от времени восхода и заката солнца.
        info:
          1. В настройках девайса выставлено время за 5 минут до наступления восхода солнца в текущем местоположении
          2. В меню выбран слой карты 'Схема'
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/new_maps_settings.png){title=QR-код}

        `yandexmaps://add_exp?new_maps_settings`
    - do: Перезапустить приложение
    - do: Открыт экран 'Основные' в настройках.
    - do: Тап в строку 'Тёмный режим'
    - assert: Появился экран 'Тёмный режим' с чекбоксами, подсказкой и кнопкой 'Основные' слева сверху
    - do: Выбрать вариант 'Автоматически'
    - assert: |
        В зависимости от выставленного времени и предыдущей настройки 'Тёмный режим' может изменится цветовая схема приложения.
        ВЫКЛ -> Автомат (из светлой темы переходит в темную)
        ВКЛ -> Автомат (темная тема была, темная осталась)
        [iOS 13]: Системное (светлое) -> Автомат (из светлой темы переходит в темную)
        [iOS 13]: Системное (тёмное) -> Автомат (темная тема была, темная и осталась)
    - do: Выйти из настроек
    - assert: Открыт главный экран приложения с картой  Цветовая схема не изменилась
    - do: Тап на любой POI или остановку ОТ
    - assert: Открылась миникарточка организации На карте поднялся пин
    - do: Подождать 5 минут
    - assert: После пересечения времени восхода цветовая схема изменяется на светлую (присутствует задержка до 10 мин) МЯК полностью адаптируется под изменённую цветовую схему

    - platforms:
        - ios
    - tags:
        - assessors
        - new_settings
