components: toponym_card
testing:
  - regress

specs:
  Тапабельные дома и реки, открытие миникарточки организации:
    - info: |
        Открыт главный экран, ночной режим не включен(Меню - Настройки - Основные - Ночной режим).
        Выставлен зум 18.
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено.
        В центре здания отобразился пин, указаны красными стрелочками и точками входы в здание (если есть).
        Открылась миникарточка самой популярный организации расположенной в здании, карточка содержит:
          * адрес
          * время доезда и расстояние
          * внизу миникарточки блок с экшн-кнопками Маршрут, Поделиться, кнопка добавления в закладки
    - do: Тап топоним реки
    - assert: |
        Выделение здания из предыдущего шага отменилось.
        Скрылась миникарточка организации из предыдущего шага.
        Закрылась тапнутая река полностью выделена.
        Открылась миникарточка топонима, карточка содержит:
          * адрес
          * время доезда и расстояние и протяженность реки
          * внизу миникарточки блок с экшн-кнопками Маршрут, Поделиться, кнопка добавления в закладки

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map


  Вызов карточки топонима с помощью лонг-тап меню:
    - info: Открыт главный экран приложения
    - do: Лонг-тап по карте
    - assert: |
        Отображается лонг-тап меню
        Присутствует кнопка Что здесь?
    - do: Тап по Что здесь?
    - assert: |
        Отображается мини-карточка топонима
        В мини-карточке отображаются:
        - Адрес
        - Расстояние/время до точки
        - Координаты и кнопка их копирования в виде трех точек
        - Action-бар, прибитый к нижнему краю, с кнопками: Маршрут, кнопка такси, Поделиться, кнопка сохранения в закладки
        Пин Что здесь? отображается в месте лонг-тапа
    - do: Лонг-тап в другом месте экрана
    - assert: |
        Отображается лонг-тап меню
        Присутствует кнопка Что здесь?
    - do: Тап по Что здесь?
    - assert: |
        Отображается мини-карточка другого топонима
        Пин Что здесь? отображается в месте лонг-тапа

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Вызов карточки топонима через поиск:
    - info: Отображается главный экран приложения
    - do: Тап на поисковую строку
    - do: Ввести запрос с существующим адресом
    - assert: Отображается саджесты по данному запросу
    - do: Тап на Найти
    - assert: |
        Отображается мини-карточка топонима
        В мини-карточке отображаются:
        - Адрес
        - Координаты и кнопка их копирования в виде трех точек
        - Расстояние/время до точки
        Action-кнопки (Маршрут, кнопка такси, Поделиться и кнопка добавления в закладки) прибиты к нижнему краю
        Топоним отображается в центре экрана
        На карте отображается активный пин топонима
        Над карточкой топонима не отображаются поисковые саджесты
    - do: Тап на поисковую строку
    - do: Очистить поисковую строку
    - do: Выполнить поиск по другому существующему адресу
    - assert: |
        Отображается мини-карточка топонима
        Топоним отображается в центре экрана
        На карте отображается активный пин топонима
        В поисковой строке отображается новый адрес

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - mapkit_ready


  Закрытие полной карточки текущего местоположения одним свайпом вниз:
    - info: Открыта полная карточка текущего местоположения
    - do: Свайп вниз до самого низа экрана.
    - assert: Карточка текущего местоположения свернулась в плашку. Полностью закрыть карточку ММП свайпом невозможно.

    - platforms:
        - android
    - tags:
        - assessors


  Открытие карточки текущего местоположения:
    - info: |
        ММП определено
        Пин ММП отображается на здании
        Отображается спан карты с пином ММП
    - do: Тап по пину ММП
    - assert: |
        Открыта мини-карточка ММП, где есть:
        - Заголовок Моё местоположение
        - Адрес Блок координат и кнопка их копирования
        - (Android) Кнопка Калибровка компаса
        - Внизу блок action-кнопок (Маршрут, кнопка такси, Поделиться, кнопка сохранения в закладки)
    - do: Развернуть карточку ММП до полной (свайпом вверх или тапом)
    - assert: |
        Отображается полная карточка ММП
        В карточке отображаются:
        - Заголовок Моё местоположение
        - кнопка закрытия
        - Адрес
        - Блок с координатами и кнопкой копирования координат
        - Кнопка вызова такси
        - Могут отображаться превью панорамы
        - Блок Ближайшие станции метро (если есть рядом)
        - Могут отображаться блок Рядом [n] организаций или Организации в здании
        - Кнопка Добавить организацию
        - Внизу блок с action-кнопками
    - do: Свернуть карточку ММП
    - do: Тап по пину ММП
    - assert: |
        Карточка ММП закрылась
        Отображается мини-карточка топонима, расположенного под меткой ММП

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready
        - newbie


  Закрытие полной карточки текущего местоположения:
    - info: |
        Отображается главный экран приложения
        ММП определено
    - do: Тап на пин ММП
    - assert: Отображается мини-карточка текущего местоположения
    - do: Раскрыть мини-карточку до полной (свайпом вверх или тапом)
    - assert: Отображается полная карточка текущего местоположения
    - do: (Android) Тап на системную кнопку назад или на крестик / (iOS) Тап на крестик
    - assert: |
        Карточка закрылась
        Отображается главный экран приложения

    - platforms:
        - android
        - ios
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - mapkit_ready


  Проверка правильности координат в карточках топонимов:
    - info: |
        Проверяем, правильные ли координаты отображаются в карточках топонимов.
        Нужно убедиться в том, что, например, для разных точек в одном парке показываются разные координаты, а не координаты из карточки парка.
        Открыты карты maps.yandex.ru В МЯК открыта форма поиска
    - do: Провести поиск по запросу Минск, Улица Немига
    - assert: На карте отображен пин топонима Улица Немига
    - do: Закрыть поиск и вызвать миникарточку топонима лонгтапом по карте -> Что здесь? в том же месте, где появился пин результата поиска
    - assert: Открывается миникарточка топонима
    - do: Тап на кнопку копирования и сохранить, например, в Заметки
    - assert: Координаты топонима скопированы корректно. Координаты топонима вставлены в заметку
    - do: Закрыть миникарточку и лонгтап по улице в запоминающемся месте (например, по ул. Немига в районе Макдональдса) -> Что здесь?
    - assert: Открыта миникарточка топонима (ул. Немига)
    - do: Тап по блоку Координаты и сохранить в ту же заметку, куда были вставлены координаты из предыдущих шагов
    - assert: |
        Координаты из предыдущих шагов отличаются.
        Для каждой точки на улице или в парке показываются уникальные координаты, а не координаты ближайшего топонима
    - do: В maps.yandex.ru вызвать миникарточку топонима в том же месте
    - assert: В МЯК и maps.yandex.ru координаты совпадают(возможно отклонение в последних двух цифрах)

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map


  Открытие мини-карточки топонима тапом по зданию на главном экране:
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Открыт главный экран приложения
        Спан содержит фрагмент города
        Выставлен максимальный зум 21
    - do: Тап любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание (при наличии)
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - координаты
        - расстояние до здания/время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается главный экран приложения
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Сменить тему оформления приложения
    - do: Установить 16 - 18 зум
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание
        На 16 зуме стрелки, указывающие на входы, не отображаются
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - расстояние до здания, время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается главный экран приложения
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Установить 15 зум
    - do: Тап на любое здание
    - assert: Здание не тапабельное
    - do: Изменить зум на 16 - 19
    - do: Тап любое здание
    - do: Уменьшить зум до 15
    - assert: |
        Здание всё ещё выделено
        Скрыты все стрелки и точки, указывающие на вход
        Внутри здания отображается активный пин
        Открыта мини-карточка топонима
    - do: Уменьшить зум
    - assert: |
        Ранее выделенное здание не отображается на карте
        Остаётся открыта мини-карточка топонима
        Отображается активный пин

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - use_map
        - mapkit_ready


  Открытие мини-карточки топонима тапом по зданию на экране результатов поиска списком:
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Открыт экран результатов поиска
        Список результатов поиска свернут
        Спан содержит фрагмент города
        Выставлен максимальный зум 21
    - do: Тап любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание (при наличии)
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - координаты
        - расстояние до здания/время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается экран результатов поиска
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Закрыть результаты поиска
    - do: Сменить тему оформления приложения
    - do: Выполнить поиск по любой категории
    - do: Свернуть результаты поиска
    - do: Установить 16 - 18 зум
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание
        На 16 зуме стрелки, указывающие на входы, не отображаются
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - расстояние до здания, время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается экран результатов поиска
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Установить 15 зум
    - do: Тап на любое здание
    - assert: Здание не тапабельное
    - do: Изменить зум на 16 - 19
    - do: Тап любое здание
    - do: Уменьшить зум до 15
    - assert: |
        Здание всё ещё выделено
        Скрыты все стрелки и точки, указывающие на вход
        Внутри здания отображается активный пин
        Открыта мини-карточка топонима
    - do: Уменьшить зум
    - assert: |
        Ранее выделенное здание не отображается на карте
        Остаётся открыта мини-карточка топонима
        Отображается активный пин

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - use_map
        - mapkit_ready


  Открытие мини-карточки топонима тапом по зданию на экране выбора маршрута:
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Построен произвольный маршрут
        Отображается экран выбора маршрута
        Спан содержит фрагмент город
        Выставлен максимальный зум 21
    - do: Тап любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание (при наличии)
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - координаты
        - расстояние до здания/время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается экран выбора маршрута
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Вернуться на главный экран приложения
    - do: Сменить тему оформления приложения
    - do: Открыть экран выбора маршрута
    - do: Установить 16 - 18 зум
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено
        Стрелочкой и точкой указаны входы в здание
        На 16 зуме стрелки, указывающие на входы, не отображаются
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - расстояние до здания, время доезди и расстояние
        - блок с action-кнопками Маршрут, Поделиться, кнопкой добавления в закладки
    - do: Тап крестик в мини-карточке
    - assert: |
        Отображается экран выбора маршрута
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Установить 15 зум
    - do: Тап на любое здание
    - assert: Здание не тапабельное
    - do: Изменить зум на 16 - 19
    - do: Тап любое здание
    - do: Уменьшить зум до 15
    - assert: |
        Здание всё ещё выделено
        Скрыты все стрелки и точки, указывающие на вход
        Внутри здания отображается активный пин
        Открыта мини-карточка топонима
    - do: Уменьшить зум
    - assert: |
        Ранее выделенное здание не отображается на карте
        Остаётся открыта мини-карточка топонима
        Отображается активный пин

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Открытие мини-карточки топонима тапом по зданию на экране ведения по маршруту:
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Открыт экран ведения по произвольному маршруту
        Спан содержит фрагмент города
        Выставлен максимальный зум 21
    - do: Тап любое здание
    - assert: |
        Здание полностью выделено
        Внутри здания отображается активный пин
        Открылась миникарточка топонима, карточка содержит:
        - адрес (город, индекс (при наличии))
        - координаты
        - время доезда (Android) и расстояние
        - внизу мини-карточки блок с action-кнопками Сюда, Заехать, Поделиться, кнопкой добавления в закладки
    - do: Тапом на крестик закрыть мини-карточку топонима
    - assert: |
        Отображается экран ведения по маршруту
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Сменить тему оформления приложения
    - do: Изменить зум на 16-18
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено
        Внутри здания отображается активный пин
        Открылась мини-карточка топонима, карточка содержит:
        - адрес(город, индекс (при наличии))
        - координаты
        - время доезда (Android) и расстояние
        - внизу миникарточки блок с action-кнопками Сюда, Заехать, Поделиться, кнопкой добавления в закладки
    - do: Тап на крестик в мини-карточке топонима
    - assert: |
        Отображается экран ведения по маршруту
        Здание не выделено
        Активный пин топонима не отображается
        Мини-карточка топонима закрылась
    - do: Установить 15 зум
    - do: Тап на любое здание
    - assert: Здание не тапабельное
    - do: Установить 16 - 19 зум
    - do: Тап на любое здание
    - do: Уменьшить зум до 15
    - assert: |
        Здание всё ещё выделено
        Скрыты все стрелки и точки, указывающие на вход
        Отображается активный пин топонима
        Открыта мини-карточка топонима
        (iOS) Мини-карточка топонима свернулась до микрокарточки
    - do: Уменьшить зум
    - assert: |
        Здание исчезает с карты
        Остаётся открыта мини-карточка топонима
        (iOS) Открыта микрокарточка топонима
        Отображается активный пин топонима

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Невозможность открытия мини-карточки топонима тапом по зданию на экране Указать на карте при построении маршрута:
    - info: Выставлен максимальный зум 21
    - do: Выключить эксперимент no_routes_tab (Настройки - Debug Panel - Experiments)
    - do: Перезапустить приложение
    - do: Тап на таб Маршруты
    - do: Тап Куда
    - do: Тап Указать на карте
    - do: Тап на любое здание
    - assert: |
        Здание не тапабельное
        Камера не меняет положение
        Мини-карточка топонима не открывается
    - do: Установить 15 - 18 зум
    - assert: Здание не тапабельное

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Невозможность открытия мини-карточки топонима тапом по зданию на экране выбора места на карте для закладки 'Дом/Работа':
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Пользователь авторизован
        Не добавлены в закладки Дом/Работа
        Открыт экран выбора места Дома/Работы на карте:
        Меню -> Закладки и мой транспорт -> тап Добавить в блоке Дом/Работа
        Выставлен максимальный зум 21
    - do: Тап на любое здание
    - assert: |
        Здание не тапабельное
        Камера не меняет положение
        Мини-карточка топонима не открывается
    - do: Установить 15 - 18 зум
    - assert: Здание не тапабельное

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Невозможность открытия мини-карточки топонима тапом по зданию на экране установки дорожного события:
    - info: |
        Установлен дневной режим в приложении (Меню -> Настройки -> Основные)
        Открыт экран установки дорожного события (Лонг-тап по карте -> Добавить дорожное событие)
        Спан содержит фрагмент города
        Выставлен максимальный зум 21
    - do: Тап любое здание
    - assert: |
        Здание не тапабельное
        Камера не меняет положение
        Мини-карточка топонима не открывается
    - do: Изменить зум на 15 - 18
    - assert: Здание не тапабельное

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - use_map
        - mapkit_ready


  Попытка открытия мини-карточки топонима тапом по зданию без сети:
    - info: |
        Приложение запущено
        Открыт главный экран приложения
        Офлайн-карты не скачаны (Меню -> Загрузка карт)
        Спан содержит фрагмент города
        Выставлен зум 16 - 19
        Выключен интернет
    - do: Тап на здание, которое еще не тапали
    - assert: |
        Здание полностью выделено
        Мини-карточка топонима не открывается
        Внизу экрана показалась плашка 'Нет информации' с кнопкой перезагрузки
    - do: Тап на крестик в информационной плашке
    - assert: |
        Отображается главный экран приложения
        Выделение здания отменилось
        Информационная плашка скрылась
    - do: Сменить тему оформления приложения (Меню -> Настройки -> Основные)
    - do: Вернуться на главный экран приложения
    - do: Тап здание, которое еще не тапали
    - assert: |
        Здание полностью выделено синим прозрачным цветом
        Мини-карточка топонима не открывается
        Внизу экрана показалась плашка 'Нет информации' с кнопкой перезагрузки

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - use_map
        - mapkit_ready


  Кнопка Обновить в оффлайн карточке топонима:
    - info: |
        Скачан кэш текущего региона
        Выключен интернет
    - do: Открыть карточку топонима
    - assert: Отображается мини-карточка топонима
    - do: Полностью раскрыть карточку топонима
    - assert: В карточке написано "Ошибка связи, повторите попозже"
    - do: Включить интернет
    - assert: |
        Блок с надписью обновился
        В блоке появилась кнопка Обновить
    - do: Тап на кнопку Обновить
    - assert: После загрузки отображается карточка с полной информацией

    - platforms:
        - android
    - testing:
        - acceptance_maps


  Тапабельные дома, открытие миникарточки топонима:
    - info: |
        Открыт главный экран, ночной режим не включен(Меню - Настройки - Основные - Ночной режим).
        Выставлен зум 18.
    - do: Тап на любое здание
    - assert: |
        Здание полностью выделено.
        В центре здания отобразился пин, указаны красными стрелочками и точками входы в здание (если есть).
        Открылась миникарточка топонима, карточка содержит:
          * адрес
          * время доезда и расстояние
          * внизу миникарточки блок с экшн-кнопками Маршрут, Поделиться, кнопка добавления в закладки
    - do: Тап другое здание
    - assert: |
        Выделение здания из предыдущего шага отменилось.
        Скрылась миникарточка топонима из предыдущего шага.
        Закрылась тапнутое здание полностью выделено.
        В области здания отобразился пин, указаны красными стрелочками и точками входы в здание(если есть).
        Открылась миникарточка топонима, карточка содержит:
          * адрес
          * время доезда и расстояние
          * внизу миникарточки блок с экшн-кнопками Маршрут, Поделиться, кнопка добавления в закладки
    - do: тап в свободное место на карте.
    - assert: ничего не произошло, миникарточка топонима не закрылась
    - do: Тап на крестик
    - assert: миникарточка топонима закрылась, пин опустился, выделение здания пропало

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map

  Вызвать Такси в карточке топонима:
    - do: Открыть полную карточку топонима
    - assert: В карточке присутствует  'Вызвать Такси'
    - do: Тап на кнопку 'Вызвать Такси'
    - assert: |
        Открывается страница в маркете 'Яндекс.Go', если приложение не установлено.
        Открывается приложение 'Яндекс.Go', если оно установлено
    - do: Повторить предыдущие шаги с карточками POI/организациями
    - assert: |
        Открывается страница в маркете 'Яндекс.Go', если приложение не установлено.
        Открывается приложение 'Яндекс.Go', если оно установлено

    - platforms:
        - ios
        - android
    - tags:
        - assessors

  Отображение адреса в мини-карточке топонима:
    - info: Открыт участок карты с минимум одним зданием
    - do: Лонг тап на здание -> Что здесь?
    - assert: |
        Открылась мини-карточка топонима
        В мини-карточке отображается:
        - короткий адрес
        - координаты
        - подстрочник с названием города и индексом
        - при определённом местоположении - расстояние до здания
        - строка координат и кнопка их копирования в виде многоточия
        - кнопка 'Маршрут', кнопка 'Поделиться', кнопка 'Сохранить', кнопка 'Такси'
        - Контролы зума на экране могут переместиться вверх (связано с размерами отступа между контролами зума и местоположения)
        - Индекс есть не всегда, в случае его отсутствия, не отображается
    - do: Сменить ориентацию устройства
    - assert: |
        Открыта полная карточка топонима
        В карточке отображается:
        - короткий адрес
        - подстрочник с названием города и индексом при определённом местоположении
        - координаты
        - строка координат и кнопка их копирования в виде многоточия
        - блок action-кнопок, прибитый к нижнему краю ('Маршрут', К подъезду (если подъезды есть и их больше 1), 'Поделиться', 'Сохранить')
        - блоки 'Вызвать такси'
        - 'Показать входы' (при наличии)
        - 'Ближайшие станции метро' (при наличии)
        - кнопка 'Исправить неточность'
        - панорама/AR (iOS)
        - блок 'Организации в здании' или 'Рядом N организаций'
        - кнопка 'Добавить объект'
        - Индекс есть не всегда, в случае его отсутствия, не отображается

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map


  Добавить организацию через карточку топонима:
    - info: |
        Открыта миникарточка топонима.
        Пользователь находится в одном из регионов РКУБ
        Выключен эксперимент web-feedback
    - do: Тап по миникарточке или свайп вверх
    - assert: |
        Открывается полная карточка топонима.
        В самом низу присутствует кнопка Добавить организацию(на IOS  дополнительно отображается кнопка под блоком координат)
    - do: Тап по Добавить организацию
    - assert: Открывается экран добавления организации
    - do: Заполнить обязательные поля и тап Отправить
    - assert: |
        На экране появится сообщение с благодарностью 'Спасибо, что помогаете делать Яндекс.Карты лучше.'.
         Внизу кнопка Отлично
    - do: Тап Отлично
    - assert: |
        Экран закрывается.
        Открывается полная карточка топонима

    - platforms:
        - ios
    - tags:
        - assessors



  Кнопки действий в карточке топонима:
    - do: Тап по любому топониму
    - assert: |
        Открыта миникарточка топонима.
        Внизу экрана отображаются экшен-кнопки:
          * 'Маршрут' синего цвета
          * 'Поделиться'
          * 'Сохранить в закладки'
    - do: Тап по миникарточке
    - assert: |
        Открыта полная карточка организации.
        Экшен-кнопки по прежнему отображаются внизу экрана и никуда не съехали
    - do: Свайп вверх по карточке
    - assert: |
        Карточка прокручивается.
        Экшен-кнопки по прежнему отображаются внизу экрана и никуда не съехали

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map

  Копирование адреса из карточки топонима:
    - info: Открыта мини-карточка топонима
    - do: Лонгтап по заголовку мини-карточки
    - assert: |
        Появляется меню Копировать | Поделиться
    - do: Тап по Копировать
    - assert: |
        В буфер обмена скопирован адрес топонима
        Облако исчезает
    - do: Вставить скопированную информацию, например, в заметки
    - assert: |
        В заметки вставлен скопированный адрес топонима
        Адрес не отличается от того, что указан в карточке топонима

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps


  Добавлении категории организации в офлайне:
    - do: Тап по любому зданию на карте
    - assert: |
        Открывается миникарточка здания.
        В миникарточке отображаются:
          * Короткий адрес в заголовке(например, Георгиевский переулок, 2)
          * Адрес в подстрочнике (например, Москва, Россия, 125009)
          * координаты (iOS)
          * Индекс может не отображаться в зависимости от его наличия
          * Расстояние от местоположения пользователя(если определено)
          * Кнопка маршрута с временем доезда
          * Крестик закрытия
    - do: Тап по миникарточке
    - assert: |
        Открывается полная карточка здания.
        В полной карточке имеются:
          * Блок с кнопками Сохранить и Поделиться
          * Вызвать такси
          * Блок как добраться: Ближайшие станции метро(при наличии) и парковки
          * Показать подъезды (при наличии)
          * Панорама улицы
          * Исправить неточность
          * Блок Организации в здании(при наличии)
          * Ниже кнопка Добавить объект
    - do: Тап по кнопке Добавить объект
    - assert: |
        Открывается форма добавления организации.
        Первые три блока:
          * Название(помечен звёздочкой)
          * Короткое название (Если необходимо)
          * Категория (помечен звёздочкой) с кнопкой Добавить
    - do: Включить авиарежим, выключить Wi-Fi и мобильный интернет на устройстве
    - assert: |
        Авиарежим включён.
        Запрещена передача данных по сети Wi-Fi.
        Выключен Мобильный интернет выключен
    - do: Тап Добавить в блоке Категория
    - assert: |
        Открывается экран выбора категорий.
        Кнопка Готово неактивна.
        Фокус в поле ввода, открыта клавиатура.
        Приложение не крэшится, работает стабильно

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map

  Отображение кнопки Координаты в полной карточке топонима:
    - do: Тап по любому зданию и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Открыть полную карточку ММП
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Вызвать лонгтап меню в произвольном месте, тап Что здесь? и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Произвести поиск произвольного топонима и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты

    - platforms:
        - ios
    - tags:
        - assessors
        - use_map

  Отображение галереи в карточке топонима:
    - do: Открыть карточку топонима, для которого добавлено менее 10-ти фото
    - assert: |
        Отображается полная карточка топонима.
        Android: Над блоком отзывов отображается галерея с фото (для некоторых зданий фото может отсутствовать, либо отображаться над кнопкой вызова такси)
    - do: (Android)Тап на фото в галерее
    - do: (iOS)Тап на таб Фото
    - assert: |
        Отображается таб Фото
    - do: Тап на фото
    - assert: |
        Открывается выбранное фото
        В заголовке карточки отображается номер выбранного фото и общее количество фото
        В нижней панели отображается троеточие меню
    - do: Закрыть галерею и карточку топонима
    - assert: Отображается главный экран приложения
    - do: Открыть карточку топонима, для которого добавлено более 10-ти фото
    - assert: |
        Отображается полная карточка топонима.
        Над блоком отзывов отображается галерея с фото (для некоторых зданий фото может отсутствовать, либо отображаться над кнопкой вызова такси)
    - do: (Android)Тап на фото в галерее
    - do: (iOS)Тап на таб Фото
    - assert: |
        Отображается таб Фото
    - do: Тап на фото
    - assert: |
        Открывается выбранное фото
        В заголовке карточки отображается номер выбранного фото и общее количество фото
        В нижней панели отображается иконка вызова меню
    - do: Тап на иконку меню
    - assert: |
        Отображаются кнопки Сохранить фото и Поделиться
        Может отображаться кнопка Пожаловаться
    - do: Тап Сохранить фото
    - assert: |
        Отображается системное оповещение о скачанном файле на устройстве
        Фото сохранено
    - do: Повторно открыть меню
    - assert: |
        Отображаются кнопки Сохранить фото и Поделиться
        Может отображаться кнопка Пожаловаться
    - do: Тап Поделиться
    - assert: Отображается поп-ап с выбором приложения для отправки фото
    - do: Поделиться фото с тестовым аккаунтом в мессенджере или почтовом клиенте
    - assert: |
        Фото отправлено
        В сообщении с фотографией отображается адрес топонима

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - newbie

  Отображение снимка панорам над карточкой организации:
    - do: Тап по зданию с панорамой
    - assert: |
        Отображается миникарточка топонима
        Над карточкой нет снимка панорам
    - do: Развернуть карточку топонима
    - assert: |
        Отображается развернутая карточка топонима
        В верхней части экрана над заголовком отображается снимок из панорамы
        В правом нижнем углу снимка панорамы отображается кнопка "Панорама"
    - do: Тап по Панораме
    - assert: |
        Открывается экран панорамы улицы напротив выбранного здания
        Панорама направлена на топоним

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - assessors
        - use_map


  Цена на Такси в карточке топонима - переход в Такси:
    - info: |
        Установлен эксперимент taxi_open_webview = null
        Приложение Яндекс.Go установлено
        Местоположение пользователя - Москва
    - do: Тап на здание на карте
    - assert: |
        Отображается миникарточка топонима
        Кнопка Такси отображается после кнопки Маршрут
    - do: Развернуть карточку
    - assert: |
        Кнопка вызова такси отображается только в теле карточки
        Если есть данные - отображается цена поездки
    - do: Тап на кнопку вызова такси
    - assert: |
        Открывается Яндекс.Go
        Предложенный маршрут соответствует маршруту, построенному в Картах
        Если  Карты отображали цену: Цена за поездку совпадает с ценой, указанной в Картах
    - do: Удалить приложение Яндекс.Go
    - assert: Приложение Яндекс.Go удалено
    - do: Вернуться в Карты
    - assert: Открыта миникарточка топонима
    - do: Тап на кнопку вызова такси в Action-баре
    - assert: Открывается страница приложения Яндекс.Go в магазине

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - newbie
        - assessors
        - use_map

  Цена на Драйв в карточке топонима - переход в Драйв:
    - info: |
        Приложение Я.Драйв установлено
        ММП в городе с поддержкой Драйва (Москва, Санкт-Петербург, Казань)
        Подмена ММП для Android: Mock Location; для iOS: Debug-Panel -> Routes -> Enter your route (построить произвольный маршрут и поставить скорость 1 км/ч)
    - do: Тап на здание на карте на дальнем расстоянии от ММП
    - assert: |
        Отображается миникарточка топонима
        Кнопка Драйва отображается после кнопки "Маршрут"
        В Action-баре отображается кнопка Драйва с указанной ценой поездки
        Если нет данных о цене - кнопка не отображается
    - do: Тап на кнопку Драйва
    - assert: |
        Открывается Я.Драйв
    - do: Удалить приложение Я.Драйв
    - assert: Приложение Я.Драйв удалено
    - do: Вернуться в Карты
    - assert: Отображается миникраточка топонима
    - do: Закрыть миникарточку топонима
    - assert: |
       Карточка топонима закрыта
    - do: Открыть карточку топонима
    - assert: Кнопка Драйва больше не отображается в карточке топонима

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
    - tags:
        - newbie
        - assessors
        - use_map

  Цена на Такси и Драйв в карточке топонима при потере интернет-соединения:
    - info: |
        На устройстве есть интернет-соединение
        Приложение Я.Драйв установлено
        ММП в городе с поддержкой Драйва (Москва, Санкт-Петербург, Казань)
        Подмена ММП для Android: Mock Location; для iOS: Debug-Panel -> Routes -> Enter your route (построить произвольный маршрут и поставить скорость 1 км/ч)
        Загружена офлайн-карта региона
    - do: Тап на здание на дальнем расстоянии от ММП
    - assert: |
        Отображается миникарточка топонима
        В Action-баре отображается кнопка вызова Такси и Драйв с указанной ценой поездки
        Кнопки отображаются в последовательности Маршрут, Такси, Драйв
    - do: Закрыть карточку топонима
    - assert: Отображается главный экран приложения
    - do: Перевести устройство в авиа-режим
    - assert: На устройстве нет интернет-соединения
    - do: Тап на здание на дальнем расстоянии от ММП
    - assert: |
        Отображается миникарточка топонима
        Кнопка вызова Такси и Драйв в Action-баре не отображается
    - do: Развернуть карточку топонима
    - assert: Кнопка вызова Такси и Драйв не отображаются
    - do: Закрыть карточку топонима и выключить авиа-режим на устройстве
    - assert: Интернет-соединение восстановлено
    - do: Тап на здание на дальнем расстоянии от ММП
    - assert: |
        Отображается миникарточка топонима
        В Action-баре отображается кнопка вызова Такси и Драйв с указанной ценой поездки
        Кнопки отображаются в последовательности Маршрут, Такси, Драйв

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map
# в аксептансе не проверяем потому что в офлайн-картах есть кейсы на открытие карточки топонима.
# При %-ой выкладке, во время прохождения рана наверняка будет устройство, на котором будет пройден данный сценарий

  Отсутствие кнопок с ценой на Такси и Драйв в Action-баре при неизвестном местоположении пользователя:
    - info: |
        Первый запуск приложения
        Приложение Я.Драйв установлено
    - do: Запустить приложение и запретить доступ к местоположению
    - assert: Местоположение пользователя не определено
    - do: Перезапустить приложение
    - assert: Отображается главный экран приложения
    - do: Тап на здание
    - assert: |
        Отображается миникарточка топонима
        Кнопка вызова Такси и Драйв в Action-баре не отображаются
    - do: Развернуть карточку топонима
    - assert:
        Кнопка вызова Такси и Драйв отображаются только в теле карточки
        Цена поездки не отображается

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map
        - newbie
    - testing:
        - acceptance_maps

  Одновременное отображение цен на Такси и Драйв в карточке топонима:
    - info: |
        Приложение Я.Драйв установлено
        ММП в городе с поддержкой Драйва (Москва, Санкт-Петербург, Казань)
        Подмена ММП для Android: Mock Location; для iOS: Debug-Panel -> Routes -> Enter your route (построить произвольный маршрут и поставить скорость 1 км/ч)
    - do: Тап на здание на дальнем расстоянии от ММП
    - assert: |
        Отображается миникарточка топонима
        В Action-баре отображаются кнопки вызова Такси и Драйва с ценой
        (Драйв может не отобразиться если нет данных о цене, в таком случае открыть карточку другого здания)
        Кнопки Такси и Драйва отображаются после кнопки Маршрут

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - use_map


  Отображение блока Как добраться в карточке топонима:
    - info: Отображается мини карточка топонима около метро
    - do: Развернуть карточку топонима
    - assert: |
        Отображается блок Как добраться, в котором присутствуют:
        Ближайшие станции метро
        (iOS) Присутствует кнопка Показать парковки
    - do: Тап по Ближайшие станции метро
    - assert: Список ближайших станций метро развернулся
    - do: Тап по Ближайшие станции метро
    - assert: Список ближайших станций метро свернулся
    - do: (iOS) Тап на Показать парковки
    - assert: |
        Отображается мини-карточка топонима
        Слой парковок включен

    - platforms:
      - ios
      - android
    - tags:
      - assessors
      - newbie
    - testing:
      - acceptance_maps


  Переход в таб Фото у топонима:
    - info: Открыта карточка топонима
    - do: Тап на таб Фото
    - assert: |
        Открыта галерея
    - do: Тап на фото
    - assert: |
        Отображается фотография на весь экран
    - do: Вернуться на таб Обзор, свайпом опустить карточку чтобы открыть фотографию над карточкой
    - assert: |
        В верхней части отображается фотография/панорама
    - do: Тап на фото в верхней части экрана
    - assert: |
        iOS: Открыта фотография
        Android: Открыт таб Фото с галереей
    - do: Вернуться на таб Обзор
    - assert: |
        Открыт таб Обзор
        Отображается полная карточка организации
    - do: Проскроллить карточку до блока с галереей и тап по фото (шаг не актуален для iOS)
    - assert: |
        Открыт таб Фото с галереей
    - do: Тап на одно из фото (шаг не актуален для iOS)
    - assert: |
        Отображается фото на весь экран
    - do: Проверить отображение фото у топонима, найденного через поиск
    - assert: |
        Результат аналогичный проверке таба Фото по сценариям выше

    - tags:
        - assessors
    - testing:
        - acceptance_maps
    - platforms:
        - android
        - ios


  Переход в таб Фото у топонима через закладки:
    - info: Открыта карточка топонима с фото через закладки
    - do: Тап на таб Фото
    - assert: |
        Открыта галерея
    - do: Тап на фото
    - assert: |
        Отображается фотография на весь экран
    - do: Вернуться на таб Обзор, свайпом опустить карточку чтобы открыть фотографию над карточкой
    - assert: |
        В верхней части отображается фотография/панорама
    - do: Тап на фото в верхней части экрана
    - assert: |
        iOS: Открыта фотография
        Android: Открыт таб Фото с галереей
    - do: Вернуться на таб Обзор
    - assert: |
        Отображается полная карточка организации
    - do: Проскроллить карточку до блока с галереей и тап по фото
    - assert: |
        Открыт таб Фото с галереей
    - do: Тап на одно из фото
    - assert: |
        Отображается фото на весь экран

    - tags:
        - assessors
    - platforms:
        - android
        - ios

  Кнопка Обновить. Оффлайн карточка топонима:
    - info: |
        Скачан кэш текущего региона
        Выключен интернет
    - do: Открыть карточку топонима
    - assert: Отображается мини-карточка топонима
    - do: Полностью раскрыть карточку топонима
    - assert: В самом низу карточки присутствует блок с надписью о том, что "Чтобы увидеть больше информации нужно подключиться к интернету"
    - do: Включить интернет
    - assert: |
        Блок с надписью обновился
        В блоке появилась кнопка Обновить
    - do: Тап на кнопку Обновить
    - assert: После загрузки отображается карточка с полной информацией

    - platforms:
        - android
    - testing:
        - acceptance_maps
        - lite_acceptance_maps
    - tags:
        - assessors
        - newbie

  Добавить объект в карточке топонима:
    - info: |
        Открыта полная карточка топонима
        Девайс в вертикальной ориентации
    - do: Тап по кнопке "Добавить объект"
    - assert: Открывается вебвью "Добавить объект на карту"
    - do: Закрыть вебвью и карточку топонима
    - do: Перевести устройство в горизонтальную ориентацию
    - do: Открыть карточку любого дома
    - assert: |
        Открыта полная карточка дома
        В карточке присутствует кнопка "Добавить объект"
    - do: Закрыть карточку
    - do: Тап на таб Навигатор
    - do: Открыть карточку любой улицы
    - assert: |
        Открыта полная карточка улицы
        В карточке присутствует кнопка "Добавить объект"
    - do: Закрыть карточку
    - do: Перейти в режим ведения по произвольному маршруту
    - do: Открыть карточку подъезда
    - assert: |
        Открыта полная карточка подъезда
        В карточке присутствует кнопка "Добавить объект"

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Отображение кнопок Такси и Драйв в карточке топонима:
    - info: |
        Приложение Я.Драйв установлено
        ММП в городе с поддержкой Драйва (Москва, Санкт-Петербург, Казань)
        Подмена ММП для Android осуществляется через приложение Mock Location
        Девайс в вертикальной ориентации
    - do: Тап на топоним
    - assert: |
        Отображается миникарточка топонима
        В Action-баре отображаются кнопки вызова Такси и Драйва с ценой
        (Драйв может не отобразиться если нет данных о цене, в таком случае открыть карточку другого здания)
        Кнопки Такси и Драйва отображаются после кнопки Маршрут
    - do: Раскрыть карточку
    - assert: Кнопки Такси и Драйва переместились в тело карточки
    - do: Сменить ориентацию девайса
    - assert: |
        Кнопки Такси и Драйва отсутствуют в теле карточки
        Кнопки Такси и Драйва отображаются в action-баре карточки

    - platforms:
        - android
    - tags:
        - assessors
        - use_map


  Отображение фотогалереи в табе "Фото" в карточке топонима:
    - info: Девайс в вертикальной ориентации
    - do: Открыть карточку топонима, в которой больше 3-х фото (например,Котельническая набережная, 1/15)
    - assert: Открыта мини-карточка топонима
    - do: Открыть полную карточку топонима
    - assert: |
        Открылась полная карточка топонима
        Открыт таб "Обзор"
        В табе "Обзор" отображается не больше 3-х фото
    - do: Тап на таб  "Фото"
    - assert: |
        Открылся таб "Фото"
        Отображается больше 3-х фотографий

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Отображение фотографии из фотогалереи в табе "Фото" в карточке топонима:
    - info: Девайс в вертикальной ориентации
    - do: Открыть карточку топонима, в которой больше 3-х фото (например,Котельническая набережная, 1/15)
    - assert: Открыта мини-карточка топонима
    - do: Открыть полную карточку топонима
    - assert: |
        Открылась полная карточка топонима
        Открыт таб "Обзор"
        В табе "Обзор" отображается не больше 3-х фото
    - do: Тап на таб  "Фото"
    - assert: |
        Открылся таб "Фото"
        Отображается больше 3-х фотографий
    - do: Тап на фотографию из фотогалереи
    - assert: |
        Отображается выбранная фотография топонима
        Под фотографией отображается название аккаунта автора фото с аватаркой

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Совпадение длины пути до топонима указанной в карточке с длинной пути указанной на экране выбора маршрута:
    - preconditions: Отображается главный экран приложения
    - do: Тап на здание
    - assert: |
        Отображается мини-карточка топонима
        Присутствует информация о длине пути до топонима
    - do: Тап на action-кнопку Маршрут
    - assert: |
        Отображается экран выбора маршрута
        Длина пути указанная в карточке маршрута соответствует указанной в карточке топонима

    - platforms:
        - android
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_maps


  Отображение расстояния по прямой в карточке топонима, если не пришли данные о длине маршурта:
    - info: |
        При отсутствии информации о длине маршрута до точки, в карточке будет отображаться информация о расстоянии по прямой
    - preconditions: Отображается главный экран приложения
    - do: |
        Построить маршрут, используя интент:
        [collapsed-image](https://jing.yandex-team.ru/files/linakolpakova/маршрут_не_строится.png){title=QR}

        `yandexmaps://build_route_on_map/?lat_to=58.401698&lon_to=38.530076`
    - assert: |
        Отображается экран выбора маршрута
        Маршрут не построен
    - do: Тап на пин конечной точки на карте
    - assert: |
        Отображается мини-карточка топонима
        Присутствует информация о расстоянии по прямой до топонима

    - platforms:
        - android
    - tags:
        - assessors


  Загрузка данных о длине пути в карточке топонима:
    - info: |
        Изменить режим сети можно в настройках мобильных сетей на девайсе
    - preconditions: |
        Режим сети 2G
        Отображается главный экран приложения
    - do: Тап на здание
    - assert: |
        Отображается мини-карточка топонима
        Происходит загрузка данных о длине и времени пути до топонима
        На месте незагруженных данных отображается шиммер
    - do: Дождаться загрузки данных
    - assert: |
        Отображается информация о длине и времени пути до топонима
        Шиммер не отображается

    - platforms:
        - android
        - ios
    - tags:
        - assessors

