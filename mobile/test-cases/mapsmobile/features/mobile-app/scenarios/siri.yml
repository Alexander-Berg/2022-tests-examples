components: siri
testing:
  - regress

specs:
  Добавление Siri Shortcut для остановки ОТ:
    - info: |
        МЯК запущен, отображается главный экран приложения.
        Остановка не добавлена в Siri Shortcut
    - do: Тап на любую остановку ОТ
    - assert: Отобразилась миникарточка остановки
    - do: Тап на миникарточку или свайп вверх
    - assert: |
        Отобразилась полная карточка остановки.
        Под разделом с панорамой и дополненной реальностью (если есть) отобразился раздел 'Открывайте карточку остановки' с кнопкой 'Добавить для Siri'
    - do: Тап на 'Добавить для Siri'
    - assert: |
        Отобразился экран добавления shortcut для Siri.
        В левом верхнем углу кнопка Отменить.
        В верхней половине экрана по центру отобразились логотип Siri, 'Добавить для Siri', 'Где автобус?', в одной строчке логотип яндекс карт с надписью 'Яндекс.Карты'.
        В нижней половине экрана по центру надпись 'После того как Вы записали персонализированную фразу, Siri сможет использовать ее, чтобы запустить эту быструю команду в программе 'Яндекс.Карты' и кнопка для записи фразы в виде красного круга
    - do: Тап на кнопку для записи
    - assert: Активировалась запись Siri Shortcut для остановки
    - do: Сказать любую фразу для записи, например 'Один'
    - assert: |
        Отобразился экран подтверждения записанной фразы:
        В верхней части экрана в левом углу отобразилась кнопка 'Отменить', в правом - 'Готово'.
        По центру экрана отобразилась надпись 'Где автобус', ниже логотип я.карт с надписью 'Яндекс.Карты', ниже записанная фраза, ниже кнопка 'Записать фразу повторно' или 'Править'
    - do: Тап кнопку 'Готово'
    - assert: |
        Экран подтверждения записанной фразы исчез.
        Отобразилась карточка остановки, для которой записывался Siri Shortcut.
        В поле 'Открывайте карточку остановки' отобразилась кнопка с галочкой и надписью о том, какая фраза добавлена
    - do: Свернуть приложение и перейти в Настройки –> Siri и поиск –> Мои быстрые команды и убедиться, что карточка остановки ОТ сохранена
    - assert: Карточка остановки ОТ сохранена в Siri Shortcut
    - do: Открыть нашу карточку остановки ОТ в приложении и убедиться, что поле для записи в Siri Shortcut не отображается
    - assert: В карточке остановки ОТ не отображается кнопка для добавления записи в Siri Shortcut
    - platforms:
        - ios
    - tags:
        - assessors
        - use_map


  Открытие карточки остановки через голосовой запрос в Siri:
    - info:
        Остановка ОТ добавлена в Siri Shortcut например со словом 'Остановка'
    - do: Вызвать Siri, как именно зависит от настроек и от телефона
    - assert: Siri активирована и готова принимать голосовой запрос
    - do: Сказать добавленное в Siri Shortcut слово 'Остановка'
    - assert: |
        Открылось приложение Яндекс.Карты.
        Открылась карточка остановки ОТ, сохраненная в Siri Shortcut со словом 'Остановка'
    - platforms:
        - ios
    - tags:
        - assessors


  Удаление быстрой команды Siri на открытие карточки остановки ОТ:
    - info: Остановка ОТ добавлена в Siri Shortcut например со словом 'Остановка'
    - do: Перейти в быстрые команды Siri (Настройки - Siri и Поиск - Мои быстрые команды
    - assert: Отобразился список сохраненных команд
    - do: В правом верхнем углу тап на 'Править' и удалить команду для открытия остановки
    - assert: Команда удалена из списка
    - do: Вызвать Siri, как именно зависит от настроек и от телефона
    - assert: Siri активирована и готова принимать голосовой запрос
    - do: Сказать добавленное в Siri Shortcut слово 'Остановка'
    - assert: |
        Приложение Яндекс.Карты не открылось.
        Siri дала ответ на запрос без привлечения Яндекс.карт
    - do: Открыть приложение Яндекс.Карты и открыть полную карточку остановки
    - assert: |
        Отобразилась полная карточка остановки.
        Под блоком с панорамой и дополненной реальностью (если есть) отобразился раздел 'Открывайте карточку остановки' с кнопкой Добавить для Siri
    - platforms:
        - ios
    - tags:
        - assessors


  Отмена добавления Siri Shortcut:
    - info: |
        МЯК запущен, отображается главный экран приложения
        Кейс проходится на устройстве с версией iOS 12 и выше
    - do: Тап на остановку ОТ, для которой не добавлена команда в Siri
    - assert: Отобразилась миникарточка остановки
    - do: Тап на миникарточку или свайп вверх
    - assert: |
        Отобразилась полная карточка остановки.
        Под разделом с панорамой и дополненной реальностью (если есть) отобразился раздел 'Открывайте карточку остановки' с кнопкой 'Добавить для Siri'
    - do: Тап на 'Добавить для Siri'
    - assert: |
        Отобразился экран добавления shortcut для Siri.
        В левом верхнем углу кнопка Отменить.
        В верхней половине экрана по центру отобразились логотип Siri, 'Добавить для Siri', 'Где автобус?', в одной строчке логотип яндекс карт с надписью Яндекс.Карты\".
        В нижней половине экрана по центру надпись 'После того как Вы записали персонализированную фразу, Siri сможет использовать ее, чтобы запустить эту быструю команду в программе Яндекс.Карты' и кнопка для записи фразы в виде красного круга
    - do: Тап на кнопку Отменить
    - assert: |
        Экран записи команды для Siri исчез.
        Отобразилась карточка остановки.
        Под разделом с панорамой и дополненной реальностью (если есть) отобразился раздел 'Открывайте карточку остановки' с кнопкой 'Добавить для Siri'
    - platforms:
        - ios
    - tags:
        - assessors
        - use_map


  Отображение Siri при отсутствующих маршрутах:
    - info: |
        МЯК запущен, отображается главный экран приложения.
        Пользователь не авторизован или авторизован, но маршруты домой и на работу не сохранены
    - do: Открыть экран Маршрут
    - assert: |
        Открылся экран Маршрут.
        Кнопка для сохранения Siri Shortcut отсутствует на экране
    - platforms:
        - ios
    - tags:
        - assessors


