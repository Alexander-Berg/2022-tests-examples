components: migrations
testing:
  - regress

specs:
  #закладки
  Миграция закладок и списков из Нави в МЯК только при первом запуске UI:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить несколько закладок и несколько списков
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: На экране отображаются закладки, созданные в Нави
    - do: Свернуть МЯК
    - do: Открыть Нави
    - do: Добавить закладку и список
    - do: Развернуть МЯК
    - do: Переоткрыть экран Меню - Закладки и мой транспорт
    - assert: На экране не отображаются новые закладки и списки
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: На экране отображаются все добавленные в Нави закладки и списки
    - do: Открыть спан карты с закладками
    - assert: На карте отображаются закладки, добавленные в Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Миграция закладок и списков из незалогина Нави в залогин МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список в Нави
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Закладка и список из Нави отображаются на экране
    - do: Открыть спан карты с закладками
    - assert: Закладки отображаются на карте

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции закладок и списков из залогина Нави в залогин МЯК разными аккаунтами:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован другим аккаунтом отличным от аккаунта в Нави
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список
    - do: Открыть МЯК Меню - Закладки и мой транспорт
    - assert: Список и закладка из Нави не отображается в Меню - Закладки и мой транспорт
    - do: Открыть спан карты с закладками Нави
    - assert: Закладка не отображается на карте

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Миграция изменения имени списка в Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список через лонгтап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Закладка и список из Нави отображается в МЯК
    - do: Закрыть МЯК
    - do: Открыть Нави
    - do: Тап на Закладки в таббаре
    - assert: На экране Мои места отображается список с закладкой добавленные ранее
    - do: Тап на карандаш рядом с названем экрана
    - do: Тап на карандаш рядом со списком добавленным ранее
    - do: Изменить название списка и сохранить
    - assert: В разделе Списки у редактируемого списка изменилось название
    - do: Открыть и перезапустить МЯК
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: |
        Открылся экран Мои места и транспорт
        В разделе Мои списки отображается и список с обновлённым названием, и список со старым названием
        Закладка находится в списке с новым названием

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции после изменения имени списка в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список через лонгтап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Закладка и список из Нави отображается в МЯК
    - do: Изменить название списка
    - assert: В разделе Списки у редактируемого списка изменилось название
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: |
        В разделе Мои списки отображается список с обновлённым названием
        Список с названием из Нави не мигрировал в МЯК

    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Миграция изменения имени закладки в Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить новую закладку и новый список через лонг тап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: В МЯК отображаются добавленный список и закладка
    - do: Открыть Нави
    - do: Изменить название закладки
    - do: Выгрузить приложение МЯК из памяти
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: |
        В списке отображается закладка с новым именем
        Закладка со старым именем не отображается

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Перемещение закладки:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Добавить новую закладку и новый список через лонг тап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: В МЯК отображаются добавленный список и закладка
    - do: Выгрузить из памяти МЯК
    - do: Открыть Нави
    - do: Создать новый список
    - do: Переместить закладку в этот список через кнопку переместить
    - do: Открыть МЯК - Меню - Закладки и Мой транспорт
    - assert: |
        Отображаются оба списка
        Закладка находится в списке, в который она была перемещена в Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции удаления закладки:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Добавить организацию в закладки
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: |
        Открылся экран Закладки
        На экране отображается закладка добавленная в Нави
    - do: Выгрузить МЯК из памяти
    - do: Открыть Нави
    - do: Тап на организацию из закладок
    - do: Удалить из закладок ранее выбранную организацию тап по кнопке в карточке
    - assert: В карточке организации кнопка закладки снова перестала быть активной
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Удалённая в Нави закладка не удалилась в МЯК

    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Слияние списков с одинаковым названием из Нави и МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks, работает начиная со сборки 6.65)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть МЯК
    - do: Тап на пин организации
    - do: Добавить организацию в закладки, создав новый список
    - do: Выгрузить МЯК из памяти
    - do: Открыть Нави
    - do: Добавить организацию (отличную от МЯК) в закладки, создав одноимённый со списком из МЯК список
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: |
        Открылся экран Закладки
        Одноимённые списки объединились в один
        В списке находятся 2 закладки, добавленные в МЯК и Нави
    - do: Открыть Нави
    - do: Перейти в таб Закладки
    - assert: |
        Отображается только созданные в Нави список и закладка
        Закладка из МЯК не мигрировала

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отключение эксперимента миграции:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Выключен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Выключен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Тап на пин организации
    - do: Добавить организацию в закладки
    - assert: Кнопка закладки в карточке организации стала акивной
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: |
        Открылся экран Закладки
        Закладка добавленная в Нави не мигрировала в МЯК

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Миграция изменения названий + миграция новых добавленных закладок:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Создать 2 закладки и 2 списка через лонг тап по карте
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Отображаются все списки и закладки добавленные в Нави
    - do: Открыть Нави
    - do: Создать еще одну закладку
    - do: Тап на таб Закладки
    - do: Переименовать все списки и закладки
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: |
        Отображаются пустые списки со старыми названиями
        Отображаются списки с новыми названиями
        Закладки содержатся в списках с новыми названиями
        Отображается ещё одна новая добавленная закладка в переименованном списке

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции после изменения имени закладки в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Создать 2 закладки и 2 списка лонг тапом по карте
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Закладки добавленные в Нави отображаются в МЯК
    - do: Переименовать одну закладку
    - do: Открыть Нави - Таб Закладки
    - do: Создать 2 новых списка
    - do: Переместить в каждый новый список по 1 ранее созданной закладке
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: |
        Закладка изменённая в МЯК не переместилась в новый список
        Закладка изменённая в МЯК не переименовалась на имя из Нави
        Список, в который была перемещена изменённая закладка в Нави, не отображается
        Закладка не изменённая в МЯК отобразилась в том списке, куда её перемещали в Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции после перемещения закладки в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks, работает начиная со сборки 6.65)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь авторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список через лонг тап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Отображаются добавленные в Нави закладка и список
    - do: Переименовать закладку и список
    - do: Перейти в Нави
    - do: Переименовать закладку и список
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: Закладка и список не мигрировали повторно под новыми названиями

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Отсутствие миграции после удаления закладки в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, developer settings -> migration -> Migration - bookmarks)
          - Нави выгружен из памяти
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент (migration_bookmarks, debug panel -> experiments -> migration_bookmarks)
          - МЯК выгружен из памяти
    - do: Открыть Нави
    - do: Добавить закладку и список через лонг тап
    - do: Открыть МЯК - Меню - Закладки и мой транспорт
    - assert: Отображаются добавленные в Нави закладка и список
    - do: Удалить закладку и список
    - do: Перейти в Нави
    - do: Переименовать закладку и список
    - do: Переоткрыть МЯК с выгрузкой из памяти
    - do: Открыть Меню - Закладки и мой транспорт
    - assert: Закладка и список не мигрировали повторно под новыми названиями

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android

  #Дом/работа
  Миграция дома и работы из Нави в МЯК без авторизации в обоих приложениях:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
            - Пользователь неавторизован
            - Получен эксперимент: developer settings -> Migration - places sync
            - В закладках добавлен адрес Дома
            - Отсутсвует адрес Работы
        Перезапустить навигатор
        МЯК:
            - Пользователь неавторизован
            - Получен эксперимент: debug panel -> experiments -> migration_places
            - В закладках отсутствуют адреса в Дом/Работа
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане отображается метка дома по адресу, мигрированного из Нави
        Метка работы отсутствует
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома мигрирован из Нави
        Адрес работы отсутствует
    - do: Закрыть МЯК с выгрузкой из памяти
    - do: Открыть Нави
    - do: Тап на закладки в таббаре (в Нави)
    - assert: |
        Открыт экран "Мои места"
        Адрес дома отображается
        Адрес работы отсутствует
    - do: добавить любой адрес в Работа (в Нави)
    - assert: |
        Адрес работы добавлен
    - do: Запустить МЯК
    - assert: |
        Отображается спан карты МЯК
        На спане отображается метка работы по адресу, мигрированного из Нави
        Отображается метка дома по адресу, ранее мигрированного из Нави
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес работы мигрирован из Нави
        Адрес дома отображается, ранее мигрированный из Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android


  Миграция только Работы из Нави в МЯК без авторизации в обоих приложениях:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закладках добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь неавторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках добавлен адрес Дома, отличный от адреса в Нави
          - Отсутствует адрес Работы
    - do: Перезапустить МЯК с выгрузкой из памяти
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома не мигрирован из Нави
        Адрес работы мигрирован из Нави

    - platforms:
        - ios
        - android


  Отсутствие миграции из Нави в МЯК, если Дом и Работа добавлены, без авторизации в обоих приложениях:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закаладках добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках добавлены адреса в Дом/Работа, отличные от адресов в Нави
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане отображаются метки дома и работы, немигрированные из Нави
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома и работы не мигрирован из Нави

    - platforms:
        - ios
        - android


  Миграция Дома и Работы из неавторизованного Нави в авторизованный МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: Developer Settings - Migration - Migration-places sync - On
          - В закладках добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках отсутствуют адреса в Дом/Работа
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане отображаются метки дома и работы, мигрированные из Нави
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома и работы мигрирован из Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android


  Миграция только Дома из неавторизованного Нави в авторизованный МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закладках добавлены адреса в Дома/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках добавлен адрес Работы, отличный от адреса Работы в Нави
          - Отсутствует адрес Дома
    - do: Перезапустить МЯК с выгрузкой из памяти
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес работы не мигрирован из Нави
        Адрес дома мигрирован из Нави
    - platforms:
        - ios
        - android


  Отсутствие миграции Дома и Работы из неавторизованного Нави в авторизованный МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration -> places sync
          - В закладках добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках добавлены адреса в Дом/Работа, отличные от адресов в Нави
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане отображаются метки дома и работы, немигрированные из Нави
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома и работы немигрирован из Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android


  Отсутствие миграции из Нави в Мяк при авторизации разными аккаунтами:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь авторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закладках добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован аккаунтом, отличным от Нави
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках отсутствуют адреса в Дом/Работа
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане не отображаются мигрированные метки дома и работы
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома и работы немигрирован из Нави
    - do: Выйти из аккаунта в МЯК
    - assert: |
        Пользователь неавторизован
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        Отображается спан карты
        На спане не отображаются мигрированные метки дома и работы
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома и работы немигрирован из Нави

    - platforms:
        - ios
        - android


  Отсутствие синхронизации дома и работы в МЯК при удалении в Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закладки добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках имеются, мигрированные ранее, дом и работа из Нави
        МЯК закрыт с выгрузкой из памяти
        В Нави открыт экран "Мои места"
    - do: Удалить адреса дома и работы
    - assert: |
        Адрес дома удален
        Адрес работы удален
    - do: Запустить МЯК
    - assert: |
        Отображается спан карты
        На спане отображаются метки дома и работы, мигрированные ранее
    - do: Тап меню (в МЯК)
    - do: Тап на Закладки и мой транспорт (в МЯК)
    - assert: |
        Открыт экран "Мои места и транспорт"
        Отображается адрес дома и работы, ранее мигрированный из Нави

    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android


  Отсутствие миграции при сворачивании и разворачивании приложения:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены приложения Нави и МЯК
        Нави:
          - Пользователь неавторизован
          - Получен эксперимент: developer settings -> Migration - places sync
          - В закладки добавлены адреса в Дом/Работа
        МЯК:
          - Пользователь авторизован
          - Получен эксперимент: debug panel -> experiments -> migration_places
          - В закладках имееются мигрированные дом и работа из Нави
        В МЯК открыт экран "Мои места и транспорт"
    - do: Удалить адреса дома и работы
    - assert: |
        Адрес дома удален
        Адрес работы удален
    - do: Свернуть МЯК
    - do: Развернуть МЯК
    - assert: |
        Открыт экран "Мои места и транспорт"
        Адрес дома отсутствует
        Адрес работы отсутствует
    - do: Выйти на главный экран приложения МЯК
    - assert: |
        Отображается спан карты
        На спане не отображаются метки дома и работы

    - platforms:
        - ios
        - android


  Логирование ошибки миграции дом/работа из Нави в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
        - Чистая установка или чистка данных
        МЯК:
        - Пользователь может быть как авторизован, так и неавторизован
        - Получен эксперимент: debug panel -> experiments -> migration_places
        - В закладках отсутствуют адреса в Дом/Работа
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> error, message -> content is empty, entity_type -> places

    - platforms:
        - ios
        - android


  Логирование миграции мест дом/работа из Нави в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
        В Нави лучше смотреть логи через лог-панель в приложении, так как в logcat не видны параметры как в МЯК и придется искать по времени и дате события
        Открыть лог-панель в Нави (Меню -> Настройки -> developer settings -> logs panel -> Enable Logs Penel -> on)
        На главном экране приложения свайпом влево-вправо можно регулировать прозначность лог-панели, также есть кнопка жестов для переключения на пенель / интерфейс приложения и логи можно скопировать в буфер лонг-тапом
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
        - Пользователь неавторизован
        - В закладках отсутствуют адреса в Дом/Работа
        - Получен эксперимент: developer settings -> Migration - places sync
        МЯК:
        - Пользователь может быть как авторизован, так и неавторизован
        - В закладках отсутствуют адреса в Дом/Работа
        - Получен эксперимент: debug panel -> experiments -> migration_places
    - do: Перезапустить Нави с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count 0, status -> save
    - do: Добавить в закладках Нави Дом/Работа
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count <1>  или <2>, status -> save
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        На спане отображаются мигрированные метки дома и работы
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> null, status -> attempt
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count <1>  или <2>, status -> success

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_maps
        - acceptance_navi


  Логирование миграции дом/работа из Нави в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
        В Нави лучше смотреть логи через лог-панель в приложении, так как в logcat не видны параметры как в МЯК и придется искать по времени и дате события
        Открыть лог-панель в Нави (Меню -> Настройки -> developer settings -> logs panel -> Enable Logs Penel -> on)
        На главном экране приложения свайпом влево-вправо можно регулировать прозначность лог-панели, также есть кнопка жестов для переключения на пенель / интерфейс приложения и логи можно скопировать в буфер лонг-тапом
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
        - Пользователь неавторизован
        - В закладках отсутствуют адреса в Дом/Работа
        - Получен эксперимент: developer settings -> Migration - places sync
        МЯК:
        - Пользователь может быть как авторизован, так и неавторизован
        - В закладках отсутствуют адреса в Дом/Работа
        - Получен эксперимент: debug panel -> experiments -> migration_places
    - do: Перезапустить Нави с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count 0, status -> save
    - do: Добавить в закладках Нави Дом/Работа
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count <1>  или <2>, status -> save
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        На спане отображаются мигрированные метки дома и работы
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> null, status -> attempt
        В логи приходит событие `application.migration.update` с параметрами entity_type-> places, message-> count <1>  или <2>, status -> success

    - platforms:
        - ios
        - android


  #История поиска
  Синхронизация истории поиска между неавторизованными пользователями из МЯК в Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлен Яндекс.Навигатор
        Включен эксперимент: Dev.Setting -> Migration - histories sync
        Пользователь не авторизован
        Оба приложения были выгружены из памяти устройства
        Открыты Яндекс.Карты
        Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
    - do: Ввести произвольный запрос в строку поиска
    - assert: Отображаются сниппеты по запросу на экране поиска
    - do: Тап на Найти
    - assert: Открылся экран результатов поиска по введенному запросу
    - do: Закрыть поисковую выдачу
    - assert: Открыт главный экран приложения
    - do: Тап на поисковую строку
    - assert:
        Отображен блок "История"
        Искомый запрос вверху списка
    - do: Открыть Яндекс.Навигатор
    - assert: Открыт главный экран приложения
    - do: Тап на таб "Поиск"
    - assert: В истории поиска отображается поисковый запрос, ранее сделанный через приложение Яндекс.Карты

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Синхронизация истории поиска между неавторизованными пользователями из Нави в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены Яндекс.Карты
        Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
        Пользователь не авторизован
        Оба приложения были выгружены из памяти устройства
        Открыт Яндекс.Навигатор
        Включен эксперимент: Dev.Setting -> Migration - histories sync
    - do: Тап на поиск
    - assert: Отображается экран поиска
    - do: Ввести произвольный запрос в строку поиска
    - assert: Отображаются сниппеты по запросу на экране поиска
    - do: Тап на Найти
    - assert: Открылся экран результатов поиска по введенному запросу
    - do: Закрыть поисковую выдачу
    - assert: Открыт главный экран приложения
    - do: Открыть Яндекс.Карты
    - assert: Открыт главный экран приложения
    - do: Тап на строку поиска
    - assert: В истории поиска отображается поисковый запрос, ранее сделанный через приложение Яндекс.Навигатор


    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Синхронизация истории маршрута между неавторизованными пользователями из МЯК в Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлен Яндекс.Навигатор
        Включен эксперимент: Dev.Setting  -> Migration - histories sync
        Пользователь не авторизован
        Оба приложения были выгружены из памяти устройства
        Открыты Яндекс.Карты
        Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
    - do: Построить любой маршрут
    - do: Завершить маршрут
    - assert: Открыт главный экран приложения
    - do: Тап на таб "Маршруты"
    - assert: Внизу отображается последний построенный маршрут
    - do: Закрыть таб "Маршруты"
    - assert: Открыт главный экран приложения
    - do: Открыть Яндекс.Навигатор
    - assert: Открыт главный экран приложения
    - do: Тап на таб "Мои места"
    - assert: Открыт экран "Мои места"
    - do: Тап на таб "недавние"
    - assert: В истории маршрутов отображается маршрут, ранее построенный через приложение Яндекс.Карты

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Синхронизация истории маршрута между неавторизованными пользователями из Нави в МЯК:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлены Яндекс.Карты
        Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
        Пользователь не авторизован
        Оба приложения были выгружены из памяти устройства
        Открыт Яндекс.Навигатор
        Включен эксперимент: Dev.Setting -> Migration - histories sync
    - do: Построить любой маршрут
    - do: Завершить маршрут
    - assert: Открыт главный экран приложения
    - do: Тап на таб "Мои места"
    - assert: Открыт экран "Мои места"
    - do: Тап на таб "Недавние"
    - assert: Отображается последний построенный маршрут
    - do: Открыть Яндекс.Карты
    - assert: Отображается главный экран приложения
    - do: Тап на таб "Маршруты"
    - assert: В истории маршрутов отображается маршрут, ранее построенный через приложение Яндекс.Навигатор

    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors
    - platforms:
        - ios
        - android


  Логирование миграции истории поиска/маршрутов между МЯК и Нави:
    - info: |
        Между какими сборками происходит миграция данных:
        Prod <-> Prod
        Dev/PR <-> Dev/PR
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент: Dev.Setting -> Migration - histories sync
          - Перезапустить приложение
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
          - Перезапустить приложение
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> attempt, message -> "", entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> attempt, message -> "", entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> success, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> success, message -> count <n>, entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history
    - do: Выполнить поиск
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
    - do: Построить маршрут
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history
    - do: Перезапустить Нави с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> attempt, message -> "", entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> attempt, message -> "", entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> success, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> success, message -> count <n>, entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history
    - do: Выполнить поиск
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
    - do: Построить маршрут
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history

    - platforms:
        - ios
        - android


  Логирование ошибки миграции истории поиска/маршрутов в МЯК:
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
          - Чистая установка или чистка данных
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
    - do: Перезапустить МЯК с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> error, message -> content is empty, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> error, message -> content is empty, entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history

    - platforms:
        - ios
        - android


  Логирование ошибки миграции истории поиска/маршрутов в Нави:
    - info: |
        В Нави лучше смотреть логи через лог-панель в приложении, так как в logcat не видны параметры как в МЯК и придется искать по времени и дате события
        Открыть лог-панель в Нави (Меню -> Настройки -> developer settings -> logs panel -> Enable Logs Penel -> on)
        На главном экране приложения свайпом влево-вправо можно регулировать прозначность лог-панели, также есть кнопка жестов для переключения на пенель / интерфейс приложения и логи можно скопировать в буфер лонг-тапом
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент: Dev.Setting -> Migration - histories sync
        МЯК:
          - Чистая установка или чистка данных
    - do: Перезапустить Нави с выгрузкой из памяти
    - assert: |
        В логи приходит событие `application.migration.update` с параметрами status -> error, message -> content is empty, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> error, message -> content is empty, entity_type -> route_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> count <n>, entity_type -> route_history

    - platforms:
        - ios
        - android


  Логирование очистки миграции истории поиска/маршрутов в МЯК и Нави:
    - info: |
        В Нави лучше смотреть логи через лог-панель в приложении, так как в logcat не видны параметры как в МЯК и придется искать по времени и дате события
        Открыть лог-панель в Нави (Меню -> Настройки -> developer settings -> logs panel -> Enable Logs Penel -> on)
        На главном экране приложения свайпом влево-вправо можно регулировать прозначность лог-панели, также есть кнопка жестов для переключения на пенель / интерфейс приложения и логи можно скопировать в буфер лонг-тапом
    - info: |
        Установлено приложение Нави и МЯК
        Девайс подключен к устройству для снятия логов
        Нави:
          - Пользователь неавторизован
          - Включен эксперимент: Dev.Setting -> Migration - histories sync
          - Перезапустить приложение
        МЯК:
          - Пользователь неавторизован
          - Включен эксперимент: Debug-panel -> Experiments -> Migration_histories
          - Перезапустить приложение
    - do: Залогиниться в МЯК
    - assert: |
        Подтянулась история поиска/маршрутов аккаунта
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> clean, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> clean, entity_type -> route_history
    - do: Залогиниться в Нави
    - assert: |
        Подтянулась история поиска/маршрутов аккаунта
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> clean, entity_type -> search_history
        В логи приходит событие `application.migration.update` с параметрами status -> save, message -> clean, entity_type -> route_history

    - platforms:
        - ios
        - android


  Автологин пользователей Навигатора в Мяке:
    - info: |
        На устройстве установлена продовая сборка Навигатора - из магазина (стора)
        Пользователь залогинен в Навигаторе
        В Навигаторе включена настройка (Developer Settings -> Migration - UID for autologin)
        Навигатор перезапущен после включения настроек
        Пользователь не логинился в МЯК ранее
        iOS: в МЯК получен/включен эксперимент (navi_users_autologin)
        Android: в МЯК получены/включены эксперименты (navi_users_autologin и inapps_enabled)
        Приложение МЯК закрыто с выгрузкой из памяти
    - do: Запустить МЯК
    - assert: |
        Появилось уведомление с аватаркой пользователя об автологине аккаунтом из Навигатора
        Уведомление не тапабельно
    - do: Выйти из аккаунта
    - do: Перезапустить приложение с выгрузкой из памяти
    - assert: |
        Открыт главный экран приложения
        Автологина не происходит

    - tags:
        - assessors
        - parity
    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android


  Автологин пользователей из Навигатора в МЯК на девайсах с IDFA:
    - info: |
        ТК проходим с версии iOS 14.5 и выше
        Между какими сборками происходит миграция данных:
          - Prod <-> Prod
          - Dev/PR <-> Dev/PR
    - info: |
        Установить начисто Навигатор и МЯК
    - do: Запустить Навигатор и пройти все интро-скрины
    - do: Авторизоваться в Навигаторе
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/yandexnavi-%3A%3Aadd_exp%3Fnavi_feature_navi_users_autologin.png){title=QR-код}

        `yandexnavi://add_exp?navi_feature_navi_users_autologin=enabled`
    - do: Перезапустить Навигатор
    - do: Запустить МЯК
    - assert: |
        Запускается МЯК
        Показан запрос на предоставление доступа к геолокации
    - do: Выдать доступ к геолокации
    - assert: Показан поп-ап про "Навигатор теперь в картах"
    - do: |
        Пока показан поп-ап про "Навигатор теперь в картах" использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/yandexmaps-%3A%3Aadd_exp%3Fnavi_users_autologin.png){title=QR-код}

        `yandexmaps://add_exp?navi_users_autologin`
    - do: Перезапустить МЯК
    - assert: Показан запрос на IDFA
    - do: Выдать или отклонить доступ к IDFA
    - assert: |
        Запрос на предоставление доступа к IDFA пропал
        Появилось уведомление об автологине аккаунтом из Навигатора

    - testing:
        - acceptance_maps
    - platforms:
        - ios


  Автологин пользователей из Навигатора в МЯК на девайсах без IDFA:
    - info: |
        ТК проходим с версии ниже чем iOS 14.5
        Между какими сборками происходит миграция данных:
          - Prod <-> Prod
          - Dev/PR <-> Dev/PR
    - info: |
        Установить начисто Навигатор и МЯК
    - do: Запустить Навигатор и пройти все интро-скрины
    - do: Авторизоваться в Навигаторе
    - do: |
        Использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/yandexnavi-%3A%3Aadd_exp%3Fnavi_feature_navi_users_autologin.png){title=QR-код}

        `yandexnavi://add_exp?navi_feature_navi_users_autologin=enabled`
    - do: Перезапустить Навигатор
    - do: Запустить МЯК
    - assert: |
        Запускается МЯК
        Показан запрос на предоставление доступа к геолокации
    - do: Выдать доступ к геолокации
    - assert: Показан поп-ап про "Навигатор теперь в картах"
    - do: |
        Пока показан поп-ап про "Навигатор теперь в картах" использовать интент [collapsed-image](https://jing.yandex-team.ru/files/kuznetsova22/yandexmaps-%3A%3Aadd_exp%3Fnavi_users_autologin.png){title=QR-код}

        `yandexmaps://add_exp?navi_users_autologin`
    - do: Перезапустить МЯК
    - assert: Показана плашка с предложением скачать офлайн карты
    - do: Тап в плашке "Не сейчас"
    - assert: |
        Плашка с предложением скачать офлайн карты скрылась
        Появилось уведомление об автологине аккаунтом из Навигатора

    - testing:
        - acceptance_maps
    - platforms:
        - ios


  Аватарка автологина пользователей Навигатора в Мяке в оффлайне:
    - info: |
        На устройстве установлен Навигатор
        Пользователь залогинен в Навигаторе
        В Навигаторе включена настройка (Developer Settings -> Migration - UID for autologin)
        Навигатор перезапущен после включения настроек
        Пользователь не логинился в МЯК ранее
        iOS: в МЯК получен/включен эксперимент (navi_users_autologin)
        Android: в МЯК получены/включены эксперименты (navi_users_autologin и inapps_enabled)
        Приложение МЯК закрыто с выгрузкой из памяти
        Включен режим полета
    - do: Запустить МЯК
    - assert: |
        Появилось уведомление без аватарки пользователя об автологине аккаунтом из Навигатора
        Уведомление не тапабельно
    - do: Выйти из аккаунта
    - do: Перезапустить приложение с выгрузкой из памяти
    - assert: |
        Открыт главный экран приложения
        Автологина не происходит

    - tags:
        - assessors
        - parity
    - testing:
        - acceptance_maps
        - acceptance_navi
    - platforms:
        - ios
        - android
