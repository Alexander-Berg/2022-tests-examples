components: cpaa_plus
testing:
  - regress

specs:
  CP/AA. Подписка плюс. Авторизация через интро аккаунтом с подпиской:
    - info: |
        - Пользователь не авторизован
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На устройстве запущено приложение
    - do: На ГУ/Симуляторе запустить приложение
    - assert: Отображается экран с информацией о доступности приложения по подписке на Яндекс.Плюс
    - do: |
        - АА: Тап "В телефон"
        - CP: Тап "Продолжить в телефоне"
    - assert: |
        - На телефоне открылся экран интро
        - В интро отображаются 3 кнопки:
            (Android) Подключить, Узнать больше и Закрыть
            (IOS) Подключить, Подробнее и Закрыть
    - do: Тап "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: Открылся Аккаунт Менеджер
    - do: Авторизоваться аккаунтом с плюсом (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - assert: |
        На устройстве:
          - АМ закрылся
          - Пользователь авторизован
          - Открылся главный экран (карта)
          - Открылась заглушка AA/CP
        На ГУ/Симуляторе:
          - Фуллскрин-заглушка с информацией о подписке на плюс закрылось
          - Открыта карта

    - platforms:
        - carplay
        - android_auto
    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors


  CP/AA. Подписка плюс. Авторизация через интро аккаунтом без подписки:
    - info: |
        - Пользователь не авторизован
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
    - do: На ГУ/Симуляторе запустить приложение
    - assert: Отображается экран с информацией о доступности приложения по подписке на Яндекс.Плюс
    - do: |
        - АА: Тап "В телефон"
        - CP: Тап "Продолжить в телефоне"
    - assert: |
        - На телефоне открылся экран интро
        - В интро отображаются 2 кнопки: Подключить и Закрыть
    - do: Тап "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: Открылся Аккаунт Менеджер
    - do: Авторизоваться аккаунтом без подписки плюса
    - assert: |
        На устройстве:
          - АМ закрылся
          - Пользователь авторизован
          - Открылась шторка Плюса
        На ГУ/Симуляторе:
          - Фуллскрин-заглушка с информацией о подписке на плюс не закрылся

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к авто авторизованным пользователем без подписки на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован не плюсовым аккаунтом
    - do: |
        - Подключить телефон к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Запустить приложение на ГУ/Симуляторе
    - assert: |
        - На ГУ/Симуляторе открылся фуллскрин экран, информирующий об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к авто авторизованным пользователем с подпиской на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - do: |
        - Подключить телефон к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Запустить приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся главный экран

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Перелогин аккаунта, при подключенной ГУ, с экрана карты:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение запущено на CP/AA
        - Открыт главный экран
    - do: |
        - На телефоне:
          - Тап по "Продолжить в телефоне"
          - Открыть меню приложения
          - Разлогиниться
        - Открыть приложение на ГУ/Симуляторе
    - assert: На ГУ открылся фуллскрин экран с информацией об отсутствии плюса
    - do: |
        АА: Тап "В телефон"
        CP: Тап "Продолжить в телефоне"
    - assert: На телефоне открылся интроскрин. Может звучать приветственная фраза Алисы
    - do: Тап на телефоне "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: На телефоне открылся Аккаунт менеджер
    - do: |
        - Авторизоваться аккаунтом с плюсом
        - Развернуть приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся главный экран приложения

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Перелогин аккаунта, при подключенной ГУ, с экрана поиска:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение запущено на CP/AA
        - Пользователь находится на экране с поиском (тап по иконке "Лупы")
    - do: |
        - На телефоне:
          - Тап по "Продолжить в телефоне"
          - Открыть меню
          - Разлогиниться
        - Открыть приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся фуллскрин экран с информацией об отсутствии плюса
    - do: |
        АА: Тап "В телефон"
        CP: Тап "Продолжить в телефоне"
    - assert: На телефоне открылся интроскрин.
    - do: Тап на телефоне "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: На телефоне открылся Аккаунт менеджер
    - do: |
        - Авторизоваться аккаунтом с плюсом
        - Открыто приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся главный экран карта

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Перелогин аккаунта, при подключенной ГУ в режиме фридрайва:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение запущено на CP/AA
        - Пользователь находится на главном экране
    - do: Запустить симмуляцию движения (без маршрута)
    - assert: Симмуляция движения запущена
    - do: |
        - На телефоне:
          - Тап по "Продолжить в телефоне"
          - Открыть меню
          - Разлогиниться
        Запустить приложение на ГУ/Симуляторе
    - assert: |
        - На ГУ открылся фуллскрин экран с информацией об отсутствии плюса
        - Нотификации на ГУ/Симуляторе не показаны
        - Аннотации приложения на ГУ/Симуляторе не воспроизводятся, пока активен экран "Вы подключены к Android Auto/CarPlay" (Не путать с аннотациями с телефона при воспроизведении их по Bluetooth)
    - do: |
        АА: Тап "В телефон"
        CP: Тап "Продолжить в телефоне"
    - assert: На телефоне открылся интроскрин.
    - do: Тап "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: На телефоне открылся Аккаунт менеджер
    - do: |
        - Авторизоваться аккаунтом с плюсом
        - Развернуть приложение на ГУ/Симуляторе
    - assert: |
        - На ГУ открылся главный экран приложения - карта
        - Аннотации приложения воспроизводятся
    - do: Свернуть прилоложение на ГУ/Симуляторе
    - assert: Нотификации приложения на ГУ/Симуляторе - показываются

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Перелогин аккаунта, при подключенной ГУ, с экрана результатов поиска:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение запущено на CP/AA
        - Пользователь находится на экране поиска (Тап по иконке "Лупа")
    - do: Тап по любой из категории поиска
    - assert: Открылся экран обзора с результатами поиска по выбранной категории
    - do: |
        - На телефоне:
          - Тап по "Продолжить в телефоне"
          - Открыть меню
          - Разлогиниться
        Запустить приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся фуллскрин экран с информацией об отсутствии плюса
    - do: |
        АА: Тап "В телефон"
        CP: Тап "Продолжить в телефоне"
    - assert: На телефоне открылся интроскрин
    - do: Тап "Подключить"
    - do: (Android МЯК) Тап "Подключить" еще раз
    - assert: На телефоне открылся Аккаунт менеджер
    - do: |
        - Авторизоваться аккаунтом с плюсом
        - Развернуть приложение на ГУ/Симуляторе
    - assert: На ГУ/Симуляторе открылся главный экран приложения - карта

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Проброс маршрута на ГУ разлогиненным пользователем:
    - info: |
        - Пользователь не авторизован
        - Пользователь прошел все интроскрины
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение на CP/AA не запущено / свернуто
        - Выключен эксперимент:
            - cpaa_no_plus (карты)
            - Developer settings -> Misc -> Projected -> disable plus check -> Off (навигатор)
        - Выгрузить приложение
    - do: Построить и подтвердить маршрут на телефоне
    - assert: Приложение на ГУ/Симуляторе не развернулось
    - do: Развернуть приложение на ГУ/Симуляторе
    - assert: Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto
    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors


  CP/AA. Подписка плюс. Проброс маршрута на ГУ пользователем, авторизованным НЕ плюсовым аккаунтом:
    - info: |
        - Пользователь авторизованным аккаунтом без подписки Яндекс.Плюс
        - Пользователь прошел все интроскрины
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение на CP/AA не запущено/свернуто
    - do: Построить и подтвердить маршрут на телефоне
    - assert: Приложение на ГУ/Симуляторе не развернулось
    - do: Развернуть приложение на ГУ/Симуляторе
    - assert: Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Проброс маршрута на ГУ пользователем, авторизованным плюсовым аккаунтом:
    - info: |
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Пользователь прошел все интроскрины
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Приложение на CP/AA не запущено/свернуто
    - do: Построить и подтвердить маршрут в телефоне
    - assert: |
        - Приложение на ГУ/Симуляторе развернулось
        - Открылась карта с построенным маршрутом

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к ГУ без сети. Пользователь НЕ авторизован:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь не авторизован
        - Выключена сеть или включен аварежим
    - do: |
        - Подключить телефон к ГУ/Симулятору (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ/Симуляторе
    - assert: |
        - Приложение на ГУ/Симуляторе запустилось
        - Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к ГУ без сети. Пользователь авторизован аккантом без подписки на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом без подписки Яндекс.Плюса
        - Выключена сеть или включен аварежим
    - do: |
        - Подключить телефон к ГУ/Симулятору (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ/Симуляторе
    - assert: |
        - Прилоежние на ГУ/Симуляторе запустилось
        - Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к ГУ без сети. Пользователь авторизован аккантом с подпиской на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Выключена сеть или включен аварежим
    - do: |
        - Подключить телефон к ГУ/Симулятору (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ/Симуляторе
    - assert: |
        - Приложение на ГУ/Симуляторе запустилось
        - Открылся главный экран приложения - карта

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


  CP/AA. Подписка плюс. Подключение к ГУ с медленной сети. Пользователь НЕ авторизован:
    - info: |
        - Пользователь прошел все интроскрины
        - Симитирован медленный интернет "E"(E ~ 0.8 Mbit/s) (Использовать Charles, настройки роутера или иные способы понизить пропускную способность интернета)
        - Пользователь не авторизован
    - do: |
        - Подключить телефон к ГУ (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ
    - assert: |
        - Приложение на ГУ запустился
        - Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto


  CP/AA. Подписка плюс. Подключение к ГУ с медленной сетью. Пользователь авторизован аккантом без подписки на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Симитирован медленный интернет "E"(E ~ 0.8 Mbit/s) (Использовать Charles, настройки роутера или иные способы понизить пропускную способность интернета)
        - Пользователь авторизован аккаунтом без подписки Яндекс.Плюс
    - do: |
        - Подключить телефон к ГУ (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ
    - assert: |
        - Приложение на ГУ запустилось
        - Открылся фуллскрин с информацией об отсутствии подписки на плюс

    - platforms:
        - carplay
        - android_auto


  CP/AA. Подписка плюс. Подключение к ГУ с медленной сетью. Пользователь авторизован аккантом с подпиской на плюс:
    - info: |
        - Пользователь прошел все интроскрины
        - Симитирован медленный интернет "E"(E ~ 0.8 Mbit/s) (Использовать Charles, настройки роутера или иные способы понизить пропускную способность интернета)
        - Пользователь авторизован аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - do: |
        - Подключить телефон к ГУ (Bluetooth + USB) (Включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - Запустить приложение на ГУ
    - assert: |
        - Приложение на ГУ запустилось
        - Открылся главный экран приложения (Карта)

    - platforms:
        - carplay
        - android_auto


  CP/AA. Навигатор. Проигрывание приветственной фразы Алисы в интро плюса:
    - info: |
        - Кейс актуален только для Навигатора
        - Переустановить приложение или почистить данные
        - Пользователь прошел все интроскрины приложения
        - Пользователь не авторизован в приложение или не имеет подписки Яндекс Плюс
    - do: |
        - Подключить телефон к ГУ (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - Запустить приложение на ГУ
    - assert: На ГУ открылся фуллскрин экран, информирующий об отсутствии подписки на плюс
    - do: |
        АА: Тап "В телефон"
        CP: Тап "Продолжить в телефоне"
    - assert: |
        - На девайсе открывается интроскрин плюса.
        - Звучит приветственная фраза Алисы: "Привет, это Алиса! Ещё немного и Навигатор появятся на экране вашего автомобиля. Просто подключите Яндекс Плюс."
    - do: Повторно тап по кнопке "Продолжить в телефоне" на ГУ
    - assert: Приветственная фраза не звучит

    - platforms:
        - carplay
        - android_auto