components: cpaa_map
testing:
  - regress

specs:
  CarPlay. Перемещение карты:
    - info: |
        - На устройстве запущено приложение
    - do: |
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключить к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыть главный экран тестируемого приложения
    - do: Тап по контролу Floating (кнопка с четырьмя стрелками)
    - assert: |
        - На экране с картой появились стрелки в четрые стороны
        - На навбаре отображаются кнопка ММП (Мое местоположение, "Где я?") и кнопка "Готово"
        - Контролы зума отображаются
        - Контрол "Floating" отсутствует
    - do: Тап несколько раз на каждую из стрелок
    - assert: |
        - Спан карты смещается в сторону этой стрелки
        - Метка ММП (Курсор местоположения) осталась за пределами экрана
    - do: Тап на кнопку ММП
    - assert: |
        - Карта переместилась к метке ММП
        - Стрелки навигации по карте не пропали
    - do: Тап "Готово"
    - assert: |
        - В навбаре отображаются кнопки "Закладки" и "Поиск"
        - Контрол "Floating" отображается

    - platforms:
        - carplay
    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors


  CarPlay. Зум карты:
    - info: |
        - На устройстве запущено приложение
    - do: |
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Девайс подключить к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыть главный экран тестируемого приложения
    - do: Тап по кнопке "+"
    - assert: Карта призумилась
    - do: Тап несколько раз на "-"
    - assert: Карта отзумилась
    - do: Открыть экран Floating (Кнопка с иконкой стрелочки расположенной под кнопками Зума)
    - assert: Открылся экран Floating (экран с 4мя стрелочками для взаимодействия с картой, а так же кнопки зума)
    - do: Тап по кнопке "+"
    - assert: Карта призумилась
    - do: Тап несколько раз на "-"
    - assert: Карта отзумилась

    - platforms:
        - carplay
    - testing:
        - acceptance_maps
        - acceptance_navi
    - tags:
        - assessors


  Android Auto. Мультитапы:
    - description: |
        В кейсе проверяем мультитапы по интерфейсу приложения в Android Auto
    - info: |
        - Устройство подключено к ГУ по Bluetooth
        - На устройстве запущено приложение
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - У пользователя добавлены адреса в Избранное/Дом/Работа
        - Устройство подключено к ГУ с помощью USB-кабеля
        - На ГУ открыт главный экран приложения
    - do: Быстро и одновременно много раз тап по меню Android Auto и любому из сайджесов
    - assert: Открывается что-то одно (меню Android Auto или строится маршрут выбранного сайджеста)
    - do: Закрыть открывшийся экран
    - do: Быстро и одновременно много раз тап по 2м сохраненным маршрутам в "Моих местах"
    - assert: Строится маршрут до одно из сохраненного маршрута, по которому тапали
    - do: Закрыть открывшийся экран
    - do: На главном экране быстро и одновременно много раз тап по 2м кнопкам "Поиск" и "Настройки"
    - assert: Открывается что-то одно (Поиск или Настроки)
    - do: Закрыть открывшийся экран
    - do: На главном экране быстро и одновременно много раз тап по 2м кнопкам "Поиск" и Любой сайджест
    - assert: Происходит только одно действие (Открывается экран поиска или строится маршрут выбранного сайджеста)

    - platforms:
        - android_auto


  Кастомизация подложки. Проверка загрузки карты:
    - info: |
        - Кейс только для Навигатора
        - Устройство подключено к ГУ по Bluetooth
        - На устройстве запущено приложение
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - info: Цель кейса - проверить, что на третий запуск после включения эксперимента меняется стиль подложки
    - info: Это происходит по следующей логике - 1)первый перезапуск - ничего не происходит 2)второй перезапуск - обновляются загруженные карты (если есть) 3)третий перезапуск - меняется стиль подложки, если все загруженные карты были обновлены; если карты не обновились, то подложка меняется только после полного обновления карт
    - info: Пример подложки до и после эксперимента
        [ collapsed-image ](https://jing.yandex-team.ru/files/polikashinaol/new_vmap3.png){title=светлая тема}
    - info: Телефон не подключен к ГУ по USB
    - do: Скачать кэш любого города (Меню > Загрузка карт > Выбрать любой город)
    - assert: Загрузка успешно завершена
    - do: Использовать интент для включения эксперимента
        [ collapsed-image ](https://jing.yandex-team.ru/files/polikashinaol/vmap3_enabled.png){title=QR-код}

        `yandexnavi://add_exp?navi_feature_day_night_fast_switch=enabled&navi_feature_vmap3_enabled=enabled`
    - do: Перезагрузить приложение
    - do: Подключить телефон к ГУ по USB
    - do: Перейти в приложение Навигатор в АА/СР
    - assert: Карта на ГУ загрузилась корректно, подложка не изменилась
    - do: Отключить телефон от ГУ по USB (или тап на "Продолжить в телефоне" в заглушке)
    - do: Отключить WIFI и включить мобильный интернет
    - do: Перезагрузить приложение
    - assert: Скачанный кэш начал обновляться и остановился на 0%
    - do: Подключить телефон к ГУ по USB
    - assert: Карта на ГУ загрузилась корректно, подложка не изменилась
    - do: Отключить телефон от ГУ по USB (или тап на "Продолжить в телефоне" в заглушке)
    - do: Включить WIFI
    - do: Дождаться завершения обновления скачанного кэша
    - do: Перезагрузить приложение
    - do: Подключить телефон к ГУ по USB
    - assert: Карта на ГУ загрузилась корректно, подложка изменилась
    - do: Сменить тему карт на ГУ (контрол Настройки на карте > Тема)
    - assert: Карта на ГУ загрузилась корректно, подложка изменилась

    - platforms:
        - android_auto
        - carplay
    - tags:
        - parity
    - testing:
        - acceptance_navi