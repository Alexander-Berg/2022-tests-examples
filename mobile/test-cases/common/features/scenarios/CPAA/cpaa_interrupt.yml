components: cpaa_interrupt
testing:
  - regress

specs:
   CP. Звонки:
    - preconditions: |
        - Имеется дополнительное мобильное устройтство со вставленной СИМ-картой
        - В тестируемое устройство вставлена СИМ-карта
        - На устройстве запущено приложение
        - На устройстве включена симуляция движения
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Устройство подключить к ГУ с помощью USB-кабеля
    - do: |
        - На ГУ построить и подтвердить маршрут
        - На ГУ открыть экран ведения по маршруту
    - do: Со второго телефона совершить звонок, на устройство которое подключено к ГУ
    - do: На тестируемом устройстве принять звонок
    - assert: |
        Собеседники слышат друг друга по телефону
        На ГУ отображается экран звонка
    - do: Вернуться на ГУ в тестируемое приложение
    - assert: |
        Звонок продолжается
        Принятие вызова не блокирует работу приложения
        На ГУ отображается экран ведения по маршруту
    - do: Дождаться момента, когда должна быть аннотация
    - assert: Аннотация не звучит, так как есть разговор по телефону
    - do: Завершить разговор на ГУ спустя 1,5-2 минуты
    - assert: |
        На ГУ отображается экран ведения по маршруту
        Аннотации маневров произносятся

    - platforms:
        - carplay
    - testing:
        - acceptance_maps
        - acceptance_navi


   AA. Звонки:
    - preconditions: |
        - Имеется дополнительное мобильное устройтство со вставленной СИМ-картой
        - В тестируемое устройство вставлена СИМ-карта
        - На устройстве запущено приложение
        - На устройстве включена симуляция движения
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Устройство подключить к ГУ с помощью USB-кабеля
    - do: |
        - На ГУ построить и подтвердить маршрут в произвольную точку
        - На ГУ открыть экран ведения по маршруту
    - do: Со второго телефона совершить звонок, на устройство которое подключено к ГУ
    - do: На тестируемом устройстве принять звонок
    - assert: |
        Принятие вызова не блокирует работу приложения
        На ГУ отображается экран ведения по маршруту
        Собеседники слышат друг друга по телефону
    - do: Дождаться момента, когда должна быть аннотация
    - assert: Аннотация не звучит, так как есть разговор по телефону
    - do: Завершить разговор на ГУ спустя 1,5-2 минуты
    - assert: |
        На ГУ отображается экран ведения по маршруту
        Аннотации маневров произносятся

    - platforms:
        - android_auto
    - testing:
        - acceptance_maps
        - acceptance_navi


   CarPlay. Отзыв пермишина на использование микрофона. Кнопка Позже:
    - preconditions: |
        - У тестируемого приложения отозвано разрешение на использование микрофона
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Устройство подключить к ГУ с помощью USB-кабеля
        - На ГУ открыт главный экран тестируемого приложения
    - do: Открыть поиск и тап на Микрофон
    - assert: Отображается фуллскрин ошибка с кнопками "Продолжить" и "Позже"
    - do: Тап "Позже"
    - assert: |
        Фуллскрин ошибка закрылась
        Открыт экран поиска

    - platforms:
        - carplay


   CarPlay. Отзыв пермишина на использование микрофона. Кнопка Продолжить:
    - preconditions: |
        - У тестируемого приложения отозвано разрешение на использование микрофона
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Устройство подключить к ГУ с помощью USB-кабеля
        - На ГУ открыт главный экран тестируемого приложения
    - do: Открыть поиск и тап на Микрофон
    - assert: Отображается фуллскрин ошибка с кнопками "Продолжить" и "Позже"
    - do: Тап Продолжить
    - assert: |
        На ГУ отображается фуллскрин ошибка
        На устройстве открылись Настройки приложения
    - do: Выдать доступ к микрофону
    - do: Запустить приложение в СР, открыть поиск и тап по микрофону
    - assert: |
        Фуллскрин ошибка не отображается
        Открыт голосовой поиск

    - platforms:
        - carplay


   CarPlay. Выдача пермишина на использование микрофона:
    - preconditions: |
        - У тестируемого приложения отозвано разрешение на использование микрофона
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Устройство подключить к ГУ с помощью USB-кабеля
        - На ГУ открыт главный экран тестируемого приложения
    - do: |
        - Открыть поиск и тап на Микрофон
        - Тап "Продолжить"
    - assert: |
        На ГУ отображается фуллскрин ошибка
        На устройстве открылись Настройки приложения
    - do: Выдать доступ к микрофону
    - do: Запустить приложение в СР, открыть поиск и тап по микрофону
    - assert: |
        Фуллскрин ошибка не отображается
        Открыт голосовой поиск

    - platforms:
        - carplay


   CP/AA. Отзыв пермишина геолокации при построенном маршруте:
    - preconditions: |
        - На телефоне запущено приложение
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Телефон подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе построен и подтвержден маршрут
        - На ГУ/Симуляторе открыт экран ведения по маршруту
    - do: |
        - На телефоне свернуть приложение
        - На телефоне перейти в Настройки и отключить доступ к геолокации для приложения
    - assert: |
        - На ГУ/Симуляторе, спустя непродолжительное время, показывается фуллскрин ошибка
    - do: На телефоне вернуться в тестируемое приложение
    - assert: На телефоне показывается запрос на разрешение геолокации
    - do: Перейти в настройки и разрешить доступ к геолокации
    - assert: |
        - На ГУ/Симуляторе ошибка скрылась
        - Открылся главный экран (карта)
        - Маршрут не сбрасывается

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   CP/AA. Сворачивание приложения на ГУ:
    - info: |
        - На устройстве запущено приложение
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт главный экран приложения
    - do: На ГУ/Симуляторе свернуть приложение, перейдя в любое меню в интерфейсе ГУ/Симулятора
    - assert: |
        - На ГУ/Симуляторе приложение свернулось
        - На устройстве открыт главный экран приложения
    - do: На ГУ/Симуляторе развернуть приложение (В меню CarPlay или Android Auto тап на иконку приложения)
    - assert: |
        - На ГУ/Симуляторе открыт главный экран приложения
        - На устройстве отображается экран с заглушкой

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   CP/AA. Переключение в приложение и на CP/AA. Маршрут построен, но не подтвержден:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - На устройстве запущено приложение
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ построить маршрут и не подтверждать его
    - do: На телефоне тап "Продолжить в телефоне"
    - assert: |
        - На устройстве закрылся экран с заглушкой
        - Построенный маршрут сбросился
    - do: (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert: |
        - Приложение запущено в CP/AA
        - Открыт главный экран, построенный ранее маршрут не отображается
        - На устройстве появился экран заглушка

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   CP/AA. Переключение в приложение и на CP/AA. Экран поиска:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - На устройстве запущено приложение
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт экран Поиска
    - do: На телефоне тап "Продолжить в телефоне"
    - assert: |
        - На устройстве закрылся экран с заглушкой
        - Открыт главный экран приложения
    - do: (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert: |
        - Приложение запущено в CP/AA
        - Открыт главный экран приложения
        - На телефоне отображается экран заглушка

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   CP/AA. Переключение в приложение и на CP/AA. Экран избранного:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - На аккаунте есть минимум 1 список избранного и 1 избранное в списке
        - На устройстве запущено приложение
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт экран избранного
    - do: На телефоне тап "Продолжить в телефоне"
    - assert: |
        - На устройстве закрылся экран с заглушкой
        - Открыт главный экран приложения
    - do: (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert: |
        - Приложение запущено в CP/AA
        - Открыт главный экран приложения
        - На телефоне отображается экран заглушка

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   CP/AA. Переключение в приложение и на CP/AA. Экран результаты поиска:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - На устройстве запущено приложение
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт экран поиска
    - do: Тап по любой категории
    - assert: Открылся экран обзора с результатами поиска по выбранной категории
    - do: На телефоне тап "Продолжить в телефоне"
    - assert: |
        - На устройстве закрылся экран с заглушкой
        - Открыт главный экран приложения
    - do: (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert: |
        - Приложение запущен в CP/AA
        - Открыт главный экран приложения
        - На телефоне отображается экран заглушка

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors


   Переключение между приложением и СР. Перезапуск на телефоне:
    - info: |
        - Устройство подключено к ГУ по Bluetooth
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - На устройстве запущено приложение
        - Устройство подключено к ГУ с помощью USB-кабеля
        - На ГУ открыто приложение
    - do: В телефоне тап "Продолжить в телефоне"
    - assert: |
        В телефоне:
          Экран заглушка скрылся
          Отображается главный экран приложения
        На ГУ показан экран заглушка
    - do: |
        - На устройстве перезапустить приложение
        - На устройстве тап "Продолжить в телефоне"
        - Открыть приложение в CP
    - assert: |
        На устройстве:
          Экран заглушка скрылся
          Отображается главный экран приложения
        На ГУ показан экран заглушка

    - platforms:
        - carplay


   Переключение между приложением и СР. Старт приложения на ГУ:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Телефон не подключен к ГУ
        - Приложение не запущено на телефоне
        - Телефон не заблокирован
    - do: Подключить телефон к ГУ (USB + Bluetooth)
    - assert: |
        Запущен СР
        Открыто меню приложений в СР
    - do: Запустить тестируемое приложение на ГУ
    - assert: |
        Запущено приложение в СР
        Открыт главный экран - карта
    - do: |
        - Открыть меню приложений в СР
        - Запустить приложение на телефоне
    - assert: |
        - Приложение запущено на телефоне
        - На телефоне отображается экран заглушка
        - На ГУ открыто меню приложений
    - do: В телефоне тап "Продолжить в телефоне"
    - assert: |
        В телефоне:
          Экран заглушка скрылся
          Отображается главный экран приложения
        На ГУ открыто меню приложений
    - do: |
        На ГУ открыть тестируемое приложение
        На ГУ тап "Продолжить в автомобиле"
    - assert: |
        На ГУ:
          Экран заглушка скрылся
          Отображается главный экран приложения
        В телефоне показан экран заглушка

    - platforms:
        - carplay


   Переключение между приложением и СР. Старт приложения на телефоне подключенном к ГУ:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс. Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus)
        - Телефон подключен к ГУ
        - Приложение не запущено на телефоне
        - Телефон не заблокирован
    - do: Запустить приложение на телефоне
    - assert: |
        Приложение запущено
        Показан экран заглушка
    - do: Запустить приложение в СР
    - assert: |
        Запущено приложение в СР
        Открыт главный экран - карта
    - do: В телефоне тап "Продолжить в телефоне"
    - assert: |
        В телефоне:
          Экран заглушка скрылся
          Отображается главный экран приложения
        На ГУ показан экран заглушка
    - do: На ГУ тап "Продолжить в автомобиле"
    - assert: |
        На ГУ:
          Экран заглушка скрылся
          Отображается главный экран приложения
        В  телефоне показан экран заглушка

    - platforms:
        - carplay
