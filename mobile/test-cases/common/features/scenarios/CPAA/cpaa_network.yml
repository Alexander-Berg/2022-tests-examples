components: cpaa_network
testing:
  - regress

specs:
  CP/AA. Оффлайн маршруты. Не скачан кэш:
    - preconditions : |
        - На телефоне запущено приложение
        - Не скачан кеш текущей области
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
    - do : |
        - Построить на телефоне маршрут
        - Тап Поехали
        - Начать симуляцию ведения по маршруту
    - assert : |
        - Начинается ведение по маршруту
    - do : |
        - На телефоне включить авиарежим
        - (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert : |
        - Продолжается ведение по ранее построеному маршруту

    - platforms:
        - carplay
        - android_auto
    - testing:
        - acceptance_navi
        - acceptance_maps
    - tags:
        - assessors
    - integration_run:
        - mapkit


  CP/AA. Отключение с офлайн маршрутом:
    - preconditions : |
        - Не скачан кеш текущей области
        - На телефоне запущено приложение
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
    - do : |
        - Построить на телефоне маршрут
        - Тап Поехали
        - Начать симуляцию ведения по маршруту
    - assert : |
        - Строится  маршрут
        - Начинается ведение по маршруту
    - do : |
        - На телефоне включить авиарежим
        - Запустить тестируемое приложение на ГУ
    - assert : |
        - На ГУ продолжается ведение по ранее построеному маршруту
    - do : |
        - Отключить USB-кабель от ГУ
    - assert : |
        - На телефоне продолжается ведение по построенному ранее маршруту

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors
    - integration_run:
        - mapkit

  CP/AA. Подключение с офлайн маршрутом:
    - preconditions : |
        - На телефоне запущено приложение
        - Не скачан кеш текущей области
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - do : |
        - Построить на телефоне маршрут
        - Тап Поехали
        - Начать симуляцию ведения по маршруту
    - assert : |
        - Начинается ведение по маршруту
    - do : |
        - На телефоне включить авиарежим
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
        - Запустить тестируемое приложение
    - assert : |
        - На ГУ продолжается ведение по ранее построеному маршруту

    - platforms:
        - carplay
        - android_auto
    - tags:
        - assessors
    - integration_run:
        - mapkit

  CP/AA. Уход с маршрута в оффлайне:
    - preconditions : |
        - На телефоне запущено приложение
        - Не скачан кеш текущей области
    - do : |
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
    - do : |
        - Построить маршрут на телефоне имеющий альтернативы
        - Тап "Поехали"
        - Запустить симуляцию движения через дебаг-панель
        - (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert : |
        - Строится  маршрут имеющий альтернативы
        - Начинается ведение по маршруту
    - do : |
        - Не сбрасывая симуляцию ведения по маршруту выбрать из альтернатив другой маршрут
        - Тап "Поехали"
        - На телефоне включить авиарежим
    - assert : |
        - В момент расхождения симулируемого маршрута и построенного маршрута должна прозвучать аннотация о сходе с маршрута.
        - Новый маршрут не строится

    - platforms:
        - carplay
        - android_auto
    - testing:
        - acceptance_navi
        - acceptance_maps
    - tags:
        - assessors
    - integration_run:
        - mapkit


  CP/AA. Маршруты с медленным интернетом:
    - preconditions : |
        - На телефоне запущено приложение
        - Симуляция медленного интернета производится с помощью Charles режим Throttling (Throttle preset 256)
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
    - do : |
        - Построить маршрут на ГУ через поиск
        - Тап "Поехали"
    - assert : |
        - Отображается выбранный маршрут на ГУ
    - do : |
        - Запустить на телефоне через дебаг-панель ведение
        - (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert : |
        - Начинается ведение по маршруту

    - platforms:
        - carplay
        - android_auto


  CP/AA. Оффлайн маршруты. Скачан кэш:
    - preconditions : |
        - На телефоне запущено приложение
        - Устройство подключить к ГУ по Bluetooth
        - В приложении выполнить авторизацию аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
    - do : |
        - Скачать оффлайн карты текущего региона(Меню -> Загрузка карт)
        - На телефоне включить авиарежим
    - do : |
        - Устройство подключить к ГУ/Симулятору с помощью USB-кабеля
    - do : Построить маршрут в пределах скаченных карт и запустить ведение по нему
    - assert : |
        - Строится оффлайн маршрут
        - Маршрут окрашен синим цветом
        - Начинается ведение по маршруту
    - do : (CP) Тап "Продолжить в автомобиле" / (AA) Открыть приложение на ГУ
    - assert: |
        Продолжается ведение по ранее построеному маршруту
        Маршрут окрашен синим цветом
    - do : На телефоне отключить авиарежим
    - assert : Линия маршрута окрашена в цвет пробок

    - platforms:
        - carplay
        - android_auto
    - testing:
        - acceptance_navi
        - acceptance_maps
    - tags:
        - assessors
    - integration_run:
        - mapkit
