components: cpaa_push
testing:
  - regress

specs:
  CarPlay. Прокидывание интента при незапущеном приложении:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Приложение на девайсе не запущено
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт главный экран приложения
    - do: На девайс прокинуть интент yandexnavi://build_route_on_map?lat_from=58.653337&lon_from=53.009234&lat_to=58.651525&lon_to=53.054224
    - assert: |
        - На ГУ открыт главный экран приложения
        - Приложение запускается на девайсе
        - На телефоне показана фуллскрин заглушка "Вы подключены к CarPlay"
        - Маршрут не строится ни на девайсе, ни на ГУ

    - platforms:
        - carplay


  CarPlay. Прокидывание интента при свернутом приложении на девайсе:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Приложение запущено на девайсе
        - Приложение на девайсе свернуто в фон
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ )
        - На ГУ/Симуляторе открыт главный экран приложения
    - do: На девайс прокинуть интент yandexnavi://build_route_on_map?lat_from=58.653337&lon_from=53.009234&lat_to=58.651525&lon_to=53.054224
    - assert: |
        - На ГУ открыт главный экран приложения
        - Приложение на девайсе разворачивается
        - На телефоне показана фуллскрин заглушка "Вы подключены к CarPlay"
        - Маршрут не строится ни на девайсе, ни на ГУ

    - platforms:
        - carplay


  CarPlay. Открытие пуша с маршрутом на девайсе при незапущеном приложении:
    - info: |
        - В приложении выполнена авторизация аккаунтом с подпиской Яндекс.Плюс (Если аккаунта нет - читай в [ПРИВЕТСТВЕННОЙ СТРАНИЦЕ](https://wiki.yandex-team.ru/eva/testing/projects/navigator/#kakproxodittest-kejjsytrebujushhienalichiepodpiskijandeks.pljus) выше)
        - Приложение незапущено на девайсе
        - Девайс подключен к ГУ/Симулятору (Bluetooth + USB) (включить Bluetooth -> соединить телефон по bluetooth с ГУ)
        - На ГУ/Симуляторе открыт экран со списком приложений
    - do: |
        - Отправить на девайс пуш, содержащий диплинк на построение маршрута
        - Тап на пуш
    - assert: |
        - Запускается приложение на девайсе
        - На девайсе строится маршрут
        - На ГУ по прежнему открыт экран со списком приложений
    - do: |
        - Тап на Поехали
        - Перейти в приложение на ГУ
    - assert: |
        - На телефоне показана фуллскрин заглушка "Вы подключены к CarPlay"
        - На ГУ отображается запущеный на девайсе маршрут

    - platforms:
        - carplay