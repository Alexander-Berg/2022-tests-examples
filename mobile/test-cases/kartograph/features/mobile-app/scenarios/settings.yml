components: settings
testing:
  - regress

aliases:
  - &INFO_SETTINGS
    - info: |
        Выданы все разрешения
        Пользователь авторизован
        Debug-панель > Environment > MapKit enviroment > testing
        Перезапустить приложение
        Debug-панель > Environment > Simulate location > On

specs:
  Экран настроек:
    - info: |
        Выданы все разрешения
        Пользователь авторизован
    - do: Тап на "Настройки" в таббаре
    - assert: |
        - Открыт экран настроек
        - Таб "Настройки" в таббаре становится активным
        - Отображается блок "Съемка маршрутов":
          - Автоматически отправлять маршруты в Карты при подключении к Wi-fi
        - Отображается блок "Видеорегистратор":
          - Параллельно записывать видео c подстрочником о дублировании маршрутов в видео
          - Объем памяти c подстрочником о записи видео, если закончится память
          - Ниже отображается примерная длина видео в часах и минутах
          - Длительность видео c подстрочником о делении видео на отрезки
          - Ниже отображается примерный вес отрезка в МБ/ГБ
        - Отображается блок "О приложении":
          - Версия приложения напротив номер версии
          - Лицензионное соглашение
          - Политика конфиденциальности
          - Написать разработчикам
          - Debud-панель(ios)
        В самом низу присутствует кнопка "Выйти из профиля"

    - platforms:
        - ios
        - android
    - testing:
        - smoke
    - tags:
        - assessors


  Скрытие и показ настроек видеорегистратора при взаимодействии с главной настройкой:
    - info: |
        Выданы все разрешения
        Пользователь авторизован
    - do: Тап на "Настройки" в таббаре
    - assert: |
        Открыт экран настроек
    - do: Выключить настройку Параллельно записывать видео
    - assert: |
        Настройка выключилась
        Анимированно скрылись остальные настройки видеорегистратора
    - do: Включить настройку Параллельно записывать видео
    - assert: |
        Настройка включилась
        Анимированно раскрылись остальные настройки видеорегистратора

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Открытие лицензионного соглашения:
    - info: |
        Выданы все разрешения
        Пользователь авторизован
    - do: Тап на "Настройки" в таббаре
    - assert: |
        Открывается экран настроек
        В настройках присутствует пункт "Лицензионное соглашение"
    - do: Тап "Лицензионное соглашение"
    - assert: |
        Открывается вебвью с лицензионным соглашением Народной карты
    - do: Тап "Готово"
    - assert: |
        Вебвью закрылось
        Отображается экран настроек

    - platforms:
        - ios
        - android
    - testing:
        - smoke
    - tags:
        - assessors


  Открытие политики конфиденциальности:
    - info: |
        Выданы все разрешения
        Пользователь авторизован
    - do: Тап на "Настройки" в таббаре
    - assert: |
        Открывается экран настроек
        В настройках присутствует пункт "Политика конфиденциальности"
    - do: Тап "Политика конфиденциальности"
    - assert: |
        Открывается вебвью с политикой конфиденциальности
    - do: Тап "Готово"
    - assert: |
        Вебвью закрылось
        Отображается экран настроек

    - platforms:
        - ios
        - android
    - testing:
        - smoke
    - tags:
        - assessors


  Открытие формы написания обратной связи:
    - info: |
        Выданы все разрешения
        Пользователь авторизован
    - do: Тап на "Настройки" в таббаре
    - assert: |
        Открывается экран настроек
        В настройках присутствует пункт "Написать разработчикам"
    - do: Тап "Написать разработчикам"
    - assert: |
        Происходит переход в выбранный почтовый клиент на телефоне
        Открыта форма создания письма
        В письме предзаполнена почта mnmaps@support.yandex.ru

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Настройки. Длительность видео 1 минута:
    - *INFO_SETTINGS
    - do: Перейти в таб "Настройки"
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку длительности видео 1 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной более 1 мин
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: |
        В разделе "Видео" появились новые видео
        Снятое видео записано отрезками в 1 мин (последнее видео может быть короче)

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Настройки. Длительность видео 2 минуты:
    - estimatedTime: 4m
    - *INFO_SETTINGS
    - do: Перейти в таб "Настройки"
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку длительности видео 2 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной более 2 мин
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: |
        В разделе "Видео" появились новые видео
        Снятое видео записано отрезками в 2 мин (последнее видео может быть короче)

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Настройки. Длительность видео 5 минут:
    - estimatedTime: 7m
    - *INFO_SETTINGS
    - do: Перейти в таб "Настройки"
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку длительности видео 5 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной более 5 мин
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: |
        В разделе "Видео" появились новые видео
        Снятое видео записано отрезками в 5 мин (последнее видео может быть короче)

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Синхронизация настроек из разных точек входа приложения:
    - preconditions: |
        Выданы все разрешения
        Пользователь авторизован
        Открыт главный экран приложения
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки
    - do: Тап на "Настройки" в навбаре экрана съемки
    - assert: Открываются Настройки приложения
    - do: Изменить любые настройки и запомнить изменения
    - do: Вернуться на Главный экран
    - do: Перейти в таб Настройки
    - assert: Изменения в настройках сохранились

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Изменение объема памяти видеорегистратора:
    - *INFO_SETTINGS
    - do: Перейти в таб "Настройки"
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Объем памяти" 2ГБ
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной ~ 20 сек
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: В разделе "Видео" появилось новое видео
    - do: На телефоне в папку `Android/data/com.yandex.maps.mrcpublic.testing/files/movies/regular` подложить файл более 2Гб
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной ~ 20 сек
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: |
        В разделе "Видео" старое видео стерлось
        Вместо него появилось новое видео
    - do: Перейти в таб "Настройки"
    - do: Включить настройку "Объем памяти" 5ГБ
    - do: Перейти в таб "Создать"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Записать видео длиной ~ 20 сек
    - do: Тап на кнопку "Галерея" > "Видео"
    - assert: В разделе "Видео" появилось новое видео

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Смена темы на экране Настройки:
    - info: |
        На девайсе выставлена светлая тема
        Выданы все разрешения
        Пользователь авторизован
        Открыт главный экран
    - do: Тап на таб "Настройки"
    - assert: |
        Открыт экран "Настройки"
        Экран отображется в светлой теме
    - do: На девайсе сменить тему на темную
    - assert: |
        Открыт экран "Настройки"
        Экран отображется в темной теме
        Артефакты светлой темы отсутствуют

    - platforms:
        - android
        - ios
