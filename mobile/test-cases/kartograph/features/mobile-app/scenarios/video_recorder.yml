components: video_recorder
testing:
  - regress

aliases:
  - &INFO_VIDEO
    - preconditions: |
        Выданы все разрешения
        Пользователь авторизован
        Debug-панель > Environment > MapKit enviroment > testing
        Перезапустить приложение
        Debug-панель > Environment > Simulate location > On

specs:
  Локальная съемка видео:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Выйти с экрана съемки
    - do: Перейти в таб Галерея > Видео
    - assert: |
        В списке "Временные видео" появилось новое видео
        Новое видео находится наверху списка, если есть другие видео
        У видео есть превью, время съемки, длительность видео, размер и Action menu (три точки)
        Дата и время соответствуют дате и времени съемки

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - smoke


  Локальная съемка видео. Запись нескольких видео подряд:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб "Съемка"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Не уходя с экрана съемки сделать еще одно видео длиной около 20 сек (картинка на экране съемки должна меняться)
    - do: Выйти с экрана съемки
    - do: Перейти в таб Галерея > Видео
    - assert: |
        В списке "Временные видео" появилось 2 новых видео
        Превью видео отличаются
    - do: Посмотреть в плеере первое видео (плеер открывается тапом на видео)
    - do: Посмотреть в плеере второе видео
    - assert: Записаны два разных видео

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Локальная съемка видео. Съемка через Галерею:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Тап на таб Галерея
    - assert: Открыта Галерея с разделами Видео и Маршруты
    - do: Перейти в раздел Видео
    - do: Удалить все видео (если есть)
    - assert: Отображается заглушка "Пока нет снятых видео"
    - do: Тап по кнопке "Снять маршрут"
    - assert: Открывается экран съемки
    - do: Снять видео любой длины
    - do: Тап на стрелку Назад
    - assert: Отображается список "Временные видео" с одним снятым видео

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Локальная съемка видео. Съемка через Галерею и открытие списка с экрана съемки:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Тап на таб Галерея
    - assert: Открыта Галерея с разделами Видео и Маршруты
    - do: Перейти в раздел Видео
    - do: Удалить все видео (если есть)
    - assert: Отображается заглушка "Пока нет снятых видео"
    - do: Тап по кнопке "Снять маршрут"
    - assert: Открывается экран съемки
    - do: Снять видео любой длины
    - do: Тап на иконку Галереи в навбаре экрана съемки
    - assert: Отображается список "Временные видео" с одним снятым видео

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Локальная съемка видео. Открытие вертикального видео в плеере:
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Перейти в таб Галерея > Видео
    - do: Тап на новое видео в списке
    - assert: |
        Открывается видеоплеер с записанным видео
        Видео располагается вертикально
    - do: Повернуть девайс
    - assert: Видео располагается вертикально

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Локальная съемка видео. Открытие горизонтального видео в плеере (навбар слева):
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Повернуть девайс в горизонтальную ориентацию по часовой стрелке
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Перейти в таб Галерея > Видео
    - do: Тап на новое видео в списке
    - assert: |
        Открывается видеоплеер с записанным видео
        Видео располагается горизонтально
    - do: Повернуть девайс в вертикальную ориентацию
    - assert: Видео располагается горизонтально

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Локальная съемка видео. Открытие горизонтального видео в плеере (навбар справа):
    - *INFO_VIDEO
    - info: Девайс в горизонтальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Повернуть девайс в горизонтальную ориентацию против часовой стрелке
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Перейти в таб Галерея > Видео
    - do: Тап на новое видео в списке
    - assert: |
        Открывается видеоплеер с записанным видео
        Видео располагается горизонтально
    - do: Повернуть девайс в вертикальную ориетацию
    - assert: Видео располагается горизонтально

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Локальная съемка видео. Просмотр видео с экрана Съемки:
    - *INFO_VIDEO
    - info: Девайс в горизонтальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Тап на кнопку Галерея в нижнем навбаре экрана съемки
    - assert: Открывается Галерея
    - do: Перейти в раздел Видео
    - assert: |
        - В списке "Временные видео" появилось новое видео
        - Новое видео находится наверху списка, если есть другие видео
        - У видео есть превью, время съемки, длительность видео, размер и Action menu (три точки)
        - Дата и время соответствуют дате и времени съемки

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Контроллы плеера в горизонтальной ориентации:
    - *INFO_VIDEO
    - info: Девайс в горизонтальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Длительность видео" 2 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной более 1 мин
    - do: Перейти в таб Галерея > Видео
    - do: Тап на новое видео в списке
    - assert: Открывается видеоплеер с записанным видео
    - do: Тап на Play
    - assert: Начинается проигрывание видео
    - do: Тап на Pause
    - assert: Проигрываемое видео ставится на паузу
    - do: Переместить ползунок по прогресс-бару
    - assert: Видео проматывается в соответствие с положением ползунка
    - do: Проверить остальные имеющиеся контролы плеера (кроме звука)
    - assert: Видео корректно управляется контроллами плеера

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Контроллы плеера в вертикальной ориентации:
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Длительность видео" 2 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной более 1 мин
    - do: Перейти в таб Галерея > Видео
    - do: Тап на новое видео в списке
    - assert: Открывается видеоплеер с записанным видео
    - do: Тап на Play
    - assert: Начинается проигрывание видео
    - do: Тап на Pause
    - assert: Проигрываемое видео ставится на паузу
    - do: Переместить ползунок по прогресс-бару
    - assert: Видео проматывается в соответствие с положением ползунка
    - do: Проверить остальные имеющиеся контролы плеера (кроме звука)
    - assert: Видео корректно управляется контролами плеера

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Временные видео. UI:
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Длительность видео" 1 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной более 1 мин
    - do: Перейти в таб Галерея > Видео
    - assert: |
        Открывается список "Временные видео"
        у каждого видео есть превью и Action Menu (три точки)
        Нет двух одинаковых видео
        Если список достаточно большой, он скролится
        В левом верхнем углу есть стрелка Назад
    - do: Повернуть девайс
    - assert: |
        Остается открытым список "Временные видео"
        Если список достаточно большой, он скролится
        В левом верхнем углу есть стрелка Назад
    - do: Поменять тему в настройках девайса
    - assert: Тема списка "Временные видео" сменилась

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Временные видео. Сортировка:
    - estimatedTime: 5m 30s
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Длительность видео" 1 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной более 2 мин
    - do: Перейти в таб Галерея > Видео
    - assert: |
        Открывается список "Временные видео"
        Видео отсортированы по времени (более поздние видео находятся выше)

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Временные видео. Возвращение в Галерею по Back:
    - do: Перейти в таб Галерея > Видео
    - assert: Открывается список "Временные видео" (если видео нет, то отображается заглушка "Пока нет снятых видео")
    - do: Тап по хардовой кнопки Back
    - assert: Происходит возврат в Галерею

    - platforms:
        - android
    - tags:
        - assessors


  Временные видео. Action menu:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Выйти с экрана съемки
    - do: Перейти в таб Галерея > Видео
    - assert: |
        В списке "Временные видео" появилось новое видео
        У видео есть Action Menu (три точки)
    - do: Тап на Action Menu
    - assert: Открывается информационная панель с кнопками "Поделиться", "Удалить" и "Отмена"
    - do: Повернуть устройство
    - assert: Информационная панель не скрывается
    - do: Тап по экрану все информационной панели
    - assert: Панель скрылась

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Временные видео. Action menu - отмена:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной около 20 сек
    - do: Выйти с экрана съемки
    - do: Перейти в таб Галерея > Видео
    - assert: |
        В списке "Временные видео" появилось новое видео
        У видео есть Action Menu (три точки)
    - do: Тап на Action Menu
    - assert: Открывается информационная панель с кнопками "Поделиться", "Удалить" и "Отмена"
    - do: Тап на "Отмена"
    - assert: Информационная панель скрывается

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Временные видео. Удаление видео:
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Включить настройку "Длительность видео" 1 мин
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео длиной более 1 мин
    - do: Перейти в таб Галерея > Видео
    - assert: |
        Открывается список "Временные видео"
        В списке 2 и более видео
    - do: Тап на Action Menu (три точки) любого видео
    - do: Тап на "Удалить"
    - assert: |
        Видео удалилось из списка
        Список перестроился
        Сортировка сохранилась (более поздние видео находятся выше)

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - not_suitable_for_farm


  Временные видео. Удаление последнего видео:
    - *INFO_VIDEO
    - info: Девайс в вертикальной ориентации
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - assert: Тоглы настроек в правильном положение
    - do: Перейти в таб Съемка
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Сделать видео около 20 сек
    - do: Перейти в таб Галерея > Видео
    - assert: Открывается список "Временные видео"
    - do: Удалить все видео из списка (три точки > удалить)
    - assert: Отображается заглушка "Пока нет снятых видео"

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Локальная съемка видео. Перезапись видео:
    - *INFO_VIDEO
    - do: Перейти в таб Настройки
    - do: Включить настройку "Параллельно записывать видео"
    - do: Перейти в Various в Debug-панели (ios Настройки - Debug-панель - Various,  android Свайп влево с любого экрана - Various)
    - do: Включить настройку "Video length" - REDUCED
    - do: Перейти в таб "Съемка"
    - do: Тап на "Съемка маршрута"
    - assert: Открывается экран съемки маршрута
    - do: Начать съёмку
    - do: Не прекращая съемку перейти в таб "Галерея"
    - do: Дождаться пока размер папки "Видео" не будет равен 40 мегабайт (может быть чуть больше)
    - assert: |
        Размер папки около 40 мегабайт
        Съёмка не прекращается

    - platforms:
        - ios
        - android
    - tags:
        - assessors


