components: gps
testing:
  - regress

aliases:
  - &INFO_GPS
    - info: |
        Выданы все разрешения
        Пользователь авторизован
        В настройках (шторке) устройства включено GPS
        В фоне не запущены приложения, которые используют GPS
        Debug-панель > Environment > MapKit enviroment > testing
        Перезапустить приложение
        Debug-панель > Environment > Simulate location > Off

specs:
  Использование геопозиции (android):
    - *INFO_GPS
    - do: Запустить приложение
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Начать съемку
    - assert: Присутствует значок геопозиции в статус баре устройства (геопозиция используется)
    - do: Завершить съемку
    - assert: Через несколько секунд значок геопозиции исчезнет

    - platforms:
        - android
    - tags:
        - assessors


  Использование геопозиции при свернутом приложении (android):
    - *INFO_GPS
    - do: Запустить приложение
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Свернуть приложение
    - assert: Отсутствует значок геопозиции в статус баре устройства
    - do: Свайпом раскрыть панель уведомлений
    - assert: Присутствует уведомление от Картографа для управления съемкой
    - do: Начать съемку через уведомление
    - assert: Присутствует значок геопозиции в статус баре устройства
    - do: Закончить съемку через уведомление
    - assert: Отсутствует значок геопозиции в статус баре устройства

    - platforms:
        - android
    - tags:
        - assessors


  Использование геопозиции при выгруженном приложении (android):
    - *INFO_GPS
    - do: Запустить приложение
    - do: Тап на Съемка маршрута
    - assert: Открывается экран съемки маршрута
    - do: Начать и завершить съемку
    - do: Выгрузить приложение из памяти
    - assert: Отсутствует значок геопозиции в статус баре устройства
    - do: Свайпом раскрыть панель уведомлений
    - assert: Присутствует уведомление от Картографа для управления съемкой
    - do: Начать съемку через уведомление
    - assert: Присутствует значок геопозиции в статус баре устройства
    - do: Закончить съемку через уведомление
    - assert: Отсутствует значок геопозиции в статус баре устройства

    - platforms:
        - android
    - tags:
        - assessors


  Отсутствие определения геопозиции при сворачивании в фон (ios):
    - *INFO_GPS
    - do: Запустить приложение
    - assert: Присутствует значок геопозиции в статус баре устройства (геопозиция используется)
    - do: Свернуть приложение в фон
    - do: Подождать около 30 сек
    - assert: Через несколько секунд значок геопозиции исчезнет

    - platforms:
        - ios
    - tags:
        - assessors


  Отсутствие определения геопозиции после выгрузки приложения (ios):
    - *INFO_GPS
    - do: Запустить приложение
    - assert: Присутствует значок геопозиции в статус баре устройства (геопозиция используется)
    - do: Выгрузить приложение из памяти устройства
    - do: Подождать около 30 сек
    - assert: Значок геопозиции скрывается

    - platforms:
        - ios
    - tags:
        - assessors


  Определение геопозиции при однократном доступе:
    - info: |
        В настройках (шторке) устройства включено GPS
        В фоне не запущены приложения, которые используют GPS
    - do: Переустановить приложение
    - do: Пройти онбординг
    - do: Авторизоваться в приложении
    - assert: Открывается главный экран приложения
    - do: Тап на "Съемка маршрута"
    - do: Выдать разрешение на доступ к камере
    - assert: Появляется системный поп-ап на доступ к геопозиции
    - do: Тап "Однократно"
    - assert: |
        Поп-ап скрылся
        Отображается онбординг экрана съемки
        Присутствует значок геопозиции в статус баре устройства (геопозиция используется)
    - do: Выгрузить приложение из памяти
    - do: Дождаться, когда значок геопозиции исчезнет
    - do: Запустить приложение
    - assert: Отсутствует значок геопозиции в статус баре устройства

    - platforms:
        - ios
    - tags:
        - assessors