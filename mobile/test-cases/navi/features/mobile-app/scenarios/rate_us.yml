components: rate_us
testing:
  - regress

specs:
  Варианты активации - Через завершенные 3 поездки:
    - description: |
        Цель: проверить, что рейтинговалка появляется спустя 3 завершенные поездки в течение 7 дней.
    - info: |
        Приложение впервые установлено
        Для ведения по маршруту использовать debug сборку.
    - do: |
        Построить маршрут любым способом
        Начать ведение по маршруту 
    - assert: Начинается ведение по маршруту
    - do: |
        Достигнуть точки финиша, услышав фразу “Вы приехали!”
        Повторить шаг 1 еще два раза
    - assert: |
        Отображается плашка - “Понравилось наше приложение?”, кнопками ДА/НЕТ 

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Закрытие плашки "Понравилось наше приложение?":
    - info: Приложение впервые установлено
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка - "Понравилось наше приложение?", кнопками ДА/НЕТ 
    - do: Тап за пределами плашки
    - assert: Плашка закрывается, приложение не крешится
    - do: Инициировать отображение рейтинговалки еще раз
    - assert: Рейтинговалка не отображается. Пока приложение не будет обновлено и не выполнится один из трех вариантов активации рейтинговалки
    - do: |
        Обновить приложение.
        Инициировать отображение рейтинговалки
    - assert: Отображается плашка - “Понравилось наше приложение?”, кнопками ДА/НЕТ 

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Одобрение в плашке "Понравилось наше приложение?":
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка - "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Да" 
    - assert: Отображается новая плашка "Хотите оценить нас в App Store" (для IOS) и "Хотите оценить нас в  Google Play" (для Android)

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Согласие на оценку приложения:
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        -совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        -полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка - "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Да"
    - assert: |
        Событие логируется
        Отображается новая плашка "“Хотите оценить нас в AppStore/GPlay?”"
    - do: Тап по "Да"
    - assert: Происходит переход в  AppStore/GPlay

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Отказ на предложение оценить приложение:
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка - "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Да"
    - assert: |
        Событие логируется
        Отображается новая плашка ““Хотите оценить нас в AppStore/GPlay?””
    - do: Тап по “Нет”
    - assert: |
        Диалог закрывается
        Отображается тост на подобие "Вы нам тоже очень нравитесь!" (пока не видела реализации и реального текста), но в Вики указано,что такой текст обязательно должен отобразиться
        Приложение продолжает работать, не крешится.

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Варианты активации - Через завершенные 3 поездки после обновления.:
    - info: Установлена предыдущая запинованная сборка
    - do: Обновить приложение до текущей сборки
    - assert: Приложение обновлено, запускается.
    - do: |
        Совершить 3 поездки закончившиеся фразой "Вы приехали!" (у пользователей рейтинговалка появится, если три поездки совершены подряд в течении 7 дней)
        Для тестирования можно проехать три маршрута подряд.
    - assert: Отображается плашка - "Вам нравится Яндекс.Навигатор?", кнопками ДА/НЕТ 

    - platforms:
      - android
      - ios
    - tags:
        - assessors
    - testing:
      - acceptance_navi


  Варианты активации - Через ДС:
    - info: Приложение впервые установлено
    - do: Полайкать/дислайкать  5 ДС в течении 7 дней
    - assert: Отображается плашка - “Понравилось наше приложение?”, кнопками ДА/НЕТ и крестиком “Закрыть”

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  После обновления варианты активации - Через ДС:
    - info: Установлена предыдущая запинованная сборка
    - do: |
        Обновить приложение.
        Полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка - “Понравилось наше приложение?”, кнопками ДА/НЕТ и крестиком “Закрыть”

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Неодобрение в плашке "Понравилось наше приложение?":
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка -  "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Нет" 
    - assert: Отображается новая плашка "Хотите рассказать нам, что не понравилось?" 

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Неодобрение в плашке "Понравилось наше приложение?" Отказ пользователя дать доп. инфу:
    - description: При отказе пользователя - В течение ЧЕТЫРЁХ месяцев больше НИЧЕГО не спрашиваем. Далее, только после срабатывания одной из логик активации.
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка -  "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Нет" 
    - assert: |
        Событие логируется
        Отображается новая плашка "Хотите рассказать нам, что не понравилось?" 
    - do: Тап по "Нет"
    - assert: |
        Плашка закрывается
        Приложение работает

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Неодобрение в плашке "Понравилось наше приложение?" согласиться дать доп. инфу:
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка -  "Понравилось наше приложение?", кнопками ДА/НЕТ 
    - do: Тап по кнопке "Нет" 
    - assert: |
        Событие логируется
        Отображается новая плашка "Хотите рассказать нам, что не понравилось?" 
    - do: Тап по "Да"
    - assert: |
        Отображаются  :
        - пресеты (Реклама, голосовые подсказки, Пробки, Карта, Маршруты, Поиск адресов, Скорость работы, Иннтерфейс) 
        -строчка "Рассказать обо всем в письме"
        - кнопка "Отправить"
    - do: Тап по пресетам
    - assert: Визуально понятно, какие пресеты были тапнуты
    - do: Тап по "Отправить"
    - assert: |
        Плашка закрывается
        Событие логируется
        Приложение продолжает работать
        Каким-то образом отображается благодарность пользователю.
        В следующий раз отображается только после обновления + выполнения одной из логик активации

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Неодобрение в плашке "Понравилось наше приложение?" + доп.инфа от пользователя:
    - do: |
        Инициировать отображение рейтинговалки любым способом:
        - совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        - полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Отображается плашка -  "Понравилось наше приложение?", кнопками ДА/НЕТ и крестиком "Закрыть"
    - do: Тап по кнопке "Нет" 
    - assert: |
        Событие логируется
        Отображается новая плашка "Хотите рассказать нам, что не понравилось?" 
    - do: Тап по "Да"
    - assert: |
        Отображаются  :
        - пресеты (плохие маршруты, плохие данные карты, врут пробки, непонятный интерфейс, сбои/зависания/тормоза, плохие аннотации, плохой поиск, много рекламы, другое) 
        -строчка "Хочу все рассказать подробно!/Ща все вам расскажу как надо делать!"
        - кнопка "Отправить"
    - do: Тап по  “Хочу все рассказать подробно!/Ща все вам расскажу как надо делать!”
    - assert: Открывается стандартная форма написания письма
    - do: Что-нибудь написать и тап "Отправить"
    - assert: |
        Плашка закрывается
        Событие логируется
        Приложение продолжает работать
        Сообщение отправляется в саппорт
        Каким-то образом отображается благодарность пользователю.
        В следующий раз отображается только после обновления + выполнения одной из логик активации

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Шапка письма - Что не так с приложением:
    - description: |
        Название письма корректное
        Email корректный
        В письме содержится информация о девайсе
    - do: |
        Вызвать рейтинговалку любым способом
        -совершить 3 поездки закончившиеся фразой “Вы приехали!” за 7 дней
        -полайкать/дислайкать 5 ДС в течении 7 дней
    - assert: Появляется Рейтинговалка с текстом "Вам нравится Яндекс.Навигатор?"
    - do: |
        - Тап на "Нет"
        - Тап на "Да"
    - assert: |
        - Открывается поп-ап "Где у приложения слабые места?"
        - Кнопки внизу рейтинговалки неактивны
    - do: Выбрать тапом любой из предложенных вариантов проблем
    - assert: Кнопки внизу рейтинговалки становятся активны
    - do: Тап на "Рассказать обо всём в письме"
    - assert: |
        Происходит переход в приложение "Почта", в котором создается черновик нового письма, который содержит:
        - Тему "Где у приложения слабые места?"
        - Почтовый ящик Поддержки Навигатора (app-navigator@support.yandex.ru)
        - Текст письма содержит дубаг-инфо из приложения

    - platforms:
      - ios
      - android
    - tags:
        - assessors