components: eda
testing:
  - regress

specs:
  Переход к оформлению заказа самовывозом через СТА кнопку Заказать с собой в негеопродуктовой организации:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: |
        Открыть полную карточку негеопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отображается СТА-кнопка "Заказать с собой"
    - do: Тап на кнопку "Заказать с собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors
  

  Переход к оформлению заказа самовывозом через action бар в негеопродуктовой организации:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: |
        Открыть полную карточку негеопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отображается СТА-кнопка "Заказать с собой"
    - do: Свернуть карточку организации до состояния мини-карточки
    - assert: |
        Открыта мини-карточка организации
        В action-баре отображается СТА-кнопка "Заказать с собой"
    - do: Тап на кнопку "Заказать с собой"
    - assert: |
        Открывается полная карточка организации
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors  


  Переход к оформлению заказа самовывозом через таб С собой в негеопродуктовой организации:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: |
        Открыть полную карточку негеопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отображается СТА-кнопка "Заказать с собой"
    - do: Тап на таб "С собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Переход к оформлению заказа самовывозом через СТА кнопку Заказать с собой в геопродуктовой организации без СТА кнопки:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: |
        Открыть полную карточку геопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отсутсвует СТА-кнопка геопродукта (пример Il Letterato Петроверигский пер., 4, стр. 4 https://yandex.ru/maps/org/il_letterato/77138636089)
        Над табами отображается СТА-кнопка "Заказать с собой"
    - do: Тап на кнопку "Заказать с собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Переход к оформлению заказа самовывозом через action бар в геопродуктовой организации без СТА кнопки:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: | 
        Открыть полную карточку геопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отсутсвует СТА-кнопка геопродукта (пример Il Letterato Петроверигский пер., 4, стр. 4 https://yandex.ru/maps/org/il_letterato/77138636089)
        Над табами отображается СТА-кнопка "Заказать с собой"
    - do: Свернуть карточку организации до состояния мини-карточки
    - assert: |
        Открыта мини-карточка организации
        В action-баре отсутсвует СТА-кнопка геопродукта
        В action-баре отображается СТА-кнопка "Заказать с собой"
    - do: Тап на кнопку "Заказать с собой"
    - assert: |
        Открывается полная карточка организации
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Переход к оформлению заказа самовывозом через таб С собой в геопродуктовой организации с СТА кнопкой:
    - info: Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: |
        Открыть полную карточку геопродуктовой организации
        В организации поддерживается самововывоз Еды - отображается таб "С собой" (самовывоз поддерживается не во всех организациях)
        В карточке организации отсутсвует СТА-кнопка "Заказать с собой"
        Над табами отображается СТА-кнопка геопродукта
    - do: Свернуть карточку организации до состояния мини-карточки
    - assert: |
        Открыта мини-карточка организации
        В action-баре отображается СТА-кнопка геопродукта
        В action-баре отсутствует кнопка "Заказать с собой"
    - do: Развернуть карточку организации до полной
    - do: Тап на таб "С собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Авторизация в приложении через вебвью самовывоза еды:
    - info: |
        Открыт главнй экран приложения
        Пользователь не авторизован в приложении
    - do: Developer settings -> Search -> Show Eda takeaway - ON 
    - do: Перезапустить приложение 
    - do: Открыть полную карточку организации с поддержкой заказа еды на вынос
    - do: Тап на таб "С собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды
    - do: Добавить товар в корзину
    - assert: Появилась кнопка оформления заказа
    - do: Тап на кнопку оформления заказа
    - assert: Открылся экран Заказа с добавленными товарами и СТА кнопкой "Далее"
    - do: Тап на кнопку "Далее"
    - assert: Отображается карусель АМ
    - do: Авторизоваться аккаунтом без добавленных товаров
    - assert: |
        Пользователь авторизован
        Открылся экран оформления заказа на добавленный ранее товар

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Логирование таба С собой:
    - info: |
        Для просмотра логов подключить девайс к mac, либо воспользоваться Device log внутри приложения
        Открыт главный экран приложения
    - do: Developer settings -> Search -> Show Eda takeaway - ON
    - do: Перезапустить приложение
    - do: Открыть полную карточку кафе/ресторана с возможностью самовывоза
    - assert: |
        Открыта полная карточка организации
        Присутствует таб "С собой"
    - do: Тап на таб "С собой"
    - assert: |
        Открыто WebView для соответствующей организации
        Логируется событие place.open-tab
        В событии place.open-tab присутствует поле tab_title со значением eda_takeaway

    - testing:
        - acceptance_navi
    - platforms:
        - ios
        - android
    - tags:
        - metric


  Отображение совершенного заказа Еды в других приложениях Яндекса:
    - info: |
        На девайсе установлены мобильные яндекс карты
        Пользователем был совершен заказ в навигаторе
    - do: Авторизоваться в приложении мобильные яндекс карты аккаунтом с совершенным заказом
    - do: Открыть главный экран приложения
    - do: Открыть меню
    - assert: в меню есть блок "История поездок и заказов"
    - do: Тап на блок "История поездок и заказов"
    - assert: Отображается совершенный пользователем заказ в навигаторе    
    - do: Закрыть приложение мобильные яндекс карты
    - assert: Перейти по ссылке в браузер на страницу Яндекс Еды
            - [collapsed-image](https://jing.yandex-team.ru/files/nikita-asuad/IMAGE%202022-04-22%2013%3A56%3A07.jpg){title=QR-код}

            `https://eda.yandex.ru/`
    - assert: В браузере открыта страница Яндекс Еды
    - do: Авторизоваться на сайте Яндекс Еды под аккаунтом, на котором был сделан заказ в навигаторе (если не авторизован)
    - do: Открыть меню
    - do: Тап на блок "Заказы"
    - assert: В заказах отображается заказ, сделанный в навигаторе

    - testing:
        - acceptance_navi
    - platforms:
        - ios
        - android


  Навигация в табе С собой:
    - info: |
        Открыт главный экран приложения
        Пользователь не авторизован в приложении
    - do: Developer settings -> Search -> Show Eda takeaway - ON 
    - do: Перезапустить приложение 
    - do: Открыть полную карточку организации с поддержкой заказа еды на вынос
    - do: Тап на таб "С собой"
    - assert: |
        Открывается таб "С собой"
        Отображается вебвью оформления заказа самовывоза Еды
    - do: Добавить товар в корзину
    - assert: |
        В блоке товара отображается число добавленного товара   
        Появилась СТА кнопка оформления заказа с текстом "Заказать"
    - do: Тап на кнопку оформления заказа
    - assert: Открылcя экран заказа
    - do: Тап на стрелку "Назад"
    - assert: |
        Отображается вебвью оформления заказа самовывоза Еды
        Отображаются добавленные товары
        Отображается СТА кнопка оформления заказа с текстом "Заказать"

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors                