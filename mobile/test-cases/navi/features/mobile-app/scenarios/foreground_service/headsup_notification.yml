components: headsup_notification
testing:
  - regress

specs:

  Нотификации. Отображение поверх других приложений:
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: |
        - Меню - Настройки - Навигация - Работа в фоне - С маршрутом - Вкл
        - Меню - Настройки - Навигация - Работа в фоне - Без маршрута - Вкл
    - do: |
        - Построить маршрут c несколькими ДС и различными маневрами
        - Запустить симуляцию ведения
        - Свернуть приложение
        - Открыть любое другое приложение
    - assert: |
        - Поверх приложений появляются нотификации с данными о ближайшем маневре и названием улицы, по которой производится движение
        - Расстояние до маневра обновляется

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
    - testing:
        - acceptance_navi


  Нотификации. Отображение маневров:
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: |
        - Меню - Настройки - Навигация - Работа в фоне - С маршрутом - Вкл
        - Меню - Настройки - Навигация - Работа в фоне - Без маршрута - Вкл
    - do: |
        - Построить маршрут с различными маневрами
        - Запустить симуляцию ведения
        - Свернуть приложение
    - assert: |
        Появилось Heads-up notifications с оповещением о предстоящем маневре
        В Heads-up notifications присутствует:
          - Изображение ближайшего маневра
          - Расстояние до ближайшего маневра
          - Название улицы, на которой будет произведен маневр
        Присутствуют голосовые аннотации по маршруту
        Heads-up notifications отображаются несколько секунд, потом скрываются

    - platforms:
      - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Нотификации. Отображение ДС типа камера:
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: |
        - Меню - Настройки - Навигация - Работа в фоне - С маршрутом - Вкл
        - Меню - Настройки - Навигация - Работа в фоне - Без маршрута - Вкл
    - do: Построить маршрут c несколькими ДС типа "Камера" и подтвердить его
    - do: |
        - Запустить симуляцию ведения через дебаг-панель
        - Установить скорость движения 100 км/ч
        - Свернуть приложение
        - Дождаться отображение нотификации
    - assert: |
        В Heads-up notifications присутствует оповещение о приближении к камере контроля скорости
        Присутствуют изображение в виде камеры и расстояние до нее
        Звучит голосовое предупреждение о приближении к камере контроля скорости и номинале разрешенной скорости
    - do: Продолжать двигаться по маршруту
    - assert: Нотификации показываются в соответствии с текущими событиями на дороге

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Нотификация плашки камеры на скорость фонового ведения. Exp On:
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: | 
       - Dev > Misc > Use timeout for camera in notification - ON
       - Перезапустить навигатор
       - Построить маршрут с большим количеством ДС "Камера на скорость"(Например Варшавское шоссе г.Москва) 
       - Запустить симуляцию ведения по маршруту с максимальной скоростью движения
    - do: Свернуть навигатор по кнопке “Домой”
    - assert: |
       - В фоне звучит аннотация о приближающейся камере
       - Отображается нотификация камеры на скорость

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Нотификации. Тап по уведомлению:
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: |
        - Меню - Настройки - Навигация - Работа в фоне - С маршрутом - Вкл
        - Меню - Настройки - Навигация - Работа в фоне - Без маршрута - Вкл
    - do: |
        - Построить маршрут c несколькими ДС и различными маневрами
        - Запустить симуляцию ведения
        - Свернуть приложение
    - assert: Появляется нотификация с ближайшим маневром и ДС
    - do: Тап по появившейся нотификации
    - assert: Открывается приложение

    - platforms:
      - android
    - tags:
        - assessors
        - not_suitable_for_farm
    - testing:
      - acceptance_navi


  Нотификации Samsung. Проверка отображения кнопок:
    - info: Кейс проходить на устройстве Samsung
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - info: Кейс проходить на устройстве Samsung
    - do: |
        - Построить маршрут с ДС типа "Камера на скорость" и различными маневрами
        - Запустить симуляцию ведения
        - Cвернуть приложение
    - assert: |
        - Появляется heads-up нотификация с ближайшим маневром и ДС 
        - Присутствуют кнопки "Завершить маршрут" и "Уведомления"
    - do: Свайп вниз шторку
    - assert: Видим нотификацию без кнопок
    - do: Развернуть нотификацию свайпом вниз
    - assert: |
        - В нотификации появляются кнопки "Завершить маршрут" и "Уведомления"
        - Маневры отображаются и озвучиваются

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - samsung
    - testing:
        - acceptance_navi


  Нотификации Samsung. Свайп вниз:
    - info: Кейс проходить на устройстве Samsung
    - do: |
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Подсказки в фоновом режиме -> on
        - Системные настройки телефона -> Приложения -> Навигатор -> Уведомления -> Уведомления на экране блокировки -> On
    - do: |
        - Построить маршрут с ДС типа "Камера на скорость" и различными маневрами
        - Запустить симуляцию ведения
        - Cвернуть приложение
    - assert: |
        - Появляется heads-up нотификация с ближайшим маневром и ДС 
        - Присутствуют кнопки "Сбросить маршрут" и "Без уведомлений"
    - do: Свайп вниз по heads up нотификации
    - assert: Открывается нотификация в шторке уведомлений с кнопками "Сбросить маршрут" и "Без уведомлений"

    - platforms:
        - android
    - tags:
        - assessors
        - not_suitable_for_farm
        - samsung
    - testing:
        - acceptance_navi