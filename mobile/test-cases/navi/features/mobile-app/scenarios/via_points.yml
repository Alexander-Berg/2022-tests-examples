components: via_points
testing:
  - regress

specs:
  Маршрут к подъезду. Промежуточная точка.:
    - description: |
        https://st.yandex-team.ru/MOBNAVI-5423
        - Если для строения есть данные о расположении входа, то маршрут строится максимально близко ко входу. Информацию о входах (подъездах) можно посмотреть в БЯК. Например, улица Барклая, 7к1.
        - Если информации о входе (подъезде) нет, то строим маршрут где-то к середине здания.
        Эта логика применима для всех случаев (финишная точка/ промежуточная точка), кроме случаев когда точка выбрана лонгтапом или через пункт "Что здесь?".
    - do: Построить произвольный маршурт. Добавить промежуточной точкой здание, где есть информация о входах.
    - assert: Маршрут строится максимально близко к подъезду здания из промежуточной точки.

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - integration_run:
        - mapkit


  Добавление промежуточной точки через лонгтап:
    - description: Цель - Проверяется возможность добавления промежуточной точки на маршрут через лонгтап по карте
    - info: |
        - Запущен projected режим (**Для MySPIN, для остальных вариантов пропускается этот шаг**)
        - Построен маршрут
        - Открыт обзор маршрута
    - do: Выполнить лонгтап в любую точку на карте и тап по кнопке "через".
    - assert: На маршрут добавляется точка.

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
        - myspin
    - platforms:
        - renault
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors
        - both_myspin


  Добавление промежуточной точки через кнопку "черный плюс":
    - description: Цель - Проверяется возможность добавления промежуточной точки на маршрут через "черный плюс"
    - info: |
        - Запущен projected режим (**Для MySPIN, для остальных вариантов пропускается этот шаг**)
        - Построен маршрут
        - Открыт обзор маршрута
    - do: |
        Выполнить лонгтап по черному плюсу на середине линии маршрута.
        Не отпуская палец, перетащить черный плюс в другое место.
    - assert: На маршрут добавляется новая промежуточная точка.

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
    - platforms:
        - renault
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors


  Добавление промежуточной точки из "Мои места":
    - description: Цель - Проверяется возможность добавления промежуточной точки на маршрут из "Мои места"
    - info: |
        У пользователя добавлены точки в Мои места.
        Добавить точки можно следующим образом:
        - Выполнить лонгтап в любом месте на карте.
        - Тап на “В Мои места”
        - Тап на “Избранное”
        - Ввести название точки.
        - Построить любой маршрут, не подтверждать его
    - do: |
        Тап на черный плюс на маршруте
        Тап на "Взять из Моих мест"
        Тап на Дом/Работа
        Тап на черный плюс на маршруте
        Тап на "Взять из Моих мест"
        Тап на точку в избранном.
    - assert: Все точки добавлены, как промежуточные, на маршрут.

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
    - platforms:
        - ios
        - android
        - carsharing_t3
        - t3am
        - motrex
        - autochip
        - renault
        - nissan
    - tags:
        - assessors


  Удаление промежуточной точки:
    - description: Цель - Проверяется взаимодействие с промежуточными точками на маршруте (удаление)
    - info: |
        - Запущен projected режим (**Для MySPIN, для остальных вариантов пропускается этот шаг**)
        - Построен маршрут
        - Открыт обзор маршрута
    - do: |
        - Тап по промежуточной точке на маршруте.
        - Тап по кнопке “Удалить”
    - assert: |
        - Промежуточная точка удалена
        - Маршрут перестроен без учета этой точки

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
        - myspin
    - platforms:
        - renault
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors
        - both_myspin


  Аннотация "Вы приехали в промежуточную точку.":
    - description: |
        Цель - Проверка аннотаций "Вы приехали в промежуточную точку"
        В навигаторе имеется возможность добавлять на маршрут промежуточные точки.
        **При добавлении промежуточной точки через лонгтап меню - аннотация произноситься не будет.
        Чтобы услышать аннотацию следует добавлять точку через карточку организации!**
    - info: |
        - Запущен projected режим (**Для MySPIN, для остальных вариантов пропускается этот шаг**)
        - Построен маршрут с промежуточной точкой (через поиск/избранное, не используя лонгтап меню)
        - Включена симуляция маршрута через debug панель
    - do: Дождаться проезда одной из промежуточных точек
    - assert: Звучит аннотация "Вы приехали в промежуточную точку."

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
        - myspin
    - platforms:
        - renault
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors
        - both_myspin


  Добавление промежуточной точки через "Что здесь?":
    - description: Цель - Проверяется возможность добавления промежуточной точки на маршрут через "Что здесь?"
    - info: |
        - Запущен projected режим
        - Построен маршрут
        - Открыт обзор маршрута
    - do: |
        Выполнить лонгтап по карте.
        Тап на “Что здесь”
        В открывшейся карточке тап на “Заехать”
    - assert: На маршрут добавлена промежуточная точка.

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
    - platforms:
        - renault
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors


  Перетаскивание промежуточной точки:
    - description: Цель - Проверяется взаимодействие с промежуточными точками на маршруте (перетаскивание)
    - info: |
        - Запущен projected режим
        - Построен маршрут с промежуточными точками
        - Открыт обзор маршрута
    - do: Выполнить лонгтап по одной из добавленных на маршрут промежуточных точек и перетащить точку в другое место.
    - assert: Маршрут перестроен сообразно внесенным изменениям.

    - testing:
        - acceptance_navi
    - integration_run:
        - myspin
    - platforms:
        - renault
        - nissan
    - tags:
        - assessors
        - both_myspin


  Промежуточной точки через поиск по категориям и кнопку "Заехать":
    - info: |
        - Построен маршрут
        - Открыт обзор маршрута
    - do: |
        Выполнить одиночный тап по черному плюсу на маршруте.
        Тап на "Уточнить".
    - assert: |
        - Открывается поисковая штора (На больших ios экранах, по типу ipad расположение окна слева)
        - В поисковую строку введен адрес, соответствующий примерному местоположению черного плюса.
    - do: |
        Очистить поисковую строку
        **[Android]** Тап на вкладку "Категории"
        **[iOS]** Пролистать категории влево -> Тап "Еще"
        Тап на любую категорию.
    - assert: |
        - Происходит переход на экран карты.
        - На карте отображаются пины результатов поиска.
        - в нижней половине экрана отображается список организаций поисковой выдачи
    - do: Тап на  пин организации
    - assert: Открывается карточка организации.
    - do: Тап на “заехать” в открывшейся карточке.
    - assert: На маршрут добавляется новая промежуточная точка.

    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
    - platforms:
        - nissan
        - carsharing_t3
        - t3am
        - ios
        - android
        - motrex
        - autochip
    - tags:
        - assessors