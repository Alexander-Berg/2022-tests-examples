components: gps
tags:
  - not_suitable_for_farm
testing:
  - regress

specs:
  Проверка определения местоположения:
    - do: Запустить навигатор и перейти на экран "Карта"
    - assert: Местоположение курсора на карте соответствует местоположению девайса
    - do: Тап на кнопку "Местоположение" с иконкой "Стрелка" на экране "Карта"
    - assert: Экран центруется на курсоре 
    - do: Подождать 5 минут
    - assert: Устройство не засыпает, местоположение не теряется, курсор не перекидывается в другие места карты.
    - do: |
        * Построить маршрут по времени больше 3 минут
        * Запустить ведение
        * Доехать до финишной точки наблюдая за поведением курсора.
    - assert: Курсор движется по маршруту, местоположение не теряется
    - do: |
        Отключить сеть.
        Открыть Навигатор
    - assert: Курсор должен отображаться некоторое время соответствуя местоположению устройства.
    - do: |
        Проверить разные состояния курсора:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/Снимок%20экрана%202021-12-20%20в%2019.26.19.png){title=QR-код}
        Поиск спутников появляется при отсутствии данных больше трех минут с построенным маршрутом.
        Для проверок можно включить авиарежим в момент когда хорошая точность и проверить, что через ~3-5 секунд появится синий круг погрешности вокруг стрелки и т.д.

    - tags:
      - mapkit_ready
    - platforms:
      - motrex
      - geely
      - vaz
      - carsharing_t3
      - nissan
      - t3am
      - autochip
      - first_run_hu
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при помощи всех источников:
    - info: |
        - В настройках определения местоположения включена настройка “По всем источникам”
        - Переключение разных источников на девайсе:
        Настройки -> Местоположение -> Режим
    - do: Запустить Навигатор
    - assert:  Отображается курсор в текущем местоположении
    - do: |
        - Поскроллить карту
        - Тап на кнопку "Моё местоположение"
    - assert: Кнопка "Моё местоположение" возвращает карту к курсору

    - platforms:
      - android
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при помощи WiFi:
    - info: |
        - В настройках определения местоположения включена опция “По координатам сети”
        - Переключение разных источников на девайсе:
        Настройки -> Местоположение -> Режим
        - Сеть Wi-Fi включена
        - Передача данных по мобильным сетям отключена
    - do: Запустить приложение
    - assert: В текущем местоположении отображается либо курсор, либо метка “Я”, вокруг метки “Я” выделена область
    - do: |
        - Построить маршрут
        - Тап Поехали
    - assert: Курсор подсвечивается кружком вокруг позиции, что означает о неточной позиции
    - do: |
        - Поскроллить карту
        - Тап на кнопку "Моё местоположение"
    - assert: Кнопка "Моё местоположение" возвращает карту к курсору

    - platforms:
      - autochip
      - motrex
      - android
    - tags:
      - assessors
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при помощи мобильных сетей:
    - info: |
        - В настройках определения местоположения включена опция “По координатам сети”.
        - Переключение разных источников на девайсе:
        Настройки -> Местоположение -> Режим
        - Сеть Wi-fi отключена
        - Передача данных через мобильную сеть включена
    - do: Запустить приложение
    - assert: В текущем местоположении отображается либо курсор, либо метка “Я”, вокруг метки “Я” выделена область
    - do: |
        - Построить маршрут
        - Тап “Поехали”
    - assert: Курсор подсвечивается кружком вокруг позиции, что означает о неточной позиции
    - do: |
        - Поскроллить карту
        - Тап на кнопку "Моё местоположение"
    - assert: Кнопка "Моё местоположение" работает, возвращает карту к курсору

    - platforms:
      - geely
      - vaz
      - carsharing_t3
      - android
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при помощи GPS:
    - info: |
        - В настройках определения местоположения включена опция “Только GPS”
        - Переключение разных источников на девайсе:
        Настройки -> Местоположение -> Режим
        - Скачан кеш города в котором проходит тестирование
        - Сеть Wi-fi отключена
        - Передача данных по мобильным сетям отключена
        - GPS включен
    - do: Запустить приложение
    - assert: В текущем местоположении отображается либо курсор, либо метка “Я”, вокруг метки “Я” выделена область
    - do: |
        - Построить маршрут
        - Тап Поехали
    - assert: В карточке обзора выводится сообщение "Маршрут без интернета"
    - do: |
        - Поскроллить карту
        - Тап на кнопку "Моё местоположение"
    - assert: Кнопка "Моё местоположение" возвращает карту к курсору

    - platforms:
      - android
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения  при подключении через LTE:
    - info: |
        - В настройках девайса выбран тип сети на 4G/LTE
        Для смены мобильной сети:
        iOS: перейти в Настройки устройства -> сотовая связь -> Параметры данных -> Голос и данные 
        Android: Настройки -> Мобильный интернет -> Режим сети -> Предпочтительный режим сети
        Названия пунктов меню могут отличаться
        - Навигатор не запущен
    - do: Запустить приложение
    - assert: |
        - Открывается экран карты
        - Карта центрируется на местоположении пользователя
        - На карте присутствует курсор

    - platforms:
      - ios
      - android
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при подключении через WiFi:
    - info: |
        - Девайс подключен к сети по wi-fi
        - Передача мобильных данных выключена
        - Навигатор не запущен
    - do: Запустить Навигатор
    - assert: |
        - Открывается экран карты
        - Карта центрируется на местоположении пользователя

    - platforms:
      - ios
      - android
    - tags:
        - assessors
        - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при подключении через 3G:
    - info: |
        - В настройках девайса выбран тип сети на 3G
        Для смены мобильной сети:
        iOS: перейти в Настройки устройства -> сотовая связь -> Параметры данных -> Голос и данные 
        Android: Настройки -> Мобильный интернет -> Режим сети -> Предпочтительный режим сети
        Названия пунктов меню могут отличаться
        - Навигатор не запущен
    - do: Запустить Навигатор
    - assert: |
        - Открывается экран карты.
        - Карта центрируется на местоположении пользователя. 
        - На карте присутствует курсор. Вокруг курсора может быть синяя полупрозрачная окружность, изображающая погрешность в определении местоположения

    - platforms:
      - ios
      - android
    - tags:
        - assessors
        - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Определение местоположения при подключении через 2G:
    - info: |
        - В настройках девайса выбран тип сети на 2G
        Для смены мобильной сети:
        iOS: перейти в Настройки устройства -> сотовая связь -> Параметры данных -> Голос и данные 
        Android: Настройки -> Мобильный интернет -> Режим сети -> Предпочтительный режим сети
        Названия пунктов меню могут отличаться
        - Навигатор не запущен
    - do: Запустить Навигатор
    - assert: |
        - Открывается экран карты.
        - Карта центрируется на местоположении пользователя.
        - На карте присутствует курсор. Вокруг курсора может быть синяя полупрозрачная окружность, изображающая погрешность в определении местоположения.

    - platforms:
      - ios
      - android
    - tags:
        - assessors
        - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit