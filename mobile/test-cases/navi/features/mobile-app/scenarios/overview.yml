components: overview
testing:
  - regress

specs:
  Варианты маршрутов (логирование):
    - info: |
        - Девайс подключен к ПК, запущено средство для просмотра логов
        - Построить маршрут любым способом
        - Запустить симуляцию движения с помощью дебаг-панели
    - do: Во время движения по маршруту тап «Обзор» в таббаре
    - assert: |
        - В обзоре отображается до 3х маршрутов: активный маршрут, и один или два других
        - По умолчанию выбранным отображается текущий маршрут
        - В логах при наличии альтернативных маршрутов приходит событие **route.show-variants**

    - integration_run:
      - mapkit
    - platforms:
      - ios
      - android
    - tags:
      - assessors
      - mapkit_ready
      - metric


  Карточка обзора маршрута:
    - description: |
        Цель: тестируем новую карточку обзора вариантов маршрута.
        Особенности: **Поддержка mySPIN есть только на Android**
    - info: |
        На Android появилась анимация смены высоты карточки обзора, когда выбирается таб с другой высотой (например, с флагами или via)
        - Перезапустить приложение.
        - Скачан кеш области, в которой определяется местоположение пользователя.
    - do: Построить маршрут в любую точку, содержащий события на нем. (например, плохие дороги/платные участки/границы).
    - assert: |
        - Маршрут построен.
        - В нижней части экрана отображается карточка обзора вариантов маршрута c кнопками "Поиск" (иконка лупы), "Отмена" и "Поехали".
        - В карточке отображаются иконки и информация о событиях на маршруте (не более двух наиболее приоритетных например "Платная дорога", "Пересечение границы").
    - do: Тап на "Поехали"
    - assert: Происходит переход в режим ведения маршрута
    - do: Перейти в режим обзора маршрута тапом на соответстующую кнопку в таббаре
    - assert: |
        - В нижней части экрана отображается карточка обзора вариантов маршрута c кнопками “Поиск” (иконка лупы), “Сброс” и “Поехали”.
        - В карточке отображаются иконки и информация о событиях на маршруте (не более двух наиболее приоритетных например "Платная дорога", "Пересечение границы").
    - do: Выполнить тап по вариантам для переключения маршрута.
    - assert: Вариант маршрута меняется

    - platforms:
      - carsharing_t3
      - ios
      - android
      - t3am
    - tags:
        - assessors
    - testing:
      - acceptance_navi


  Карточка обзора маршрута. Поиск:
    - description: |
        **Поддержка mySPIN есть только на Android**
    - info: |
        1 - Отключен поиск от МЯКа
        Developer Settings -> Search ->Y.Maps search for yandexoid -> off
        Developer Settings -> Search ->Y.Maps search screen -> off
        На Android появилась анимация смены высоты карточки обзора, когда выбирается таб с другой высотой (например, с флагами или via)
        - Перезапустить приложение
    - do: Построить маршрут в любую точку
    - assert: |
        - Маршрут построен
        - В нижней части экрана отображается карточка обзора вариантов маршрута c кнопками "Поиск" (иконка лупы), "Отмена" и "Поехали"
    - do: Тап на кнопку поиска (лупу)
    - assert: Открывается экран "Поиск"
    - do: Выполнить поиск по любому запросу/категории
    - assert: |
        - Происходит переход на экран "Карта"
        - На карте отображаются пины результата поиска
        - Карточка обзора маршрута не отображается
        - Открывается карточка с результатами поиска
    - do: Закрыть карточку результатов поиска
    - assert: |
        - На карте продолжают отображаться результаты поиска (старый поиск, в новом поиске не отображаются, как отключить написано в info)
        - Открывается карточка обзора маршрута
    - do: |
        - Тап на "Поиск" (иконка лупы)
        - После открытия раздела "Поиск" тап на "Отмена"
    - assert: Происходит возврат к экрану "Карта" и карточке обзора вариантов маршрута

    - platforms:
      - ios
      - android
      - t3am
    - tags:
        - assessors
        - android_4
    - testing:
      - acceptance_navi


  Карточка обзора маршрута. Смена ориентации:
    - description: |
        Цель: тестируем новую карточку обзора вариантов маршрута.
        Особенности: **Поддержка mySPIN есть только на Android**
    - info: |
        На Android появилась анимация смены высоты карточки обзора, когда выбирается таб с другой высотой (например, с флагами или via)
        - Перезапустить приложение.
        - Построить маршрут в любую точку, содержащий события на нем. (например, плохие дороги/платные участки/границы).
        - Тап на “Поехали”
    - do: |
        Перейти в режим обзора маршрута тапом на соответстующую кнопку в таббаре
        Изменить ориентацию девайса.
    - assert: |
        Разметка карточки и отображение вариантов маршрута не нарушены:
        - Пол экрана занимает карточка обзора вариантов маршрута c кнопками “Поиск” (иконка лупы), “Сброс” и “Поехали”.
        - В карточке отображаются иконки и информация о событиях на маршруте (не более двух наиболее приоритетных например "Платная дорога", "Пересечение границы").

    - platforms:
      - ios
      - android
    - tags:
        - assessors
    - testing:
      - acceptance_navi


  Экран «Обзор». Тап на "Поехали":
    - do: Построить маршрут
    - assert: |
        - На карте отображаются маршруты
        - Маршруты отображены на карте полностью (видно начало и финиш)
        - Отображается карточка обзора маршрута с кнопками "Отмена" и "Поехали"
    - do: Тап «Поехали»
    - assert: Начинается режим ведения по маршруту. Карта центрируется по курсору

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Экран «Обзор». Тап на "Отмена":
    - do: Построить маршрут
    - assert: |
        - На карте отображаются маршруты
        - Маршруты отображены на карте полностью (видно начало и финиш) 
        - Отображается карточка обзора маршрута с кнопками "Отмена" и "Поехали"
    - do: Кнопка «Отмена»
    - assert: |
         - Построенный маршрут отменяется
         - Происходит возврат на карту

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Экран «Обзор». Таймаут:
    - info: |
        - Построить маршрут любым способом
        - Запустить симуляцию движения (со скоростью >= 5 км/ч)
    - do: |
        - Тап на иконку "Обзор маршрута" в тапбаре.
        - Продолжать двигаться со скоростью >= 5 км/ч с отображаемым обзором ~20 сек
    - assert: |
        - По истечении таймаута навигатор переходит в режим движения по маршруту
        - Ориентация карты зависит от направления движения

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Логирование нового экрана обзора:
    - description: |
        Инструкция как это протестировать есть на приветственной вики-странице
    - info: Девайс подключен к компу, запущено средство для просмотра логов.
    - do: Построить маршрут любым способом
    - assert: |
        - Маршрут строится
        - Открывается обзор с вариантами маршрутов.
    - do: Переключать варианты маршрута табом по вариантам в карточке.
    - assert: |
        В логи приходит событие `route.switch-route-variants` с параметрами:
        Параметр index - индекс выбранного варианта
        Параметр source - источник переключения - tabs
    - do: Переключать варианты маршрута тапом по альтернативам на карте.
    - assert: |
        В логи приходит событие `route.switch-route-variants` с параметрами:
        Параметр index - индекс выбранного варианта
        Параметр source - источник переключения - map
    - do: Переключать варианты маршрута тапом по баллунам альтернатив
    - assert: |
        В логи приходит событие `route.switch-route-variants` с параметрами:
        Параметр index - индекс выбранного варианта
        Параметр source - источник переключения - balloon

    - platforms:
      - ios
      - android
    - tags:
        - assessors
        - metric


  Названия улиц в обзоре:
    - description: На экране обзора названия улиц показываются над маршрутом, а во время ведения под ним.
    - info: |
        Необходимо включить настройку Dev settings > Map > Road labels under route - on
        Построить маршрут
    - do: Запустить ведение по маршруту
    - assert: Названия улиц на маршруте не показываются.
    - do: Тап по карте
    - assert: |
        Экран не следует за стрелкой
        Названия улиц показываются над маршрутом

    - platforms:
      - ios
      - android
    - tags:
        - assessors