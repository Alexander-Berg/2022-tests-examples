components: jams
testing:
  - regress

specs:
  Парковки и пробки:
    - description: Одновременно работает максимум один из функционалов, либо парковки.. либо пробки ... либо ничего
    - info: |
        Яндекс.Навигатор Debug сборка установлено на девайс
        Приложение запущено
        Маршрут построен (часть маршрута проходит за городом, на территориях где нету парковок\информации о парковках)
        Пробки выключены \ парковки выключены
    - do: Включить пробки
    - assert: |
        Пробки отображаются
        Парковки не отображаются
    - do: Выключить пробки
    - assert: |
        Пробки не отображаются
        Парковки не отображаются
    - do: Включить парковки
    - assert: |
        Пробки не отображаются
        Парковки отображаются
    - do: Включить пробки
    - assert: |
        Пробки отображаются
        Парковки не отображаются, свитчер парковки отображаются как выключенный
    - do: Включить парковки
    - assert: |
        Пробки не отображаются, светофор серый
        Парковки  отображаются

    - platforms:
      - ios
      - android
    - tags:
      - assessors


  Время в пробке:
    - info: |
        - Плашка показывается если время в пробке превышает 3 минуты
        - Включены пробки на карте
    - do: |
        - Построить маршрут в любую точку, который начинается в пробке
        - Тап Поехали
        - Запустить симуляцию движения по маршруту на скорости около 5-10 км/ч
        - Подождать ~5 секунд, пока не скроются кнопки интерфейса
    - assert: Над плашкой ETA отображается плашка с данными о пробке - ее длина и ориентировочное время ее прохождения
    - do: Продолжать движение по маршруту
    - assert: Значения времени в пробке и ее длины меняются в зависимости от прохождения расстояния пользователем
    - do: Сойти с маршрута, изменив маршрут на любой другой, не выключая симуляцию движения по предыдущему маршруту
    - assert: |
        - Звучит аннотация о готовности маршрута, например: "Маршрут построен" или "Алгоритм поездки готов"
        - Плашка с временем в пробке снова появляется, если она есть на маршруте, время рассчитывается заново для нового маршрута

    - platforms:
      - geely
      - carsharing_t3
      - ios
      - android
      - t3am
      - motrex
      - autochip
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Появление пробок и балла светофора после включения сети:
    - info: |
        - Навигатор не запущен
    - do: |
        - Отключить сеть
        - Запустить приложение
    - assert: |
        - Пробки не отображаются
        - Светофор в состоянии “загружается” мигает желтым
        - Отображается часть загруженной карты или белый экран без карты
    - do: Позумиться и подвигать карту
    - assert: |
        - Пробки не отображаются
        - Светофор серый
    - do: Включить сеть
    - assert: |
        - Начали подгружаться тайлы там, где их не было
        - Появились пробки
        - Появился балл светофора (цвет - красный, жёлтый или зелёный, балл - от 0 до 10) или иконка светофора, где недоступны баллы пробок

    - platforms:
      - renault
      - nissan
      - ios
      - android
      - motrex
      - vaz
      - carsharing_t3
      - t3am
      - autochip
      - first_run_hu
    - tags:
      - assessors
      - both_myspin
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit
      - myspin


  Обновление пробок и баллов из кеша:
    - info: Навигатор запущен
    - do: Выключить пробки тапом на иконку светофора
    - assert: |
        - Пробки перестали отображаются на карте
        - Светофор стал белым, без балла (или черным, в зависимости от выбранной темы навигатора)
    - do: |
        - Выключить сеть, либо включить Авиарежим
        - Включить пробки тапом на иконку светофора
    - assert: |
        - Светофор показывает балл и цвет
        - Пробки отображаются на некоторых масштабах
    - do: Включить сеть
    - assert: Пробки отображаются на всех масштабах, начиная с 7.50 зума 

    - platforms:
      - renault
      - nissan
      - ios
      - android
      - vaz
      - carsharing_t3
      - t3am
      - motrex
      - autochip
      - first_run_hu
    - tags:
      - assessors
      - both_myspin
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit
      - myspin


  Устаревание пробок:
    - info: Геопозиция Москва (если иное, подменить местоположение)
    - do: |
       Включен интернет на девайсе
       Включить пробки тапом на иконку светофора
    - assert: На карте отображаются пробки
    - do: |
       Выключить интернет
       Подождать 25 минут, экран телефона при этом должен оставаться включенным
    - assert: Светофор перешел в состояние "устарело" (серый)
    - do: Включить сеть
    - assert: Светофор стал показывать актуальный балл и цвет.

    - platforms:
      - ios
      - android
    - tags:
      - assessors
      - mapkit_ready
    - integration_run:
      - mapkit
