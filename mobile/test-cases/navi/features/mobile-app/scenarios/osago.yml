components: osago
testing:
  - regress

specs:
  Кнопка "Оформить ОСАГО" в меню под кнопкой авто:
    - description: |
        **ОК** - отзывные кампании (открываются по тапу на кнопку "Добавить авто")
        **Список машин** - кнопки машин под аватаркой пользователя (список скроллится горизонтально, за раз показывается одна кнопка целиком).
        В этом кейсе проверяется вид кнопки "Выбрать ОСАГО" в меню навигатора под кнопкой добавленного авто. Данная кнопка показывается в карточке автомобиля, если пользователь попал в эксперимент по ОСАГО. Данная кнопка показывается в Меню, если пользователь попал в выборку.
        При тапе на кнопку "Выбрать ОСАГО" открывается webview Сравни.ру. 
        Выглядит кнопка ОСАГО в Меню и карточке авто соответственно так: 
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан, либо истекает ранее чем через 60 дней от текущей даты
        - Показан главный экран Навигатора
    - do: Тап на кнопку Меню в таббаре
    - assert: |
        - Раскрывается Меню
        - Под блоком профиля показан список машин с плашкой авто
        - Под кнопкой авто показана кнопка "Выбрать ОСАГО"
        - Перед текстом иконка листа с загнутым уголком
        - Текст и иконка на кнопке синий в любой теме
        - Под кнопкой идёт остальное меню Нави, начиная с Настроек
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
    - do: Скрол влево в списке машин
    - assert: |
        - Список машин проскролился
        - Кнопка авто поменялась на кнопку "+ Добавить машину"
        - Кнопка "Выбрать ОСАГО" скрылась, не показывается под "+ Добавить машину"
    - do: Свайп вправо списке машин
    - assert: |
        - Список машин проскролился
        - Кнопка “+ Добавить машину” поменялась на кнопку  авто
        - Появилась кнопка "Оформить ОСАГО" (как в шаге 1)

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Кнопка "Оформить ОСАГО" в меню без добавленного авто:
    - description: |
        **ОК** - отзывные кампании (открываются по тапу на кнопку "Добавить авто")
        **Список машин** - кнопки машин под аватаркой пользователя (список скроллится горизонтально, за раз показывается одна кнопка целиком).
        В этом кейсе проверяется вид кнопки "Выбрать ОСАГО" в меню навигатора под кнопкой добавленного авто. Данная кнопка показывается в карточке автомобиля, если пользователь попал в эксперимент по ОСАГО. Данная кнопка показывается в Меню, если пользователь попал в выборку.
        При тапе на кнопку "Выбрать ОСАГО" открывается webview Сравни.ру. 
        Выглядит кнопка ОСАГО в Меню и карточке авто соответственно так: 
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя нет автомобилей
        - Показан главный экран Навигатора
    - do: Тап на кнопку Меню в таббаре
    - assert: |
        - Раскрывается Меню
        - Под блоком профиля показан список машин:
            - Первая кнопка "Выбрать ОСАГО" 
            - Вторая кнопка "+ Добавить машину"
        - Перед текстом иконка листа с загнутым уголком
        - Текст и иконка на кнопке синий - в дневной теме
        - Текст и иконка на кнопке жёлтый - в ночной теме
        - Под кнопкой идёт остальное меню Нави, начиная с Настроек
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
    - do: Скролл влево в списке машин
    - assert: |
        - Список машин проскролился
        - Кнопка "Выбрать ОСАГО" поменялась на кнопку "+ Добавить машину"
    - do: Свайп вправо списке машин
    - assert: |
        - Список машин проскроллился
        - Кнопка “+ Добавить машину” поменялась на кнопку  "Выбрать ОСАГО"
        - Вид экрана как в шаге 1
    - do: Тап кнопку "Выбрать ОСАГО"
    - assert: |
        - Открывается вебвью Сравни.ру на экране "ОСАГО онлайн"
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор1.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Кнопка "Оформить новый полис" в карточке авто у пользователя, попавшего в выборку:
    - description: |
        Данная кнопка показывается в карточке автомобиля, если пользователь попал в эксперимент по ОСАГО. Данная кнопка показывается синего цвета и имеет красный бейдж (кружок с восклицательным знаком напротив даты) если пользователь попал в выборку.
        При тапе на кнопку "Выбрать ОСАГО" открывается webview Сравни.ру. 
        Выглядит кнопка ОСАГО в карточке авто так: 
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлены две машины
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан
        - Показано Меню Навигатора
    - do: Тап автомобиль пользователя
    - assert: |
        - Открывается карточка авто
        - В блоке “ОСАГО” под датой окончания ОСАГО:
            - активная синяя кнопка “Оформить новый полис”
    - do: Добавить дату окончания ОСАГО ≤ 60 дней
    - assert: |
        - Дата отображается под заголовком "Дата окончания"
        - Формат даты: "до _дата_"  в формате ДД.ММ.ГГГГ
        - Кнопка “Оформить новый полис” активная синяя
        - Напротив даты окончания показан бейдж с красным восклицательным знаком в круге
    - do: Тап "Оформить новый полис"
    - assert: |
        - Происходит переход в веб-вью Сравни.ру
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}
    - do: Тап стрелку назад для возврата в карточку авто
    - assert: |
        - Кнопка “Оформить новый полис” по-прежнему синяя
        - Бейдж по-прежнему показан напротив даты
    - do: Тап стрелку назад для возврата в Меню Нави
    - do: Тап другую машину
    - assert: Открывается карточка авто
    - do: Добавить дату окончания ОСАГО > 60 дней
    - assert: |
        - Кнопка “Оформить новый полис” стала серой
        - Бейдж отсутствует
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО3.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Кнопка "Оформить новый полис" в карточке авто у пользователя, НЕ попавшего в выборку:
    - description: В этом кейсе проверяется вид кнопки "Оформить новый полис" в карточке авто. Данная кнопка появляется в блоке "ОСАГО" под датой окончания. Отсутствие даты окончания не влияет на показ кнопки. Кнопка показывается всем пользователям, попавшим в эксперимент
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО на деба: в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО НЕ указан
        - Показано Меню Навигатора
    - do: Тап автомобиль
    - assert: |
        - Открывается карточка авто
        - В блоке “ОСАГО” под синей надписью "Добавить дату окончания" активна серая кнопка “Оформить новый полис”
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО4.jpg){title= Скриншот}
    - do: Тап “Добавить дату окончания”
    - assert: Открывается датапикер
    - do: Ввести текущую дату +1 день
    - do: Тап "Сохранить"
    - assert: |
        - Показана карточка автомобиля
        - В блоке ОСАГО появилась дата окончания
        - Цвет кнопки "Оформить новый полис" не изменился
        - Возле даты НЕ появился красный бейдж с восклицательным знаком
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО3.jpg){title= Скриншот}
    - do: Тап стрелку назад
    - assert: |
        - Пользователь в меню Нави
        - Под кнопкой автомобиля НЕ показана кнопка "Выбрать ОСАГО"
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО5.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Тема экранов Сравни.ру соответствует теме в Навигаторе:
    - description: |
        В этом кейсе проверяется соответствие тем в Навигаторе и экранах Сравни.ру (при тапе в кнопку оформления ОСАГО).
        При этом тема сайта sravni.ru в webview определяется в момент открытия сайта. Если Нави после этого сменил тему, то сайт в webview на это никак не отреагирует - это ожидаемо
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - Показана карточка авто
    - do: Тап “Оформить новый полис”
    - assert: |
        - Открывается вебвью Сравни.ру (экран Калькулятора ОСАГО)
        - Вебвью в той же теме, что и экран Навигатора позади, что и навбар:
            - если Навигатор в дневной теме - то и экран Сравни.ру в дневной теме
            - если Навигатор в ночной теме - то и экран Сравни.ру в ночной теме
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Подтягиваются данные выбранного авто при оформлении ОСАГО:
    - description: В этом кейсе проверяется, что при оформлении полиса ОСАГО по кнопке из карточки авто в Калькулятор ОСАГО (Сравни.ру) в поля подставляются данные той машины, из карточки которого перешли в оформление. При этом подтянутся данные автомобиля, который был добавлен поиском по гос. номеру. Автомобиль, добавленный через VIN, не подтянется!
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан, либо истекает ранее чем через 60 дней от текущей даты
        - Показана карточка авто
    - do: Тап “Оформить новый полис”
    - assert: |
        - Открывается вебвью Сравни.ру (экран Калькулятора ОСАГО)
        - Вебвью в той же теме, что и экран Навигатора позади, что и навбар
        - В поля Калькулятора подтянулись данные из карточки авто (в соответствии с теми данными, что пришли из Авто.ру)
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}
    - do: Тап по стрелке назад в навбаре
    - assert: Показана карточка авто
    - do: Тап по стрелке назад в навбаре
    - assert: |
        - Показано Меню Нави
        - Показана плашка автомобиля, карточку которого открывали
    - do: Свайп по плашке авто влево/вправо (в зависимости от того, в какой позиции находится второй добавленный автомобиль)
    - assert: Показана плашка второго автомобиля
    - do: Тап автомобиль
    - assert: Показана карточка авто
    - do: Тап “Оформить новый полис”
    - assert: |
        - Открывается вебвью Сравни.ру (экран Калькулятора ОСАГО)
        - В поля Калькулятора подтянулись данные из карточки авто, выбранного в шаге 5
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Оформление полиса ОСАГО:
    - description: В этом кейсе проверяется оформление полиса ОСАГО в Сравни.ру
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан, либо истекает ранее чем через 60 дней от текущей даты
        - Показана карточка авто
        
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - do: Тап “Оформить новый полис”
    - assert: |
        - Открывается вебвью Сравни.ру (экран Калькулятора ОСАГО)
        - Вебвью в той же теме, что и экран Навигатора позади, что и навбар
        - В поля Калькулятора подтянулись данные из карточки авто
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор1.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}
    - do: Проверив данные, тап кнопку "Продолжить"
    - assert: |
        - Показан экран "Период и регион"
        - Показаны два поля для заполнения: начало действия нового полиса и место регистрации собственника
    - do: Заполнив данные, тап "Продолжить"
    - assert: |
        - Переход на шаг "Водители"
        - Показаны поля для заполнения данных о лицах, допущенных к управлению (ФИО, дата рождения, серися и номер ВУ, дата начала стажа, кнопка добавления водителя)
    - do: Заполнив данные, тап "Показать результат"
    - assert: |
        - Переход на экран "Электронный полис"
        - На экране показан список страховых компаний,  оформляющих данный полис
        - В блоке каждой страховой указан ценник полиса с синей кнопкой "Оформить"
    - do: Тап "Оформить" у одной из страховых компаний
    - assert: |
        - Переход на шаг "Данные собственника"
        - Может потребоваться дозаполнение паспортных данных
        - Подтягиваются ранее добавленные ФИО и дата рождения
    - do: Заполнив данные, тап “Продолжить”
    - assert: |
        - Показан экран заполнения данных об автомобиле
        - Вверху экрана показан сниппет с ценником полиса выбранной СК
        - Поле "Номер" позволяет выбор (VIN/кузов/шасси)
        - Поле "Документ" позволяет выбор (СТС/ПТС)
    - do: Заполнив данные, тап “Продолжить”
    - assert: |
        - Показан экран "Контактные данные"
        - Поля e-mail и телефон для связи обязательны к заполнению
    - do: Заполнив данные, тап “Получить код”
    - assert: На указанный номер приходит смс с кодом
    - do: Ввести смс-код и перейти на следующий экран
    - assert: |
        - Показан экран "Пожалуйста, проверьте данные"
        - Поля на экране проверки редактируемые
    - do: Проверив данные, тап "Продолжить"
    - assert: |
        - На время ожидания ~ 2 минуты - показана анимация
        - По окончании проверки данных показан экран, свидетельствующий об успехе или неуспехе проверки данных
        ![Скрин](https://jing.yandex-team.ru/files/oshestopalova/IMAGE%202020-04-16%2016%3A25%3A12.jpg)
    - do: Тап "Перейдите к оплате"
    - assert: |
        - Показан экран с квитанцией платежа
        - Показаны поля ввода номера карты, срока действия и ФИ владельца, а также CVV2/CVC2
    - do: После окончания проверки выключить эксперимент и попадание в выборку, перезапустить приложение

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Включение/отключение эксперимента ОСАГО:
    - description: В этом кейсе проверяется работа эксперимента ОСАГО. Если включен эксперимент - у пользователя кнопка оформления ОСАГО будет показываться в карточке авто
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - Эксперимент по ОСАГО отключен
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - Показано Меню Нави
    - do: Тап автомобиль
    - assert: |
        - Показана карточка авто
        - В разделе "ОСАГО" отсутствует кнопка для оформления полиса ОСАГО
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО6.jpg){title= Скриншот}
    - do: Закрыть карточку авто по крестику или свайпом вниз
    - assert: Показана карта
    - do: Тап Меню
    - assert: Открывается Меню Нави
    - do: |
        Тап "Настройки"- зайти в Developer settings - Ya.Auto - Sravni.ru OSAGO enabled - выбрать On
        Перезапустить приложение
        Открыть Меню Нави
        Тап автомобиль
    - assert: |
        - В разделе "ОСАГО" появилась кнопка под датой окончания "Оформить новый полис"
        - Кнопка серая 
        - При тапе кнопки открывается вебвью Сравни.ру
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО4.jpg){title= Скриншот}
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}
    - do: Отключить эксперимент и после перезапуска приложения проверить, что кнопка “Оформить новый полис” пропала из карточки авто
    - assert: Кнопка "Оформить новый полис" пропала из раздела "ОСАГО" карточки авто

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Показ кнопки "Выбрать ОСАГО" если дата полиса не указана:
    - description: В этом кейсе проверяется показ кнопки "Выбрать ОСАГО" под автомобилем в Меню Нави, если у пользователя не указана в карточке авто дата окончания ОСАГО. Для показа ОСАГО в Меню Нави пользователь должен попасть в выборку
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - Добавлены минимум 2 машины, у обеих не указана дата окончания ОСАГО
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - Показано Меню Навигатора
    - do: Свайпами вправо-влево перемещать автомобили
    - assert: |
        - Под каждым авто показана кнопка "Выбрать ОСАГО"
        - Кнопка соответствует макетам в [дневном](https://jing.yandex-team.ru/files/natalya-ovs/photo_2020-12-21_10-14-32.jpg) и [ночном](https://jing.yandex-team.ru/files/natalya-ovs/photo_2020-12-21_10-14-37.jpg) режимах
        - При переводе фокуса с одного авто на другой кнопка "Выбрать ОСАГО" показана у того, что находится в центре
        - Анимация сворачивания/разворачивания кнопки ОСАГО в фокусе и вне его плавная
    - do: После окончания проверки выключить эксперимент и попадание в выборку, перезапустить приложение

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Показ кнопки "Выбрать ОСАГО" если дата окончания полиса ≤ 60 дней:
    - description: В этом кейсе проверяется показ кнопки "Выбрать ОСАГО" под автомобилем в Меню Нави, если у пользователя дата окончания ОСАГО наступает через 60 дней от текущей или ранее. Для показа ОСАГО в Меню Нави пользователь должен попасть в выборку
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан
        - Показана карточка автомобиля
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - do: Тап "Добавить дату окончания" в разделе "ОСАГО"
    - assert: Показан датапикер
    - do: Выбрать дату ≤ 60 дней от текущей даты
    - do: Тап "Сохранить"
    - assert: Дата окончания полиса установлена
    - do: Тап Меню Нави в таббаре
    - assert: |
        - Под автомобилем показана кнопка "Выбрать ОСАГО"
        - Пользователь попал в выборку
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
    - do: После окончания проверки выключить эксперимент и попадание в выборку, перезапустить приложение

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Непоказ кнопки "Выбрать ОСАГО" если дата окончания полиса > 60 дней:
    - description: В этом кейсе проверяется, что кнопка "Выбрать ОСАГО" под автомобилем в Меню Нави не показывается, если у пользователя дата окончания ОСАГО наступает более чем через 60 дней от текущей - даже если пользователь попал в выборку
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан
        - Показана карточка авто
    - do: Тап "Добавить дату окончания" в разделе "ОСАГО"
    - assert: Показан датапикер
    - do: Выбрать дату > 60 дней от текущей даты
    - do: Тап "Сохранить"
    - assert: Дата окончания полиса установлена
    - do: Тап Меню Нави в таббаре
    - assert: |
        - Пользователь попал в выборку
        - Под автомобилем НЕ показана кнопка "Выбрать ОСАГО"

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Тап "Выбрать ОСАГО" открывает экран Калькулятора Сравни.ру:
    - description: В этом кейсе проверяется, что кнопка "Выбрать ОСАГО" под автомобилем в Меню Нави открывает вебвью Сравни.ру
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - У пользователя добавлена одна машина
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан, либо истекает ранее чем через 60 дней от текущей даты
        - Показано Меню Навигатора
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО2.jpg){title= Скриншот}
    - do: Тап "Выбрать ОСАГО" под автомобилем
    - assert: |
        - Показан вебвью:
        - если автомобиль добавлен по госномеру - экран Калькулятора ОСАГО с предзаполненными (подтянувшимися из карточки авто полями)
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор2.jpg){title= Скриншот}
        - если автомобиль добавлен по VIN - первый экран Сравни.ру - "ОСАГО онлайн"
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/Калькулятор3.jpg){title= Скриншот}
    - do: Тап стрелку назад в навбаре
    - assert: |
        - Показано Меню Нави
        - Внизу автомобиля висит кнопка "Выбрать ОСАГО"
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Плашка с "Оформить ОСАГО" и авто НЕ смещается произвольно:
    - description: |
        **ОК** - отзывные кампании (открываются по тапу на кнопку "Добавить авто")
        **Список машин** - кнопки машин под аватаркой пользователя (список скролится вправо, за раз показывается одна кнопка)
        В этом кейсе проверяется вид кнопки "Выбрать ОСАГО" в меню навигатора под кнопкой добавленного авто. Данная кнопка показывается, если пользователь попал в эксперимент по ОСАГО и в выборку.
        При тапе на кнопку "Выбрать ОСАГО" открывается webview Сравни.ру 
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - On»
        - Включить эксперимент по ОСАГО : в приложении зайти в Меню Нави - Настройки - dev_settings - Ya.Auto - включить Sravni.ru OSAGO в положение On
        - После включения настроек в dev_settings перезапустить приложение, после захода в приложение подождать 2-3 минуты перед тем, как открывать Меню
        - Пользователь авторизован в Навигаторе
        - Добавлено минимум 2 автомобиля
        - Чтобы добавить машину, нужно в приложении зайти в Меню - тап кнопку "Добавить машину" под аватаром пользователя - ввести в поле ввода гос. номер авто или его VIN - тап "Найти" - подтвердить, что найденный автомобиль принадлежит пользователю
        - У добавленной машины срок окончания полиса ОСАГО не указан, либо истекает ранее чем через 60 дней от текущей даты
        - Показан главный экран Навигатора
    - do: Тап на кнопку Меню в таббаре
    - assert: |
        - Раскрывается Меню
        - Под блоком профиля показан список машин с плашкой авто
        - Под кнопкой авто показана кнопка "Выбрать ОСАГО" 
        - Перед текстом иконка листа с загнутым уголком
        - Текст и иконка на кнопке синий - в любой теме
        - Под кнопкой идёт остальное меню Нави, начиная с Настроек
        [collapsed-image](https://jing.yandex-team.ru/files/oshestopalova/ОСАГО1.jpg){title= Скриншот}
    - do: Медленно поскроллить Меню Нави, вернувшись к плашке с кнопками авто и ОСАГО
    - assert: |
        - Плашки находятся на своих фиксированных местах: не смещены, не задвоены
        - Точки под ними (пагинация) не смещены, не задвоены, также находятся на фиксированных местах
    - do: Попробовать сместить, наложить плашки автомобилей друг на друга
    - assert: |
        - Не получается наложение плашек
        - Автомобили листаются
    - do: Попробовать сместить, наложить кнопку добавления авто на другие кнопки с автомобилями
    - assert: |
        - Не получается наложение плашек
        - Открывается экран поиска авто для ОК
    - do: Добавить автомобиль
    - assert: Автомобиль добавлен и появился в Меню
    - do: Разлогиниться
    - assert: |
        - Отдельные кнопки ОСАГО и "Добавить машину" находятся на своих фиксированных местах: не смещены, не задвоены
        - Плашки не накладываются друг на друга при попытке их смещения
    - do: Залогиниться тем же аккаунтом
    - assert: |
        - Плашки находятся на своих фиксированных местах: не смещены, не задвоены
        - Точки под ними (пагинация) не смещены, не задвоены, также находятся на фиксированных местах
    - do: Попробовать сместить, наложить плашки автомобилей друг на друга, кнопку добавления автомобиля на кнопки автомобилей
    - assert: |
        - Наложение плашек не получается
        - Все кнопки находятся на своих местах, не смещены, не задвоены, не смещаются

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Подтягиваются данные авто в оффер ОСАГО при вводе ГРЗ кириллицей:
    - description: В этом кейсе проверяется, что при оформлении полиса ОСАГО если ГРЗ (государственный регистрационный знак) вводился кириллицей - он транслитерируется в латиницу и прокинется в Калькулятор Сравни.ру для расчёта ОСАГО
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - В Меню Нави показывается оффер на ОСАГО (Сравни.ру) 
        - Пользователь авторизован в Навигаторе
        - Показано Меню Нави на кнопке под аватаром пользователя "Добавить машину"
    - do: Тап “Добавить машину”
    - assert: Открывается экран поиска авто по госномеру или vin-номеру
    - do: Ввести госномер кириллицей, например "к995хе97" с добавлением/поиском машины
    - assert: Показан результат поиска авто
    - do: Тапом "Верно, это моя машина" добавить автомобиль
    - assert: Показана карточка автомобиля
    - do: Тапом стрелки назад вернуться в Меню
    - assert: |
        - Показано Меню
        - Показана кнопка свежедобавленного автомобиля
    - do: |
        **Если выбрана другая кнопка в карусели машин**
        Выбрать в карусели кнопку только что добавленного авто
    - do: Тап “Подберите ОСАГО” в плитке офферов (под рекламным баннером в Меню Нави)
    - assert: |
        - Показан экран Калькулятора ОСАГО
        - В полученные данные подтянулся госномер автомобиля, добавленного в шаге 3, марка, модель (при наличии)

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Отсутствие параметра layout=full по тапу на "Оформить новый полис":
    - description: |
        Для прохождения данного кейса необходимы предварительные настройки: 
        - Должен быть установлен сниффер Charles 
        - Установлен сертификат Charles на телефоне
        Сертификат корректно работает на всех iOS 11+ версиях и на Андроид версий 4.4.2 - 7х
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - Пользователь авторизован
        - У пользователя добавлена машина в Отзывные кампании
        - Включен эксперимент ОСАГО: Developer settings -> Ya.Auto -> Sravni.ru OSAGO enabled -> ON и перезапустить приложение
        - Открыта карточка добавленного авто
        - Charles подключен к девайсу и настроен
    - do: Тап "Оформить новый полис"
    - assert: В Charles упал запрос от Сравни.ру без параметра layout=full

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Свитчер в карточке авто. Есть дата окончания ОСАГО, включен эксперимент Сравни.ру:
    - description: |
        **ОК** - отзывные компании 
        **Карточка авто** - открывается по тапу на кнопку авто в меню навигатора под именем пользователя
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - Включен эксперимент на свитчер в карточке авто (Developer settings - Ya.Auto - OSAGO expired reminders enabled - On)
        - Включен эксперимент Сравни.ру (Developer settings - Ya.Auto - Sravni.ru OSAGO enabled - On)
        - Навигатор перезапущен после изменений в Developer settings
        - Пользователь авторизован
        - Добавлена машина к аккаунту ("Добавить машину" - Ввести госномер или VIN - Тап на "Добавить" - Тап на "Верно, это моя машина")
        - Нет даты окончания ОСАГО в карточке авто (у новой добавленной машины отсутствует)
        - Открыто меню навигатора
    - do: Тап на плашку авто под именем пользователя
    - assert: |
        - Открывается карточка авто
        - В блоке “ОСАГО”:
            - Плашка “Дата окончания”
            - Ниже плашка под свитчер, в которой текст "Добавьте дату окончания ОСАГО и Навигатор напомнит вам продлить полис"
            - В этой же плашке ниже кнопка “Оформить новый полис”
    - do: Тап на "Добавть дату окончания"
    - assert: Открывается датапикер
    - do: Выбрать любую дату
    - do: |
        - Тап на "ОК" (Android)
        - Тап на "Сохранить" (iOS)
    - assert: |
        - Датапакер закрывается
        - В плашке "Дата окончания" появилась выбранная дата
        - Текст "Добавтье дату окончания ОСАГО..." поменялся на свитчер "Напоменить об окончании"
        - Свитчер по умолчанию включен
        - В этой же плашке ниже кнопка “Оформить новый полис”

    - platforms:
      - ios
      - android
    - tags:
        - assessors
    - testing:
      - acceptance_navi


  Изменение даты окончания ОСАГО:
    - description: |
        **ОК** - отзывные компании 
        **Карточка авто** - открывается по тапу на кнопку авто в меню навигатора под именем пользователя
        **Режим редактирования** - режим в котором можно изменять некоторые данные в карточке авто. Включается тапом на иконку карандаша в навбаре рядом с крестиком
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - Включен эксперимент на свитчер в карточке аво (Developer settings - Ya.Auto - OSAGO expired reminders enabled - On)
        - Включен эксперимент Сравни.ру (Developer settings - Ya.Auto - Sravni.ru OSAGO enabled - On)
        - Навигатор перезапущен после изменений в Developer settings
        - Пользователь авторизован
        - Добавлена машина к аккаунту ("Добавить машину" - Ввести госномер или VIN - Тап на "Добавить" - Тап на "Верно, это моя машина")
        - Добавлена дата окончания ОСАГО в карточке авто (Тап на "Добавить дату окончания" - Выбрать дату - Тап на "Сохранить"/"Ок")
        - Свитчер “Напоменить об окончании” в карточке авто в положении ВКЛ
        - Открыто меню навигатора
    - do: Тап на плашку авто под именем пользователя
    - assert: |
        - Открывается карточка авто
        - В блоке “ОСАГО”:
            - Плашка “Дата окончания”
            - Ниже свитчер “Напоменить об окончании” в положении ВКЛ
            - В этой же плашке ниже кнопка “Оформить новый полис”
    - do: Тап на свитчер "Напомнить об окончании"
    - assert: |
        - Свитчер выключается и становится серым
        - Карточка не мигает при переключении свитчера
        - Кнопка "Оформить новый полис" никуда не делась
        - В карточке авто больше ничего не меняется
    - do: Тап на **иконку карандаша** в навбаре
    - assert: |
        - Включается режим редактирования
        - Справа около даты окончания ОСАГО появилась стрелочка
        - Свитчер в положении ВЫКЛ
    - do: |
        - Тап на плашку "Дата окончания"
        - Выбрать другую дату
        - Тап на "ОК" / "Сохранить"
    - assert: |
        - Закрывается датапикер
        - Дата в плашке "Дата окончания" изменилась на новую
        - Свитчер в положении ВЫКЛ
        - Свитчер в единственном экземпляре, не задваивается ни при каких действиях
        - Кнопка "Оформить новый полис" никуда не делась

    - platforms:
      - ios
      - android
    - tags:
        - assessors
    - testing:
      - acceptance_navi


  Свитчер на экране уведомлений навигатора:
    - description: |
        **ОК** - отзывные компании 
        **Карточка авто** - открывается по тапу на кнопку авто в меню навигатора под именем пользователя
    - info: |
        - СИМ-карта русская или отсутствует
        - Локаль ru-ru
        - Пользователь находится на территории РФ
        - «Dev Settings -> misc -> Debug config enabled - OFF»
        - Включен эксперимент на свитчер в карточке аво (Developer settings - Ya.Auto - OSAGO expired reminders enabled - On)
        - Навигатор перезапущен после изменений в Developer settings
        - Пользователь авторизован
        - Добавлена машина к аккаунту ("Добавить машину" - Ввести госномер или VIN - Тап на "Добавить" - Тап на "Верно, это моя машина")
        - Открыты настройки навигатора (Меню - "Настройки"/Шестерёнка в шапке)
    - do: Тап на "Уведомления"
    - assert: |
        - Открывается экран "Темы пуш-оповещений"
        - **Присутствует** свитчер "Окончание ОСАГО"
        - По умолчанию ВКЛ
    - do: Тап на свитчер "Окончание ОСАГО", **если он в положении ВКЛ**
    - assert: Свитчер в положении ВЫКЛ
    - do: Выключить эксперимент на свитчер в карточке аво (Developer settings - Ya.Auto - OSAGO expired reminders enabled - Off) и перезапустить приложение
    - do: |
        - Тап Меню Нави
        - Тап на "Настройки"/Шестерёнка в шапке
        - Тап "Уведомления"
    - assert: |
        - Открывается экран “Темы пуш-оповещений”
        - **Отсутствует** свитчер “Окончание ОСАГО”
    - do: Включить эксперимент на свитчер в карточке аво (Developer settings - Ya.Auto - OSAGO expired reminders enabled - On) и перезапустить приложени
    - do: |
        - Тап Меню Нави
        - Тап на “Настройки”/Шестерёнка в шапке
        - Тап "Уведомления"
    - assert: |
        - Открывается экран “Темы пуш-оповещений”
        - **Присутствует** свитчер “Окончание ОСАГО”
        - Свитчер в положении ВКЛ

    - platforms:
      - ios
      - android
    - tags:
        - assessors
    - testing:
      - acceptance_navi