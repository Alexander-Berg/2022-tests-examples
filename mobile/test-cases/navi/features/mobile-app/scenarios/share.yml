components: share
testing:
  - regress

specs:



  Шаринг места через Whatsapp:
    - description: Навигатор научился перехватывать ссылки Whatsapp с местоположением
    - info: |
        - Установить Whatsapp и авторизоваться в нем
        - С другого устройства отправить на тестовый девайс местоположение ( "Прикрепить" > "Место" > "Отпарвить ваше местоположение")
        - На девайсе не установлен Навигатор
    - do: В Whatsapp тап по переданному местоположению
    - assert: |
        Если откроется выбор приложения выбрать google maps и тап всегда использовать навигатор
        Если откроется google maps то ничего делать не нужно
    - do: Установить и запустить навигатор , пройти все интроскрины
    - assert: Отображается экран "Карта"
    - do: |
        Выгрузить навигатор
        Перейти к Whatsapp
        Тап по расшаренному местоположению
    - assert: Открывается поп-ап выбора Навигатор/Google maps / другие приложения
    - do: Выбрать Навигатор из списка приложений
    - assert: |
        - Происходит переход в Навигатор на экран карта
        - На карте отображается пин в той точке, которое было расшарено через Whatsapp
    - do: |
        Повторить переход в Навигатор при разных состояниях приложения:
        - Навигатор выгружен
        - Навигатор свернут
    - assert: |
        При каждом из вариантов:
        - Происходит переход в Навигатор на экран карта
        - На карте отображается пин в той точке, которое было расшарено через Whatsapp

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Проверка отсутствия фичи поделиться маршрутом:
    - description: |
        **На ГУ не актуальна функция поделиться точкой из Навигатора в другие приложения - ее там быть не должно**
        Начиная с М16 появилась возможность делиться точкой из Навигатора в другие программы:
        - через кнопку Поделиться в Лонг-тап меню https://yadi.sk/i/1ruTurfp3Nvxqs
        - через кнопку Поделиться в карточке организации https://yadi.sk/i/j7AV-iBE3NvxtN
    - do: |
        - Перейти на экран карты
        - Сделать лонг тап по карте
    - assert: |
        - Поверх карты отобразилось лонг тап меню
        - В лонг тап меню нет кнопки "Поделиться"
    - do: Перейти в карточку организации
    - assert: В карточки организации нет кнопки "Поделиться"

    - platforms:
      - motrex
      - autochip
      - geely
      - vaz
      - carsharing_t3
      - nissan
      - t3am
    - testing:
        - acceptance_navi


  Открытие ссылок вида goo.gl/maps/HASH:
    - info: |
        - Подключить девайс к компьютеру
        - Вызвать командную строку
        - Ввести команду `adb shell am start -a android.intent.action.VIEW -c android.intent.category.BROWSABLE -d "https://navigator.maps.yandex.ru/"`
        Если появляется выбор приложения для запуска, то выбираем Навигатор (бета версию). Если есть кнопка "Всегда", то выбираем её, а не "Только сейчас".
    - do: |
        - Зайти в мобильную версию Google Maps.
        - Выбрать любое место (например тап по карте).
        - "Поделиться" ~> копировать необходимую ссылку.
        - Открыть эту ссылку на телефоне (например в WhatsApp или Telegram).
    - assert: |
        - При открытии этой ссылки появляется поп-ап выбора приложения.
        - При выборе Навигатора, он открывается и показывается местоположение пользователя
    - do: |
        - Зайти в десктоп-версию Google Maps. https://www.google.ru/maps/
        - Выбрать любое место (например тап по карте).
        - “Поделиться” ~> копировать необходимую ссылку.
        - Переслать ссылку через любой мессенджер
        - Открыть эту ссылку на телефоне (например в WhatsApp или Telegram).
    - assert: |
        При открытии этой ссылки появляется поп-ап выбора приложения.
        При выборе Навигатора, он открывается и показывается именно та точка, которой делились.

    - platforms:
        - android
    - tags:
        - assessors