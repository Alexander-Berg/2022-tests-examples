components: more_fast_route
testing:
  - regress

specs:
  Оповещение о ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить отображение уведомления о Более Быстром Маршруте (Далее ББМ)
        **Особенности:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный маршрут из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Тап на "Посмотреть" в плашке ББМ
    - assert: |
        - Происходит переход на экран обзора
        - Отображается наиболее быстрый маршрут до конечной точки

    - platforms:
      - motrex
      - autochip
      - geely
      - renault
      - carsharing_t3
      - ios
      - android
      - vaz
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Оповещение о ББМ с отключенным альтернативами:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить отображение уведомления о Более Быстром Маршруте (Далее ББМ)
        **Особенности:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - При отключенных альтернативных маршрутах появление ББМ это ок
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Выкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация “Найден более быстрый маршрут”

    - platforms:
        - motrex
        - autochip
        - geely
        - renault
        - carsharing_t3
        - ios
        - android
        - vaz
        - nissan
        - t3am
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Закрыть оповещение о ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить скрытие отображения уведомления о Более Быстром Маршруте (Далее ББМ)
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Тап на кнопку отмены
    - assert: |
        - Плашка ББМ закрывается
        - В таббаре на кнопке "Обзор" отображается время "-n минут"
    - do: Тап на кнопку "Обзор" в тапбаре
    - assert: |
        - Происходит переход на экран обзора
        - Выбран текущий маршрут
        - Среди маршрутов отображается наиболее быстрый маршрут до конечной точки

    - platforms:
        - motrex
        - autochip
        - geely
        - renault
        - carsharing_t3
        - ios
        - android
        - vaz
        - nissan
        - t3am
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Оповещение о ББМ в фоне:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить отображение уведомления о Более Быстром Маршруте (Далее ББМ) в фоне
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента::
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту и свернуть приложение в фон
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: Спустя некоторое время произносится аннотация “Найден более быстрый маршрут”
    - do: Развернуть Навигатор
    - assert: Над таббаром отображается плашка ББМ

    - platforms:
        - motrex
        - autochip
        - geely
        - renault
        - carsharing_t3
        - ios
        - android
        - vaz
        - nissan
        - t3am
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Автоматическое скрытие оповещения о ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить автоматическое скрытие уведомления о Более Быстром Маршруте (Далее ББМ)
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами.
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Не взаимодействовать с картой и плашкой ББМ более 1 минуты
    - assert: Плашка ББМ автоматически скрывается

    - platforms:
      - motrex
      - autochip
      - geely
      - renault
      - carsharing_t3
      - ios
      - android
      - vaz
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Закрытие свайпом вниз оповещения о ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить свайп - вариант скрытия уведомления о Более Быстром Маршруте (Далее ББМ)
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Свайпнуть плашку ББМ вниз
    - assert: |
        - Плашка ББМ закрывается
        - В таббаре на кнопке "Обзор" отображается время "-n минут"
    - do: Тап на кнопку "Обзор" в тапбаре
    - assert: |
        - Происходит переход на экран обзора
        - Отображается наиболее быстрый маршрут до конечной точки

    - platforms:
      - motrex
      - autochip
      - geely
      - renault
      - carsharing_t3
      - ios
      - android
      - vaz
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Игнорирование тапа плашкой ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить, плашка о Более Быстром Маршруте (Далее ББМ) не скрывается при тапе по карте.
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Тап по любой области на карте
    - assert: Плашка ББМ не скрывается

    - platforms:
        - motrex
        - autochip
        - geely
        - renault
        - carsharing_t3
        - ios
        - android
        - vaz
        - nissan
        - t3am
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Смена ориентации с плашкой ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить отображение уведомления о Более Быстром Маршруте (Далее ББМ) при смене ориентации девайса.
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Девайс в портретной ориентации
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
    - do: Сменить ориентацию девайса на лендскейп
    - assert: |
        - При смене ориентации UI плашки не ломается, постраивается под ориентацию
        - Сохраняется порядок плашек, название улицы или длинна пробки, ниже ЕТА и под ней плашка ББМ
        - Плашка ББМ одинаковой длины с плашкой ЕТА

    - platforms:
      - motrex
      - autochip
      - geely
      - renault
      - carsharing_t3
      - ios
      - android
      - vaz
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit


  Проверка корректной смены темы в плашке ББМ:
    - info: |
        Включить `Dev.Settings -> Misc -> Unlimit intents enabled -> On`
        Перезагрузить приложение
    - description: |
        **Цель:** Проверить отображение уведомления о Более Быстром Маршруте (Далее ББМ) при смене темы день/ночь
        **Особенности ББМ:**
        - Плашка ББМ не отображается, если до развилки на альтернативный маршрут менее 1 км или больше 10ти км
        - В тапбаре информация о ББМ отображается, если вариант быстрее на 2 и более минут
        - Меню - Настройки - Карта и интерфейс - Альтернативные маршруты - Вкл
        Developer Settings -> Misc -> Fast day & night switching - On
        Перезапустить навигатор
        Девайс в портретной ориентации
        Построить маршрут с помощью интента:
        - [collapsed-image](https://jing.yandex-team.ru/files/fedonina71/ББМ.png){title=QR-код}
    - do: |
        - Выбрать самый длительный вариант из предложенных
        - Тап Поехали
        - Запустить симуляцию движения по маршруту
        - Дождаться проезда развилки с альтернативными маршрутами.
    - assert: |
        - Через несколько секунд над таббаром появляется плашка ББМ
        - Звучит аннотация "Найден более быстрый маршрут"
        - Если ББМ появился в момент, когда навигатор находился в темной теме, то артефактов дневной в плашке ББМ не наблюдаем.
        - Если ББМ появился в момент, когда навигатор находился в светлой теме, то артефактов ночной темы в плашке ББМ не наблюдаем.
    - do: Не закрывая плашку ББМ дождаться смены темы на противоположную от той, в которой появилась плашка ББМ
    - assert: |
        - Плашка подстраивается под новую тему.
        - Артефактов противоположной темы не наблюдаем.

    - platforms:
      - motrex
      - autochip
      - geely
      - renault
      - carsharing_t3
      - ios
      - android
      - vaz
      - nissan
      - t3am
    - tags:
      - assessors
      - mapkit_ready
    - testing:
      - acceptance_navi
    - integration_run:
      - mapkit
