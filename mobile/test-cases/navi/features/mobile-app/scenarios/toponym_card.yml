components: toponym_card
testing:
  - regress

specs:
  Вызов карточки топонима с помощью лонгтап меню:
    - do: Лонгтап по карте
    - assert: |
        Отображается лонгтап меню.
        Меню содержит кнопки:
          - Сюда
          - Через
          - Отсюда
          - Сбросить
          - Что здесь?
          - Установить
          - В "Мои места"
          - Поделиться
    - do: Тап по Что здесь?
    - assert: |
        Отображается миникарточка топонима.
        В миникарточке отображаются:
          - Адрес
          - Расстояние до точки
          - Координаты и три синих точки
          - Action-бар, прибитый к нижнему краю, с кнопками: Маршрут, Поделиться, Сохранить в закладки.
    - do: Тап по заголовку миникарточки
    - assert: |
        Отображается полная карточка топонима.
        Наверху карточки отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
        Внизу карточки отображаются:
          - Action-кнопки (Маршрут, Отсюда, Поделиться, В закладки)

    - platforms:
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Вызов карточки топонима через поиск:
    - do: Открыть поиск и ввести запрос с существующим адресом. Например, ул. Льва Толстого
    - assert: Отображается саджесты по данному запросу
    - do: Тап по саджесту ул. Льва Толстого в Москве.
    - assert: |
        Отображается мини карточка топонима.
        Наверху карточки отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
    - do: Свернуть миникарточку
    - assert: |
        Отображается мини карточка топонима.
        В миникарточке отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
          - Action-кнопки (Маршрут, Поделиться и Сохранить в закладки), прибитые к нижнему краю

    - platforms:
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Копирование адреса из карточки топонима:
    - do: Открыть мини-карточка топонима( Лонгтап по карте -> Что здесь?)
    - assert: |
        Отображается мини карточка топонима.
        В миникарточке отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
          - Action-кнопки (Маршрут, Поделиться и Сохранить в закладки), прибитые к нижнему краю
    - do: Лонгтап по заголовку миникарточки
    - assert: Появляется всплывающее чёрное облако Копировать | Поделиться | Копировать координаты
    - do: Тап по Копировать
    - assert: В буфер обмена скопирован адрес подстрочника. Облако исчезает
    - do: Вставить скопированную информацию, например, в заметки
    - assert: В заметки вставлен скопированный адрес топонима Адрес не отличается от того, что указан в карточке топонима

    - platforms:
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Копирование Координат в мини-карточке топонима:
    - do: Открыть мини-карточку топонима( Лонгтап по карте -> Что здесь?)
    - assert: |
        Отображается мини карточка топонима.
        В миникарточке отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
          - Action-кнопки (Маршрут, Поделиться и Сохранить в закладки), прибитые к нижнему краю
    - do: Лонгтап по заголовку миникарточки
    - assert: Появляется всплывающее чёрное облако Копировать | Копировать координаты
    - do: Тап по Копировать координаты
    - assert: |
        В буфер обмена скопированы координаты.
        Появляется уведомление "Коордианты скопированы"
    - do: Вставить скопированную информацию, например, в заметки
    - assert: В заметки вставлен скопированный адрес топонима Адрес не отличается от того, что указан в карточке топонима
    - do: Вернуться в приложение и тап по координатам
    - assert: |
        В буфер обмена скопированы координаты.
        Появляется уведомление "Коордианты скопированы"
    - do: Вставить скопированную информацию, например, в заметки
    - assert: В заметки вставлен скопированный адрес топонима Адрес не отличается от того, что указан в карточке топонима

    - platforms:
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Копирование Координат в полной-карточке топонима:
    - do: Открыть мини-карточку топонима( Лонгтап по карте -> Что здесь?)
    - assert: |
        Отображается мини карточка топонима.
        В миникарточке отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
          - Action-кнопки (Маршрут, Поделиться и Сохранить в закладки), прибитые к нижнему краю
    - do: Расскрыть карточку до полной
    - assert: |
        Отображается полная карточка топонима.
        Наверху карточки отображаются:
          - Адрес
          - Координаты
          - Расстояние до точки
        В табе "Обзор отображаются:
          - Координаты
          - Кнопка "Добавить объект"
          - Кнопка "Исправить неточность"
          - Если у организации есть фото, то присутствует таб "Фото"
          - Action-кнопки отображаются у нижнего края экрана (Маршрут, Отсюда, Поделиться и Сохранить в закладки)
    - do: Тап по координатам в табе "Обзор"
    - assert: |
        В буфер обмена скопированы координаты.
        Появляется уведомление "Коордианты скопированы"
    - do: Вставить скопированную информацию, например, в заметки
    - assert: В заметки вставлен скопированный адрес топонима Адрес не отличается от того, что указан в карточке топонима

    - platforms:
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Отсутствие блока Ближайшие станции метро в карточках объектов, которые далеки от метро:
    - info: |
        Что бы открыть карточку топонима нужно выполнить лонг-тап по карте и тап "Что здесь?"
    - do: Открыть карточку топонима около метро и развернуть ее
    - assert: |
        Открыта полная карточка топонима
        (Только Android)Присутствует блок Ближайшие станции метро
        (Только Android)Список станций метро по умолчанию не видно
    - do: Открыть карточку топонима далеко от всех станций метро и развернуть ее
    - assert: |
        Открыта полная карточка топонима
        Отсутствует блок Ближайшие станции метро

    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Кнопка построения маршрута в миникарточке топонима:
    - info: |
        Что бы открыть карточку топонима нужно выполнить лонг-тап по карте и тап "Что здесь?"
    - do: Открыть карточку топонима на карте
    - assert: |
        Открыта мини-карточка топонима
        Присутствует кнопка Маршрут
    - do: Открыть полную карточку топонима
    - assert: |
        Открыта полная карточка объекта
        Присутствует кнопка Маршрут

    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Карточка топонима:
    - do: Лонг-тап по карте и тап "Что здесь?"
    - assert: Открыта мини-карточка топонима
    - do: Тап на карточку топонима
    - assert: |
        Открыта полная карточка топонима
        Если в здании есть организации, присутствует блок Организации в здании/рядом
    - do: На iOS тап на Организации в здании/рядом
    - assert: |
        Открыт экран Организации в здании
        Отображается список организаций
    - do: На iOS тап на таб Обзор
    - assert: |
        Открыт экран Обзор
        Открыта полная карточка топонима
        Сохранился проскролл

    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors

  Вызов карточки топонима с помощью лонгтап меню (карточка организации):
    - info: Открыт главный экран приложения
    - do: Лонгтап по карте
    - assert: |
        Отображается лонгтап меню.
        Меню содержит кнопки:
          - Сюда
          - Через
          - Отсюда
          - Сбросить
          - Что здесь?
          - Установить
          - В "Мои места"
          - Поделиться
    - do: Тап по Что здесь?
    - assert: |
        Отображается миникарточка топонима. (на iPad откроется полная карточка)
        В миникарточке отображаются:
          - Адрес
          - Расстояние до точки
          - Координаты и три синих точки
          - Action-бар, прибитый к нижнему краю, с кнопками: Маршрут, Поделиться, Сохранить в закладки.
          Если топоним является районом, поселком, городом и т.д., то геометрия топонима будет подсвечена красным цветом.
          Пин Что здесь отображается в месте лонгтапа.
          Если топоним является парком, заповедником, стадионом (большим топонимом), то геометрия топонима будет подсвечена зеленым цветом.
          Если топоним является улицей, трассой и т.д., то геометрия топонима будет подсвечена коричневым цветом.
          Если топоним здание, то геометрия топонима не подсвечена.
    - do: Тап по заголовку миникарточки
    - assert: |
        Карточка раскрылась в полную.
        В карточке присутствуют кнопки:
          - Координаты
          - Экшен-кнопки отображаются у нижнего края экрана и никуда не съехали
        (Только Android)В карточке присутствует блок Как добраться содержащий в себе
          - Ближайшие станции метро(если есть)
          - Показать парковки(если есть)
        - Фото, если есть

    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Вызов карточки топонима через поиск (карточка организации):
    - info: Открыта форма поиска
    - do: Ввести запрос с существующим адресом. Например, ул. Льва Толстого, 16
    - assert: Отображается саджесты по данному запросу
    - do: Тап по саджесту ул. Льва Толстого в Москве.
    - assert: |
        Отображается мини карточка топонима.
        В миникарточке отображаются:
          - Адрес
          - координаты
          - Расстояние до точки
          - Экшен-кнопки (Маршрут, Поделиться и Сохранить в закладки), прибитые к нижнему краю
        Топоним отображается в центре экрана.
        Топоним выделен пином
    - do: Тап по миникарточке
    - assert: |
        Отображается полная карточка топонима.


    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Кнопки действий в карточке топонима:
    - do: Открыть карточку любого топонима
    - assert: |
        Открыта миникарточка топонима.
        Внизу экрана отображаются экшен-кнопки:
          - 'Маршрут' синего цвета
          - 'Поделиться'
          - 'Сохранить в закладки'
    - do: Тап по миникарточке
    - assert: |
        Открыта полная карточка организации.
        Экшен-кнопки по прежнему отображаются внизу экрана и никуда не съехали
    - do: Свайп вверх по карточке
    - assert: |
        Карточка прокручивается.
        Экшен-кнопки по прежнему отображаются внизу экрана и никуда не съехали

    - platforms:
        - ios
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Копирование адреса из карточки топонима (карточка организации):
    - info: Открыта мини-карточка топонима
    - do: Лонгтап по заголовку миникарточки
    - assert: Появляется всплывающее чёрное облако Копировать | Копировать координаты
    - do: Тап по Копировать
    - assert: В буфер обмена скопирован адрес топонима Облако исчезает
    - do: Вставить скопированную информацию, например, в заметки
    - assert: В заметки вставлен скопированный адрес топонима Адрес не отличается от того, что указан в карточке топонима

    - platforms:
        - ios
    - integration_run:
        - map_search
    - tags:
        - assessors


  Отображение кнопки Координаты в полной карточке топонима:
    - do: Тап по любому зданию и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Открыть полную карточку ММП
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Вызвать лонгтап меню в произвольном месте, тап Что здесь? и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты
    - do: Произвести поиск произвольного топонима и раскрыть полную карточку
    - assert: |
        Отображается полная карточка топонима.
        В карточке присутствует тапабельная кнопка Координаты

    - platforms:
        - ios
    - integration_run:
        - map_search
    - tags:
        - assessors


  Проверка отображения блока Как добраться в карточке топонима:
    - info: |
        Отключен эксперимент `taxi_in_directions`
        Отображается мини карточка топонима около метро
    - do: Развернуть карточку топонима
    - assert: |
        Отображается блок Как добраться, в котором присутствуют:
        Ближайшая станция метро
        Ближайшая остановка ОТ
    - do: Тап на стрелку с расхлопом у ближайшей станции метро
    - assert: Список ближайших станций метро развернулся
    - do: Тап на стрелку с расхлопом у ближайшей станции метро
    - assert: Список ближайших станций метро свернулся

    - platforms:
        - android
    - integration_run:
        - map_search
    - tags:
        - assessors


  Блок подъездов:
    - info: Подьезды отображаются по адресам - Фрунзенская набережная, 26; Фрунзенская набережная, 32, Ходынский бульвар 15
    - do: |
       Осуществить поиск по одному из указанных адресов
       Открыть карточку топонима - здание с подъездами
    - assert: В карточке присутствует кнопка "К подъезду"
    - do: Тап по кнопке "К подъезду"
    - assert: Открывается список с номерами подъездов в здании
    - do: Тап по номеру подъезда
    - assert: |
        Переход к окну обзора маршрута
        Маршрут построен до выбранного подъезда
    - do: Тап "Отмена" в окне обзора
    - assert: |
        Поисковая выдача сброшена
        Переход на экран карты

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Блок подъездов через "что здесь":
    - info: Подьезды отображаются по адресам - Фрунзенская набережная, 26; Фрунзенская набережная, 32, Ходынский бульвар 15
    - do: |
        Лонгтап по карте на здании с подъездами
        Тап "Что здесь"
    - assert: |
        В карточке под адресом присутствует кнопка "К подъезду"
    - do: |
        Тап по кнопке "К подъезду"
        Тап по номеру подъезда
        Тап "поехали" в окне обзора
    - assert: Началось ведение по маршруту до выбранного подъезда

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Анимация блока подъездов в горизонтальной ориентации:
    - info: |
        - Подьезды отображаются по адресам - Ходынский бульвар 15
        - Альбомная ориентация
    - do: Открыть карточку топонима - здание с подъездами
    - assert: В карточке под адресом присутствует кнопка "К подъезду"
    - do: Тап по кнопке "К подъезду"
    - assert: Открывается список с номерами подъездов в здании
    - do: Скролить карусель с подъездами вверх/вних
    - assert: Анимация плавная, скролл работает

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Анимациия блока подъездов в вертикальной ориентации:
    - info: |
         Для проверки использовать адрес - Ходынский бульвар 15
         Вертикальная ориентация девайса
    - do: Открыть карточку топонима - здание с подъездами
    - assert: В карточке под адресом присутствует кнопка "К подъезду"
    - do: Тап по кнопке "К подъезду"
    - assert: Открывается список с номерами подъездов в здании
    - do: Скролить карусель с подъездами вверх/вниз
    - assert: Анимация плавная, скролл работает

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Отображение фотогалереи в табе "Фото" в карточке топонима:
    - info: Девайс в вертикальной ориентации
    - do: Открыть карточку топонима, в которой больше 3-х фото (например,город Москва)
    - assert: Открыта мини-карточка топонима
    - do: Открыть полную карточку топонима
    - assert: |
        Открылась полная карточка топонима
        Открыт таб "Обзор"
        В табе "Обзор" отображается не больше 3-х фото
    - do: Тап на таб  "Фото"
    - assert: |
        Открылся таб "Фото"
        Отображается больше 3-х фотографий

    - platforms:
        - ios
    - tags:
        - assessors


  Совпадение длины пути до топонима указанной в карточке с длинной пути указанной на экране выбора маршрута:
    - preconditions: Отображается главный экран приложения
    - do: Лонг-тап по карте в области любого здания
    - do: Тап на Что здесь?
    - assert: |
        Отображается мини-карточка топонима
        Присутствует информация о длине пути до топонима
    - do: Тап на action-кнопку Маршрут
    - assert: |
        Отображается экран выбора маршрута
        Длина пути указанная в карточке маршрута соответствует указанной в карточке топонима

    - platforms:
        - android
        - ios
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Отображение расстояния по прямой в карточке топонима, если не пришли данные о длине маршурта:
    - info: |
        При отсутствии информации о длине маршрута до точки, в карточке будет отображаться информация о расстоянии по прямой
    - preconditions: Отображается главный экран приложения
    - do: |
        Построить маршрут, используя интент:
        [collapsed-image](https://jing.yandex-team.ru/files/linakolpakova/no_route.png){title=QR}

        `yandexnavi://build_route_on_map/?lat_to=58.401698&lon_to=38.530076`
    - assert: |
        Маршрут не построен
    - do: Выполнить поиск по координатам `58.401698,38.530076`
    - assert: |
        Отображается мини-карточка топонима
        Присутствует информация о расстоянии по прямой до топонима

    - platforms:
        - android
    - tags:
        - assessors


  Загрузка данных о длине пути в карточке топонима:
    - info: |
        Изменить режим сети можно в настройках мобильных сетей на девайсе
    - preconditions: |
        Режим сети 2G
        Отображается главный экран приложения
    - do: Лонг-тап по карте в области любого здания
    - do: Тап на Что здесь?
    - assert: |
        Отображается мини-карточка топонима
        Происходит загрузка данных о длине и времени пути до топонима
        На месте незагруженных данных отображается шиммер
    - do: Дождаться загрузки данных
    - assert: |
        Отображается информация о длине и времени пути до топонима
        Шиммер не отображается

    - platforms:
        - android
        - ios
    - tags:
        - assessors
