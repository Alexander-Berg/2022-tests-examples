components: new_start_menu
testing:
  - regress

specs:
  Включение эксперимента на показ новой шапки меню:
    - description: |
        Новая шапка работает только в новом меню (плиткой) и не должна работать в старом меню (списком). В данном кейсе проверяется появление новой шапки меню в Меню Навигатора при включении эксперимента: Настройки -> Developer settings -> Misc -> Show menu header with car info -> On - после чего перезапустить приложение
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - Пользователь находится на главном экране Навигатора (экран с картой)
    - do: Открыть Меню Навигатора 
    - assert: |
        - Открылось новое Меню Навигатора
        - Шапка меню была изменена на новую: 
            -- Иконка значка пользователя смещена влево
            -- Имя пользователя отсутствует
            -- По центру шапки расположена кнопка "Добавить машину"(если у пользователя нет добавленных машин) или марка-модель добавленного авто (если у пользователя есть одна или более добавленных машин)
            -- Иконка Настроек переехала в правую часть шапки
            -- Лента с машинами, которая располагается под логином пользователя, пропадает из Меню
    - do: Выключить показ нового меню. Для этого перейти в Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> OFF и перезапустить приложение
    - assert: Показан главный экран Навигатора
    - do: Тапн Меню Нави
    - assert: |
        - Открылось старое Меню Навигатора (списком)
        - Шапка меню соответствует старой версии меню (вверху - блок залогина, ниже кнопка авто или добавления авто, ниже - настройки, баннер, список сервисов и т.д.)
    - do: Включить показ нового Меню. Для этого перейти в Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение
    - assert: Показан главный экран Навигатора
    - do: Тап Меню Нави
    - assert: |
        - Открылось новое Меню Нави
        - Шапка Меню сменилась на новую
    - do: Выключить показ новой шапки Меню. Для этого необходимо перейти в Настройки -> Developer settings -> Misc -> Show menu header with car info -> OFF и перезапустить приложение
    - assert: Показан главный экран Навигатора
    - do: Тап Меню Нави
    - assert: |
        - Показана старая шапка нового Меню Навигатора:
            -- Иконка настроек располагается в левой части шапки меню
            -- Имя пользователя с его иконкой профиля располагается по центру шапки
            -- Под логином располагается карусель машин

    - tags:
        - assessors
    - platforms:
      - ios
      - android


  Добавление нового авто в аккаунт:
    - description: Новая шапка работает только в новом меню (плиткой) и не должна работать в старом меню (списком).
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - У пользователя нет добавленных авто
        - Пользователь находится в меню навигатора
    - do: Тап в "Добавить машину"
    - assert: Открылся экран поиска авто по вин/грз
    - do: Ввести валидный ВИН/ГРЗ и добавить авто (Например т 999 ас 150)
    - assert: Показана карточка добавленного авто
    - do: Выйти в меню навигатора тапнув "Назад"
    - assert: |
        - Показано меню навигатора
        - Вместо кнопки "Добавить машину" - записана марка-модель добавленного авто
        - Справа от марки-модели авто присутствует стрелочка вниз 
    - do: Тап по марке-модели авто 
    - assert: Открылась карточка выбранного авто

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Добавление нескольких авто в аккаунт:
    - description: Новая шапка работает только в новом меню (плиткой) и не должна работать в старом меню (списком).
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - У пользователя добавлена одна машина
        - Пользователь находится в Меню Навигатора
    - do: Тап по стрелочке вниз, справа от марки-модели добавленного авто
    - assert: |
        - Открылся список добавленных авто:
            -- В списке присутствуют добавленные машины 
            -- Под списком машин располагается кнопки "Добавить машину" и "Отмена"
    - do: Тап по "Добавить машину"
    - assert: Открылся экран поиска по ВИН/ГРЗ
    - do: Выполнить поиск авто по ВИН/ГРЗ (например Т 777 ТТ 77) и добавить машину в аккаунт
    - assert: Открылась карточка добавленного авто 
    - do: Выйти в меню навигатора тапнув "Назад"
    - assert: Открылось меню навигатора
    - do: Тап по стрелочке вниз
    - assert: |
        - Отобразился список из добавленных авто 
        - В списке присутствуют 2-е добавленные машины 
        - Кнопка "Добавить машину"
    - do: |
        -- Для Android: Тап по пустому пространству
        -- Для iOS: Тап по кнопке “Отмена”
    - assert: |
        - Список авто закрылся
        - Показано меню навигатора

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Выбор машины из списка добавленных авто:
    - description: Новая шапка работает только в новом меню и не должно работать в старом меню.
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - У пользователя добавлено несколько машин (2 и более)
        - Пользователь находится в меню навигатора
    - do: Тап по стрелочке вниз, справа от марки-модели добавленного авто
    - assert: |
        - Открылся список добавленных авто:
            -- В списке присутствуют добавленные машины 
            -- Под списком машин располагается кнопки "Добавить машину" и "Отмена"
    - do: Тап по одной из добавленных авто
    - assert: |
        - Закрылся список добавленных машин
        - Открылось меню навигатора
        - В шапке отобразилась марка-модель выбранной машины
    - do: Тап по стрелочке "Вниз", в шапке навигатора
    - assert: |
        - Открылся список добавленных авто
        - Порядок в списке не изменился
    - do: Тап по другой машине отличной от машины в шаге 2
    - assert: |
        - Закрылся список добавленных машин
        - Открылось меню навигатора
        - В шапке отобразилась марка-модель выбранной машины
    - do: Тап по стрелочке вниз
    - assert: |
        - Отобразился список добавленных авто 
        - Порядок в списке не изменился

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Выбор основной машины для ios:
    - description: Новая шапка работает только в новом меню и не должно работать в старом меню.
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - У пользователя добавлено несколько машин (2 и более)
        - Пользователь находится в Меню Навигатора
    - do: Тап по стрелочке "вниз" справа от марки-модели авто
    - assert: |
        - Открылся список добавленных авто
         
    - do: Запомнить расположение машин в списке и тап **НЕ ПО ПЕРВОЙ** машине в списке (отсчет начинается сверху)
    - assert: |
        - Список добавленных авто закрылся
        - Открылось меню навигатора
        - Марка-модель сменилась на выбранное авто из списка
    - do: Тап в шапке меню по марке-модели выбранного авто
    - assert: Открылась карточка авто
    - do: Тап по свитчеру "Основная машина"
    - assert: Свитчер переместился в положение ВКЛ
    - do: Закрыть карточку авто и открыть список добавленных авто. Для этого (в карточке авто тап "Назад", затем тап по стрелочке "вниз" справа от марки-модели авто)
    - assert: В списке добавленных авто - основная машина стоит на первом месте, остальные в порядке добавления
    - do: |
        Выключить свитчер основной машины, для текущего авто.
        Для этого:
        -  в списке добавленных авто тап "Отмена" -> "Марка-модель" добавленного авто -> выключить свитчер "Основная машина" в карточке авто -> "Назад" -> стрелочку "Вниз"
    - assert: |
        - Показан список добавленных авто
        - Машина, которая была основной (в шаге 2), показана в списке не на первом месте

    - platforms:
      - ios
    - tags:
        - assessors


  Добавление машины из Денег:
    - description: Новая шапка работает только в новом меню (плиткой) и не должна работать в старом меню (списком).
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить: Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить: Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение
        - У пользователя добавлено несколько машин
        - Пользователь находится в Меню Навигатора
    - do: Тап по стрелочке "вниз" справа от марки-модели авто
    - assert: |
        - Открылся список добавленных авто
        - В списке присутствуют только машины, добавленные пользователем
    - do: Добавить машину из Денег. Для этого в настройках тап "Developer settings -> Ya.Auto -> Insert Ya.money car"
    - assert: Покажется toast, сообщающий, что машина добавлена
    - do: В меню навигатора, в шапке, тап по стрелочке "вниз"
    - assert: |
        - Открылся список добавленных авто
        - В списке отсутствует добавленная машина из денег
    - do: Тап "Отмена" и разлогиниться в навигаторе
    - assert: |
        - Показано меню навигатора
        - В шапке отсутствует иконка пользователя 
        - Вместо добавленных авто - кнопка "Войти"
    - do: Авторизоваться в навигаторе тапнув по кнопке "Войти"
    - assert: |
        - Пользователь авторизовался
        - Слева в шапке показана иконка пользователя 
        - по центру шапки, в зависимости от того добавлено ли авто в тот аккаунт, которым логинимся в шаге 5 - показана либо кнопка "Добавить машину", либо марка-модель добавленной машины. Машина из Денег НЕ показана

    - platforms:
      - ios
      - android
    - tags:
        - assessors


  Выбор основной машины для android:
    - description: Новая шапка работает только в новом меню и не должно работать в старом меню.
    - info: |
        - Пользователь авторизован
        - Пользователь включил показ нового меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show main menu as ribbon -> ON и перезапустить приложение)
        - Пользователь включил показ новой шапки меню. Для этого необходимо включить параметр (Настройки -> Developer settings -> Misc -> Show menu header with car info -> On и перезапустить приложение)
        - У пользователя добавлено несколько машин (2 и более)
        - Пользователь находится в Меню Навигатора
    - do: Тап по стрелочке "вниз" справа от марки-модели авто
    - assert: |
        - Открылся список добавленных авто
         
    - do: Тап по НЕ первой машине в списке
    - assert: Открылась карточка авто
    - do: Тап по свитчеру "Основная машина"
    - assert: Свитчер переместился в положение ВКЛ
    - do: Закрыть карточку авто и открыть список добавленных авто. Для этого (в карточке авто тап "Назад", затем тап по стрелочке "вниз" справа от марки-модели авто)
    - assert: В списке добавленных авто - основная машина стоит на первом месте, остальные в порядке добавления
    - do: |
        Выключить свитчер основной машины, для текущего авто.
        Для этого:
        -  в списке добавленных авто тап "Отмена" -> "Марка-модель" добавленного авто -> выключить свитчер "Основная машина" в карточке авто -> "Назад" -> стрелочку "Вниз"
    - assert: |
        - Показан список добавленных авто
        - Машина, которая была основной (в шаге 2), показана в списке не на первом месте

    - platforms:
      - android
    - tags:
        - assessors