components: cashe
testing:
  - regress

specs:
  Offline Cache - Интерфейс:
    - do: Открыть Меню
    - assert: В Меню есть пункт "Загрузка карт" с иконкой молнии
    - do: Тап "Загрузка карт" в Меню
    - assert: |
        - Открывается экран загрузки карт
        - Есть кнопка закрытия окна
        - Название формы «Загрузка карт», ниже текстовое поле ввода «Поиск по городам»
        - Ниже отображается предложение скачать КЭШ ближайшего региона, исходя из текущего местоположения. Название региона, города, входящие в этот регион, синий кружок со стрелкой внутри, Надпись «Скачать», размер в МБ, дата последнего обновления
        - Если есть скаченые кеши, то будет отображаться список

    - platforms:
        - geely
        - ios
        - android
        - vaz
        - t3am
        - nissan
        - motrex
    - tags:
        - assessors


  Offline Cache - Поиск:
    - do: |
        - Перейти в "Загрузка карт" в Меню
        - Активировать поле ввода поиска по городам
    - assert: |
        - Отображается группировка по странам: Беларусь, Казахстан, Россия, Турция, Украина
        - Сортировка внутри страны по алфавиту 
    - do: Ввести в текстовое поле несколько букв
    - assert: Буквы вводятся корректно
    - do: Свернуть и развернуть приложение
    - assert: Набранный текст сохраняется при разворачивании навигатора (переключении на другое приложение)
    - do: Начать вводить название любого города
    - assert: |
        - Результат выдаётся по найденным совпадениям из начала слова, по вводу последней части слова или середины саджест не срабатывает
        - При нескольких результатах очередность определяется минимальным расстоянием до текущего места пользователя
    - do: Удалить текст введеный ранее тапом по крестику в поле ввода
    - assert: |
        - Текст удаляется
        - История поиска не сохраняется 
    - do: Ввести несколько согласных подряд, например "Ннн"
    - assert: Выдается сообщение «Нет совпадений» с описанием «Попробуйте ввести название области, в которой находится ваш город»

    - platforms:
        - geely
        - nissan
        - android
        - ios
        - t3am
        - motrex
    - integration_run:
        - mapkit
    - tags:
        - mapkit_ready
        - assessors


  Offline Cache – Обновление:
    - description: |
        Функционал обновления реализован таким образом, что при сборке новых версии КЭШей напротив уже скачанных карт появляется зеленый кружок с такой же стрелочкой внутри.
        "Перед выкладкой обновлений в продакшн кэши выкладываются на data_testing для проведения
         тестирования. Тестирование происходит следующим образом:
         1. Устанавливается любая debug версия имеющая функционал смены окружения(в настройках пункт Production server (stable, testing, data_testing));
         2. Запускается навигатор;
         3. Скачивается достаточное количество КЭшей (на усмотрение тестировщика);
         4. В настройказ переходим в Production server;
         5. Меняем stable на data_testing;
         6. Перезагружаем приложение (ОБЯЗАТЕЛЬНО!);
         7. Все, можно приступать к тестированию обновлений."
    - do: Способы обновления;
    - assert: |
        a. Только по Wifi;
        b. Автоматически;
        c. Комбинации:
        1 автообновление on + wi-fi on;
        Проверить что:
        - Загрузка по wifi начинается автоматически
        - "При отключенном wifi обновление запустится но не произойдет(напротив каждого КЭШа будет стоять   0% как знак, что закачка начнется при появлении wifi)"

        2 автообновление off + wi-fi on;
        Проверить что:
        - Автоматического обновления не происходит
        - "Обновление можно запустить только в ручную нажав на зеленый кружок со стрелочкой внутри,
         напротив ранее скачанного кэша"
        - Если wifi отключен, то при тапе на кнопку обновления(зеленую) Появится сообщение "Нет доступа к Wi-Fi. Загрузка карты начнется автоматически при подключении ка Wi-Fi. Разрешить загрузку по мобильной сети? Нет/Да"
        - Нет - напротив КЭШа появится 0% как знак, что закачка начнется при появлении wifi
        - Да -инициируется закачка по моб сети
        - Если же в это время каким-то чудом пропадет и моб связь, то появится 0% как знак, что закачка начнется при появлении моб сети
        - Если попытаться обновить КЭШ при отключенном wi-fi и моб сети, то появится всплывающее сообщение "При подключении к интернету загрузка начнется автоматически", появится 0% как знак, что закачка начнется при появлении интернета

        3 автообновление on + wi-fi off;
        Проверить что:
        - Загрузка по начинается автоматически по:
        	* wi-fi
        	* моб данные
        	* wi-fi + моб данные
        - При отсутствии обеих сетей ничего не происходит, но
        	* при появлении wi-fi начинается закачка
        	* при появлении моб сети начинается закачка

        4 автообновление off + wi-fi off;
        Проверить что:
        - Автоматического обновления не происходит
        - "Обновление можно запустить только в ручную нажав на зеленый кружок со стрелочкой внутри,
        напротив ранее скачанного кэша. Запустится если включен:"
        * wi-fi
        * моб данные
        	* wi-fi + моб данные

        По завершению обновления:
        1. Пропадает зеленый значок доступного обновления
        2. Изменяется дата сборки КЭШа (проверяется по тапу на КЭШ)
        "3. Новый кэш полностью заменяет старый без изменения количества свободного дискового
         пространства на устройстве"
    - do: Уведомления о доступном обновлении;
    - assert: |
        "Если для уже скачанных карт появились обновления, на клиенте появляется
         уведомление об этом:"
        	a. В списке карт рядом с обновленным городом появляется соответствующая иконка;
        	b. //Пока не реализовано// В таббаре в приложении на кнопке «Меню» появляется бейдж с цифрой (цифра = кол-во обновленных КЭШей);
        	с. //Пока не реализовано// На пункте меню «Настройки» появляется бейдж;
    - do: |
        1. Устанавливаем навигатор(dev, release build)
        2. Скачиваем пару кэшей (запоминаем дату сборки кэшей)
        3. В настройках смотрим объем загруженного КЭШа
        4. Отключаем настройку обновления "автоматически"
        5. Выгружаем навигатор
        6. Обновляемcя на d_testing build
        7. Заходим в "Загрузка карт"
        6. Напротив каждой скачанной карты должен появится зеленый кружок, означающий что доступно обновление
        7. Жмем на кружек, тем самым обновляем кэш (даты сборки карты должны поменяться)
        8. Заходим в настройки, проверяем, что объем загруженного КЭШа не изменился
        9. Включаем режим "в самолете"
        10. Проверяем корректность отображения карты

    - platforms:
        - ios
        - android
        - nissan
        - vaz
        - t3am
        - motrex
    - tags:
        - assessors


  Offline Cache - Локализация en_EN:
    - info: На девайсе установлена локаль en_EN
    - do: Перейти Меню - Загрузка карт
    - assert: Все надписи переведены корректно, корректные переносы, шрифты, нет пустых мест
    - do: Ввести название любого города
    - assert: Названия городов и областей переведены корректно, корректные переносы, шрифты, нет пустых мест

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Локализация tr_TR:
    - info: На девайсе установлена локаль tr_TR
    - do: Перейти Меню - Загрузка карт
    - assert: Все надписи переведены корректно, корректные переносы, шрифты, нет пустых мест
    - do: Ввести название любого города
    - assert: Названия городов и областей переведены корректно, корректные переносы, шрифты, нет пустых мест

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Локализация uk_UA:
    - info: На девайсе установлена локаль uk_UA
    - do: Перейти Меню - Загрузка карт
    - assert: Все надписи переведены корректно, корректные переносы, шрифты, нет пустых мест
    - do: Ввести название любого города
    - assert: Названия городов и областей переведены корректно, корректные переносы, шрифты, нет пустых мест

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Процесс скачивания:
    - do: |
        - Перейти Меню - Загрузка карт
        - Ввести в поиск название любого горда карта которого не скачана
        - Тап по результату поиска
    - assert: |
        - Тап по результату поиска открывает возможность для скачивания, появляется синий круг со стрелочкой внутри
        - Повторный тап скрывает возможность скачивания
    - do: Тап по иконке скачивания
    - assert: |
        - Начинается процесс скачивания кэша
        - Процесс скачивания отображается в виде синего кругового прогресс бара с процентным отображением прогресса
    - do: Запустить скачивание еще нескольких кешей
    - assert: Приложение не крэшится при множественной загрузке

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Отмена скачивания:
    - do: |
        - Перейти Меню - Загрузка карт
        - Начать скачивание кеша любого города или области
        - Тап Пауза
    - assert: |
        - Скачивание кеша приостановилось
        - Отображается процесс скачивания и процент скачаных карт
        - Спустя минуту прогресс скачивания не изменился
    - do: |
        - Продолжить скачивание кеша
        - Прекратить скачивание карт тапом на красный крестик
    - assert: |
        - Скачивание карт закончилось
        - Процесс скачивания и процент скачаных карт не отображается

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Смена сети:
    - info: |
        Меню - Настройки - Карты и интерфейс - Обновление карт - Только по Wi-Fi - выкл
        На девайсе включена передача сети через Wi-Fi
    - do: |
        - Перейти Меню - Загрузка карт
        - Начать скачивание кеша любого города или области
    - assert: Началось скачивание карты
    - do: Во время скачивания изменить передачу сети на 3G
    - assert: При смене сети скачивание возобновляется автоматически
    - do: Во время скачивания изменить передачу сети на 2G
    - assert: При смене сети скачивание возобновляется автоматически
    - do: Во время скачивания изменить передачу сети на 3G
    - assert: При смене сети скачивание возобновляется автоматически
    - do: Во время скачивания изменить передачу сети на Wi-Fi
    - assert: При смене сети скачивание возобновляется автоматически

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Скачивание в фоне:
    - do: |
        - Перейти Меню - Загрузка карт
        - Начать скачивание кеша любого города или области
        - Свернуть приложение
    - assert: Навигатор свёрнут
    - do: Развернуть приложение через 2 минуты
    - assert: Процесс скачивания кеша меняется на надпись "Загружено"
    - do: |
        - Начать скачивание кеша любого города или области
        - Заблокировать девайс
        - Разблокировать через 2 минуты
    - assert: Процесс скачивания кеша меняется на надпись "Загружено"
    - do: |
        - Начать скачивание кеша любого города или области
        - Свернуть приложение
        - Открыть другое приложение
        - Вернуться в Навигатор через 2 минуты
    - assert: Процесс скачивания кеша меняется на надпись "Загружено"

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Отображение скаченных карт:
    - do: |
        - Перейти Меню - Загрузка карт
        - Скачать кеш любого города или области
    - assert: Скачанный кэш не исчезает из списка карт, доступных для скачивания
    - do: Перезайти в Загрузка карт
    - assert: Скаченный кеш отображается в списке загруженных
    - do: |
        - Отключить интернет
        - Построить любой маршрут в регионе карта которого скачена
    - assert: Маршрут построен

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit 
 

  Процесс загрузки карт: 
    - do: |
        - Начать скачивание кеша любого города или области
        - Перезайти в "Загрузка карт"
    - assert: Процесс запущенных скачиваний отображается в блоке «Загрузки»

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Хранение кешей:
    - info: Скачаны кеши любого города или области
    - do: Перейти Меню - Настройки - Сохраненные данные
    - assert: В пункте "Стереть карты" отображается объем закэшированных данных
    - do: |
        - Скачать кеш любого города или области
        - Перейти Меню - Настройки - Сохраненные данные
    - assert: Объём закачанных карт увеличился на величину скачанного нового кэша

    - platforms:
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Offline Cache - Прерывание скачивания отключением связи:
    - do: |
        - Перейти Меню - Загрузка карт
        - Начать скачивание карты любого горда карта
        - Отключить интернет в момент скачивания кеша
    - assert: Скачивание кеша прерывается
    - do: Включить интернет
    - assert: При восстановлении связи скачивание возобновляется автоматически

    - platforms:
        - android
        - ios
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit

  Offline Cache - Удаление:
    - description: Отдельный КЭШ можно удалить только во время загрузки. Путём нажатия на красный кружок с крестиком внутри, либо путем очистки всех карт в настройках
    - info: Меню - Загрузка карт - Начать скачивать любые оффлайн карты
    - do: Нажать на красный кружок с крестиком внутри во время загрузки
    - assert: |
        - Скачивание карты прекращено
        - Данный КЭШ становится опять доступен для скачивания
    - do: |
        - Скачать кэш любого города или области
        - Меню - Настройки - Сохраненные данные - Стереть карты
    - assert: Удаляются все ранее скачанные карты
    - do: |
        - Перейти Меню - Загрузка карт
        - Начать скачивание карты любого горда карта
        - Очистить кэш во время загрузки Меню - Настройки - Сохраненные данные - Стереть карты
    - assert: Удаляются все ранее скачанные карты
    - do: Проверить список скаченных карт
    - assert: Удалённые КЭШи не отображаются в списке загруженных карт
    - do: |
        - Отключить интернет
        - Построить маршрут в регионе карта которого была скачана ранее
    - assert: Маршрут не строится

    - platforms:
        - android
    - tags:
        - assessors


  Offline Cache - Скачивание только по Wi-Fi:
    - info: |
        - Меню -> Настройки -> Карта и интерфейс -> Обновление карт -> Только по WiFi
        - Wi-Fi отключен
        - В девайсе активна сим-карта
    - do: |
        - Перейти в Меню - Загрузка карт
        - Начать скачивание карты любого региона
    - assert: Отображается уведомление, что "Нет доступа к Wi-Fi" и кнопки "да" / "нет"
    - do: Тап кнопку "нет"
    - assert: Загрузка карт находится на паузе в ожидании wi-fi
    - do: Подключиться к wi-fi
    - assert: Началась загрузка карты города
    - do: |
        - Перезайти в меню скачивания карт
        - Отключиться от wi-fi
        - Начать загрузку карт
        - В появившемся окне выбрать "да"
    - assert: Началась загрузка карт по мобильной связи

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Проверка поиска:
    - info: Скачать кеш Московской области
    - do: |
        * В телефоне включить авиарежим
        * Выгрузить Навигатор из памяти
        * Запустить Навигатор
        * Перейти на экран поиска
        * Тап на любую категорию, например "Где поесть"
    - assert: |
        * На карте отображаются пины
        * Слева от поисковой строки отображается "Синяя молния", обозначающая поиск и маршруты без интернета
    - do: Поскроллить карту по области карты входящей в скачанный кеш
    - assert: Пины появляются после скролла в видимой области карты
    - do: Проскроллить за область скаченного кеша
    - assert: |
        * Пины не появляются
    - do: Выключить авиарежим
    - assert: |
        * Подгрузились поисковые пины
        * "Синяя молния" поменялась на "Лупу"
    - do: |
        * Включить авиарежим
        * Проскроллить в область скаченного кеша
    - assert: |
        * Поисковые пины отображаются в области скаченного кеша
        * Слева от поисковой строки отображается "Синяя молния", обозначающая поиск и маршруты без интернета
        * (для android<5 и ГУ) Внизу экрана отображается плашка с текстом: "Оффлайн поиск, неполные данные"
    - do:  Тап на кнопку "P"
    - assert: |
        * Парковки не отображаются, курсор меняется
        * Поисковые пины отображаются на карте
        * Слева от поисковой строки отображается "Синяя молния", обозначающая поиск и маршруты без интернета
        * (для android<5 и ГУ) Внизу экрана отображается плашка с текстом: "Оффлайн поиск, неполные данные"
    - do: |
        * Выключить авиарежим
        * Посколлить карту
    - assert: |
        * Поисковые пины отображаются на карте
        * "Синяя молния" поменялась на "Лупу"
    - do: |
        * Эмулировать плохое соединение (100% потеря пакетов)
        * Перейти на экран "Поиск"
        * Тап на категорию
    - assert: |
        * Парковки отображаются
        * После ожидания происходит offline поиск
        * Слева от поисковой строки отображается "Синяя молния", обозначающая поиск и маршруты без интернета
        * (для android<5 и ГУ) Внизу экрана отображается плашка с текстом: "Оффлайн поиск, неполные данные"
    - do: |
        * Выключить эмуляцию плохого интернета
        * В настройках телефона выключить доступ к данным сотовой связи
        * Не подключаться к Wi-Fi
        * На экране поиска тап на категорию
    - assert: |
        * Произошел переход на экран карты
        * На экране карты отображаются поисковые пины
        * Слева от поисковой строки отображается "Синяя молния", обозначающая поиск и маршруты без интернета
        * (для android<5 и ГУ) Внизу экрана отображается плашка с текстом: "Оффлайн поиск, неполные данные"

    - platforms:
        - ios
        - geely
        - nissan
        - android
        - t3am
        - vaz
        - motrex
    - tags:
        - assessors


  (ГУ) Использование кеша с SD-карты:
    - info: Использовать телефон с возможностью использования sd-карт.
    - do: |
        Перейти в Меню - Загрузка карт
        Скачать кеш любого региона
    - assert: Кэш успешно скачен.
    - do: |
        * Перейти в Меню - Настройки - Сохраненные данные - Папка для карт
        * Выбрать карту памяти .
    - assert:  Появление шкалы состояния переноса, по окончанию процесса показ  уведомление "Карты перемещены".
    - do: |
        Перейти на экран "Карта"
        Вытащить sd-карту
    - assert: Произошел выход из приложения
    - do: |
        * Переустановить приложение.
        * Вставить sd-карту
        * Перейти в Меню - Настройки - Сохраненные данные - Папка для карт и выбрать карту памяти .
    - assert: Появляется уведомление "Карты перемещены"
    - do: |
        Перейти на экран "Карта"
        Включить на девайсе авиарежим
        Построить маршрут в любую точку
    - assert: Построен оффлайн-маршрут
    - do: Повторить **шаг 4** и выбрать вариант "На устройстве"
    - assert: Появляется уведомление “Карты перемещены”
    - do: |
        * Вытащить sd-карту.
        * Поменять локаль телефона.
        * Вставить sd-карту
        * Перезагрузить приложение.
        * Перейти в Меню - Загрузка карт
    - assert: Скачанный ранее кеш предлагается обновить

    - platforms:
        - vaz
        - nissan
    - integration_run:
        - mapkit
    - tags:
        - mapkit_ready


  Offline Cache - Способ скачивания (Только для ГУ):
    - description: Кейс только для ГУ
    - do: Начать скачивать карту города
    - assert: Отображается поп-ап, что за скачивание будет использоваться мобильный трафик и кнопки "да" / "нет" Это предупреждение показывается только один раз (на Motrex показывается всякий раз при перезаходе в раздел скачивания)
    - do: Тап по кнопке "нет" ("отменить" на Motrex)
    - assert: Скачивание не начинается
    - do: Отменить загрузку
    - assert: Загрузка отменена
    - do: |
        1. Перезайти в меню скачивания карт
        2. Начать скачивать карту города
    - assert: Отображается поп-ап, что за скачивание будет использоваться мобильный трафик и кнопки “да” / “нет”
    - do: 1. Подтвердить загрузку, выбрав "да" ("загрузить" на Motrex)
    - assert: Началось скачивание кешей

    - platforms:
        - motrex
        - geely
        - nissan
        - t3am
        - autochip
        - first_run_hu
        - vaz
    - testing:
        - acceptance_navi


  Шторка загрузки оффлайн-карт:
    - do: |
        - Перейти в Меню - Загрузка карт
        - Начать загрузку нескольких областей
        - Свернуть приложение
        - Открыть шторку девайса свайпом
    - assert: |
        - Загрузка кешей отображается в шторке
        - У плашки загрузки присутствует кнопка "Отмена"
    - do: |
        - Выгрузить приложение из меню многозадачности
        - Открыть шторку девайса свайпом
    - assert: |
        - Загрузка кешей отображается в шторке
        - У плашки загрузки присутствует кнопка “Отмена”
    - do: Тап на уведомление в шторке
    - assert: Происходит переход в Навигатор в раздел Загрузка карт
    - do: |
        - Свернуть приложение
        - Открыть шторку девайса свайпом
        - Тап на кнопку Отмена в шторке
    - assert: |
        - Уведомление исчезает из шторки
        - Загрузка прекращается

    - platforms:
        - android
        - nissan
    - tags:
        - assessors
        - mapkit_ready
    - integration_run:
        - mapkit


  Спецпроверки оффлайн кешей:
    - do: |
        - Начать загрузку карты любой области или города
        - Во время процесса скачивания отменить загрузку
    - assert: |
        - Анимация загрузки начинается сразу, как только запускается процесс скачивания
        - После отмены процедуры скачивания, анимация прекращается
    - do: |
        - Загрузить карту любой области или города
        - Построить маршрут в скаченной области
    - assert: Маршрут построен
    - do: Произвести поиск по любому запросу 
    - assert: Отображаются результаты поиска
    - do: |
        (Шаг для ГУ) Перезапустить ГУ
        Повторно проверить коррекность работы кешей
    - assert: Оффлайн корректно работает
    - do: |
        (Шаг для ГУ) Удалить скачанные кеши.
        Повторно запустить загрузку.
    - assert: Кеши корректно скачиваются и распаковываются.

    - platforms:
        - motrex
        - autochip
        - first_run_hu
        - android
        - ios
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - mapkit_ready


  Тестирование в офлайне - Добавление точки Избранное. Кеши скачаны.:
    - info: |
        - Скачаны офлайн кеши региона, в котором производится тестирование
        - На устройстве включен авиарежим
    - do: |
        - Лонгтап на карте
        - Тап "В Мои Места"
        - Тап на строку "Избранное"
        - Ввести любое название
        - Тап "Сохранить"
    - assert: На карте отображается значок с красной книжной закладкой
    - do: Перейти в "Мои места" в таббаре
    - assert: В разделе "Мои места" отображается строка с названием добавленной точки и расстоянием до неё

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Построение маршрута через "Поиск по категориям":
    - info: |
        * Скачать оффлайн-карту своего региона.
        * Включить авиарежим или полностью отключить интернет-соединение.
    - do: Тап по лупке на таббаре.
    - assert: Открывается экран поиска с категориями.
    - do: Тап по любой категории.
    - assert: Осуществляется переход на карту с результатами поиска.
    - do: Тап по любому пину результата.
    - assert: Открывается карточка организации.
    - do: Тап по кнопке “Поехали”
    - assert: |
        * Построился оффлайн - маршрут
        * Линия маршрута окрашена в синий цвет
        * В карточке обзора отображается расчетное время и расстояние до конечной точки и плашка “Маршрут без интернета”
    - do: Сбросить маршрут через тап по кнопке Отмена
    - do: |
        * Отскроллить карту за пределы региона.
        * Тап по лупке на таббаре
        * Тап по любой категории.
    - assert: |
        * Маршрут не строится.
        * Появляется плашка "Не удалось выполнить поиск"

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Перестроение маршрута оффлайн через "Уточнить":
    - info: |
        * Скачать оффлайн-карту своего региона.
        * Включить авиарежим или полностью отключить интернет-соединение.
        * Построить маршрут в пределах скачаного региона и запустить ведение по нему.
    - do: |
        * Перейти на экран обзора
        * Тап на плюсик на линии маршрута
        * Тап на "Уточнить"
    - assert: Открывается меню поиска со строкой ввода и саджестами
    - do: Прописать адрес в строке и выбрать из предложенных вариантов нужный.
    - assert: Осуществляется переход на карту, где показан пин точки и карточка с кнопкой Заехать.
    - do: Тап по кнопке Заехать.
    - assert: |
        * Добавлена промежуточная точка на маршрут
        * Маршрут перестроен с учетом промежуточной точки

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Перестроение маршрута оффлайн через "Взять из моих мест":
    - info: |
        * Скачать оффлайн-карту своего региона.
        * Включить авиарежим или полностью отключить интернет-соединение.
        * Построить маршрут в пределах скачаного региона.
    - do: |
        * На экране обзора
        * Тап на плюсик на линии маршрута
        * Тап на "Взять из моих мест"
    - assert: Открывается экран Мои места
    - do: Тап по нужному адресу из Сохраненных.
    - assert: |
        * Добавлена промежуточная точка на маршрут
        * Маршрут перестроен с учетом промежуточной точки
    - do: Тап на кнопку Поехали
    - assert: |
        * Навигатор переходит в режим ведения
    - do: |
        * Перейти на экран обзора (тапнув по значку с маршрутом на таббаре)
        * Тап на плюсик на линии маршрута
        * Тап на “Взять из моих мест”
    - assert: Открывается экран Мои места
    - do: Тап по нужному адресу из Недавние.
    - assert: |
        * Добавлена промежуточная точка на маршрут
        * Маршрут перестроен с учетом промежуточной точки

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Показ даты обновления у скачанного кеша региона. Outdated:
    - do: Скачать кэш любого региона
    - assert: Кэш скачан, для кэша показывается размер и дата обновления
    - do: |
        Перевести регион в состояние outdated интентом
        iOS: `yandexnavi://simulate_cache_update?needUpdate=false`
        Android: `adb shell am start -a android.intent.action.VIEW -d "yandexnavi://simulate_cache_update?needUpdate=false"`
    - assert: Для региона не показывается дата обновления

    - platforms:
        - ios
        - android
    - integration_run:
        - mapkit
    - tags:
        - assessors
        - mapkit_ready


  Загрузка карт в настройках с новом меню:
    - description: В данном кейсе проверяется перенос и вид загрузки карт из меню в настройки при включенном эксперименте на новое меню.
    - info: |
        - Локаль ru-RU
        - Геопозиция Россия
        - Сим-карта русская или отсутствует
        - Пользователь находится на главном экране
        - Включен эксперимент на перенос загрузки карт в настройки: Настройки - Dev settings - Misc - Move Download maps to settings - On
        - После включения экспериментов перезапустить приложение
    - do: Тап Меню Нави
    - assert: |
        * Показано новое Меню Нави
        * В меню, в крутилке сервисов, отсутствует кнопка "Загрузка карт"
    - do: Тап на шестерёнку в заголовке
    - assert: |
        - Открывается экран настроек
        - В Блоке "Расширенные настройки":
            - Первым пунктом идёт "Загрузка офлайн-карт"
            - Подзаголовок у плашки “Загрузка офлайн-карт” отсутствует
            - Иконка в стилистке остальных пунктов этого блока
    - do: Тап на "Загрузка офлайн-карт"
    - assert: Открывается экран "Загрузка карт"

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Эксперимент на переносе загрузки карт в настройки:
    - description: В данном кейсе проверяется перенос загрузки карт из меню в настройки по эксперименту
    - info: |
        - Локаль ru-RU
        - Геопозиция Россия
        - Сим-карта русская или отсутствует
        - Пользователь находится на главном экране
    - do: Тап Меню Нави
    - assert: |
        - Показано Меню Нави
        - В меню есть пункт "Загрузка карт"
    - do: Тап на Настройки
    - assert: |
        - Открывается экран настроек
        - В блоке “Расширенные настройки” нет загрузки карт
    - do: |
        Включить эксперимент по переносу загрузки карт в настройки: Настройки - dev settings - Misc - Move download maps to settings - On
    - do: |
        Выгрузить приложение из памяти
        Запустить приложение
        Тап Меню Нави
    - assert: |
        - Показано Меню Нави
        - В меню отсутствует пункт "Загрузка карт"
    - do: Тап на Настройки
    - assert: |
        - Открывается экран настроек
        - В блоке "Расширенные настройки" первым пунктом идёт "Загрузка офлайн-карт"
    - do: |
        Отключить эксперимент по переносу загрузки карт в настройки с перезапуском приложения
        Тап Меню
    - assert: |
        - Показано Меню Нави
        - В меню есть пункт “Загрузка карт”
    - do: Тап настройки
    - assert: |
        * Открывается экран настроек
        * В блоке “Расширенные настройки” нет загрузки карт

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Offline Cache - перенос карт на SD карту:
    - info: В девайс вставлена SD-карта
    - do: |
        - Скачать оффлайн-карту
        - Переместить карты на карту памяти: Настройки – Сохранённые данные – Папка для карт – На карте памяти
    - assert: Карты перенесены на SD-карту
    - do: |
        - Проверить что кеши были перенесены на SD-card
        Примерное расположение кешей (на разных девайсах может отличаться):
        Мои файлы - Карта памяти - Android - data - ru.yandex.yandexnavi - files - cache - offline caches
    - assert: На sd-card отображаются скачанные карты
    - do: |
        - Закрыть Навигатор
        - Вынуть карту памяти из телефона
        - Отключить интернет
        - Запустить Навигатор
        - Построить маршрут в регионе карты которого были скачены ранее
    - assert: Маршрут не строится

    - platforms:
        - android
    - integration_run:
        - mapkit
    - tags:
        - mapkit_ready
        - sd_card
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit


  Offline Cache - Папка для карт:
    - description: |
        В «Меню» навигатора – «Настройки» есть кнопка «Папка для карт», которая позволяет выбирать место для сохранения файлов КЭШей. 
        На андроидах < 4.4 варианты сохранения: «В телефоне», «На карте памяти», «Выбрать папку».
        На андроидах >= 4.4 варианты сохранения: «В телефоне» и несколько «На карте памяти»
    - do: В телефоне
    - assert: |
        Файлы КЭШей сохраняются в системной памяти, недоступны для просмотра
        - Автоматически переносит КЭШ в указанное место. Отображается сообщение «Карты перемещены»
        - Дальнейшее сохранение новых КЭШей производится в выбранную папку 
        - Проверить корректность высвобождения памяти
    - do: На карте памяти
    - assert: |
        Файлы КЭШей сохраняются на внутренню память по адресу: android/data/ru.yandex.yandexnavi/files/cache
        - Автоматически переносит КЭШ в указанное место. Отображается сообщение «Карты перемещены»
        - Дальнейшее сохранение новых КЭШей производится в выбранную папку 
        - Проверить корректность высвобождения памяти
    - do: На карте памяти (внешняя карта)
    - assert: |
        При наличии в девайсе съёмной карты появляется вторая кнопка «На карте памяти». Файлы сохраняются по адресу android/data/ru.yandex.yandexnavi(inhouse)/files/cache
        - Автоматически переносит КЭШ в указанное место. Отображается сообщение «Карты перемещены»
        - Дальнейшее сохранение новых КЭШей производится в выбранную папку 
        - Проверить корректность высвобождения памяти
    - do: Выбрать папку
    - assert: |
        Открывается проводник с возможностью указания места сохранения
        - Автоматически переносит КЭШ в указанное место. Отображается сообщение «Карты перемещены»
        - Дальнейшее сохранение новых КЭШей производится в выбранную папку 
        - Проверить корректность высвобождения памяти
    - do: Перенести на карту в условиях недостаточного места
    - assert: Сбой перемещения. КЭШи остаются на телефоне
    - do: Перенести на карту и извлечь её
    - assert: Навигатор не крешится
    - do: Перенести на внутреннюю память в условиях недостаточного места
    - assert: Навигатор не крешится
    - do: Выбрать папку вручную
    - assert: Карты отображаются корректно
    - do: Извлечь карту памяти с хранящимся на ней КЭШем
    - assert: |
        1. Во время работы навигатора – навигатор не крешится
        2. Перед запуском навигатора – Навигатор предлагает снова скачать карты
    - do: Вставить карту во время работы навика
    - assert: Навигатор не крешится
    - do: При обновлении навигатора
    - assert: Выбранное место сохранения КЭШей не меняется

    - platforms:
        - android
    - tags:
        - assessors


  Offline Cache - закрытие поп-апа свайпом вниз:
    - info: |
        - Свежая установка приложения
        - Показывается один раз после построения первого маршрута(в обзоре)на свежеустановленной сборке
        - Misc > fast day&night switching ON
    - do: Построить любой маршрут
    - assert: |
        - В обзоре маршрута появился поп-ап, регион для скачивания соответствует вашему местоположению
    - do: Сменить несколько раз ориентацию девайса.
    - assert: |
        - Поп-ап не схлопывается
        - UI "не искажен"
        - Приложение не крешит.
    - do: Дождаться смены темы.
    - assert: |
        - Артефактов противоположной темы не наблюдается.
    - do: Закрыть попап свайпом вниз
    - assert: |
        - Поп-ап  закрывается, на экране остается обзор маршрута

    - platforms:
        - android
        - ios
    - tags:
        - assessors


  Offline Cache - закрытие поп-апа Тап по карте:
    - info: |
        - Свежая установка приложения
        - Показывается один раз после построения первого маршрута(в обзоре)на свежеустановленной сборке
        - Misc > fast day&night switching ON
    - do: Построить любой маршрут
    - assert: |
        - В обзоре маршрута появился поп-ап, регион для скачивания соответствует вашему местоположению
    - do: Сменить несколько раз ориентацию девайса.
    - assert: |
        - Поп-ап не схлопывается
        - UI "не искажен"
        - Приложение не крешит.
    - do: Дождаться смены темы.
    - assert: |
        - Артефактов противоположной темы не наблюдается.
    - do: Закрыть поп-ап Тап по карте
    - assert: |
        - Поп-ап  закрывается, на экране остается обзор маршрута

    - platforms:
        - android
        - ios
    - tags:
        - assessors


  Offline Cache - определение местоположение при разном типе связи:
    - do: |
        - Перейти в "Загрузка карт" в Меню
    - assert: |
        - Отображается предложение скачать кэш ближайшего региона, исходя из текущего местоположения
        Корректно определяется при типе связи:
        - Мобильная передача данных
        - Wi-Fi
        - Мобильная передача данных + Wi-Fi

    - platforms:
        - ios
        - android
    - tags:
        - assessors
        - mapkit_ready
    - testing:
        - acceptance_navi
    - integration_run:
        - mapkit