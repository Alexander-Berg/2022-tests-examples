components: blizzard
testing:
  - regress

specs:
  Проверка рекламной сущности Буран:
    - description: |
        **Кейс проходим только в случае, если есть активная рекламная компания в виде Бурана**. 
        **Одним из шагов кейса является проверка появления события в логах.** Рекомендуется заранее подключить девайс через провод к Android studio/Console для IOS.
        **Буран** - это рекламный формат в виде свитчера на экране обзора, который предлагает проложить, построенный пользователем маршрут через рекламируемую организацию. 
        В случае наличия нескольких подходящих организаций для данной рекламы на маршруте  выбирается та точка, в которую быстрее всего можно заехать (необязательно ближайшая).
        **Страна и язык на устройстве должны быть установлены или  RU ru, или  TR tr .**
        Буран можно поймать в любом большом городе (Москва, Санкт-Петербург и тому подобное) ![image](https://jing.yandex-team.ru/files/fedonina71/photo_2020-09-02%2011.23.25.jpeg)
    - info: |
        - Для тестирования нужно в настройках сделать следующее:
        - Меню - Настройки - Developer Settings - Misc - Debug config enable - On
        - Перейти в настройку: Dev. Set. -> Ad -> Setup pages ids
        - Занулить все категории прописав в них 0 или null
        - В категорию "Буран (Via)" вписать следующий pageid: route_via_point_1/testing_azs_temp_neftmag
        - Тап сохранить
        - Для проверки отображения сущности в нужной теме, следует включить Настройку в Developer settings -> Misc -> Fast day and night switching = on
        - Для прохождения кейса выключить настройку: Developer settings -> ad -> show taxi ad route at second - Off и show taxi ad route at third position - Off
        - Если буран не будет ловиться в течение нескольких различных перестроений и маршрутов, прокинуть интент: `yandexnavi://add_exp?navi_overview_ads_priority_for_RU=via,brand_route,overview_geo_ad`
        - Перезагрузить Навигатор
    - do: |
        Построить маршрут, проходящий близко к пину рекламного проекта (старт и финиш не ближе чем 500м от этого объекта)
        Для этого прокинуть слудующий интент:
        Android: `adb shell am start -a android.intent.action.VIEW -d "yandexnavi://build_route_on_map?lat_from=55.734337\&lon_from=37.589145\&lat_to=55.376780\&lon_to=37.396182"`
        iOS: `yandexnavi://build_route_on_map?lat_from=55.734337&lon_from=37.589145&lat_to=55.376780&lon_to=37.396182`
    - assert: |
        - В экране обзора появляется **свитчер с названием рекламной организации.** 
        - Артефакты противоположной темы отсутствуют.
        - В логах приходит событие (навигатора) **overview-ads.pin-shown** и (мапкит) **mapkit.search.logger.billboard.show**
    - do: Переключить свитчер в положение включен.
    - assert: |
        - Добавляется виа точка нового перестроенного маршрута. Брендированность рекламной виа-точки не теряется (на значке отображается её логотип).
        - Артефакты противоположной темы отсутствуют.
        - В логах приходит событие (навигатора) **overview-ads.pin-swapped** и (мапкит) **mapkit.search.logger.billboard.click**
    - do: Переключить свитчер в положение выключен.
    - assert: |
        **Маршрут перестроен, он может не совпадать с тем, который был до**. Маршрут НЕ проходит через рекламную организацию.
    - do: Тап на "Поехали" при включенном буране
    - assert: Маршрут построился

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_navi
    - tags:
        - metric


  Буран в обзоре при смене ориентации девайса:
    - description: |
        **Кейс проходим только в случае, если есть активная рекламная компания в виде Бурана**
        Буран - это рекламный формат в виде свитчера на экране обзора, который предлагает проложить, построенный пользователем маршрут через рекламируемую организацию.
        **Страна и язык на устройстве должны быть установлены или  RU ru, или  TR tr .**
        ![image](https://jing.yandex-team.ru/files/kiseln/IMAGE%202020-06-09%2011%3A35%3A24.jpg)
    - info: |
        - Страна и язык на устройстве должны быть установлены или  RU ru, или  TR tr
        - Если буран не будет ловиться в течение нескольких различных перестроений и маршрутов, запустить интент: yandexnavi://add_exp?navi_overview_ads_priority_for_RU=via,brand_route,overview_geo_ad и перезагрузить приложение
        - Для тестирования нужно в настройках сделать следующее:
        - Меню - Настройки - Developer Settings - Misc - Debug config enable - On
        - Перейти в настройку: Dev. Set. -> Ad -> Setup pages ids
        - Занулить все категории прописав в них 0 или null
        - В категорию "Буран (Via)" вписать следующий pageid: route_via_point_1/testing_azs_temp_neftmag
        - Тап сохранить
        - Developer settings -> ad -> show taxi ad route at second position - Off и show taxi ad route at third position - Off
    - do: |
        Построить маршрут, проходящий близко к пину рекламного проекта. 
        Для этого прокинуть слудующий интент:
        Android: `adb shell am start -a android.intent.action.VIEW -d "yandexnavi://build_route_on_map?lat_from=55.734337\&lon_from=37.589145\&lat_to=55.376780\&lon_to=37.396182"`
        iOS: `yandexnavi://build_route_on_map?lat_from=55.734337&lon_from=37.589145&lat_to=55.376780&lon_to=37.396182`
    - assert: |
        В экране обзора появляется **свитчер с названием рекламной организации.** 
    - do: Переключить свитчер в положение включен.
    - assert: Добавляется виа точка нового перестроенного маршрута. Брендированность рекламной виа-точки не теряется (на значке отображается её логотип).
    - do: Несколько раз сменить ориентацию девайса
    - assert: Отображение свитчера и промежуточной точки в разных ориентациях одинаковое.

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_navi


  Добавление промежуточной точки в маршрут с бураном:
    - description: |
        **Кейс проходим только в случае, если есть активная рекламная компания в виде Бурана**
        Буран - это рекламный формат в виде свитчера на экране обзора, который предлагает проложить, построенный пользователем маршрут через рекламируемую организацию.
        **Страна и язык на устройстве должны быть установлены или  RU ru, или  TR tr .**
    - info: |
        Для тестирования нужно в настройках сделать следующее:
        - Меню - Настройки - Developer Settings - Misc - Debug config enable - On
        - Перейти в настройку: Dev. Set. -> Ad -> Setup pages ids
        - Занулить все категории прописав в них 0 или null
        - В категорию "Буран (Via)" вписать следующий pageid: route_via_point_1/testing_azs_temp_neftmag
        - Тап сохранить
        - Для прохождения кейса выключить настройку: Developer settings -> ad -> show taxi ad route at second - Off и show taxi ad route at third position - Off
        - Если буран не будет ловиться в течение нескольких различных перестроений и маршрутов, прокинуть интент: `yandexnavi://add_exp?navi_overview_ads_priority_for_RU=via,brand_route,overview_geo_ad`
        - Перезагрузить Навигатор
    - do: |
        Построить маршрут, проходящий близко к пину рекламного проекта.
        Для этого прокинуть слудующий интент:
        Android: `adb shell am start -a android.intent.action.VIEW -d "yandexnavi://build_route_on_map?lat_from=55.734337\&lon_from=37.589145\&lat_to=55.376780\&lon_to=37.396182"`
        iOS: `yandexnavi://build_route_on_map?lat_from=55.734337&lon_from=37.589145&lat_to=55.376780&lon_to=37.396182`
    - assert: В экране обзора появляется **свитчер с названием рекламной организации.** 
    - do: Добавить на маршрут промежуточную точку.
    - assert: |
        - Промежуточная точка установлена. 
        - Буран не отображается на экране обзора

    - platforms:
      - ios
      - android
    - testing:
      - acceptance_navi


  Буран в обзоре при дневном режиме:
    - description: |
        **Буран** - это рекламный формат в виде свитчера на экране обзора, который предлагает проложить, построенный пользователем маршрут через рекламируемую организацию. 
        ![image](https://jing.yandex-team.ru/files/kiseln/IMAGE%202020-06-09%2011%3A35%3A24.jpg)
    - info: |
        - Страна и язык на устройстве должны быть установлены или  RU ru, или  TR tr .
        - Если буран не будет ловиться в течение нескольких различных перестроений и маршрутов, запустить интент: yandexnavi://add_exp?navi_overview_ads_priority_for_RU=via и перезагрузить приложение.
        - Для тестирования нужно в настройках сделать следующее:
        - Меню - Настройки - Developer Settings - Misc - Debug config enable - On
        - Перейти в настройку: Dev. Set. -> Ad -> Setup pages ids
        - Занулить все категории прописав в них 0 или null
        - В категорию "Буран (Via)" вписать следующий pageid: route_via_point_1/testing_azs_temp_neftmag
        - Тап сохранить
    - do: |
        Построить маршрут, проходящий близко к пину рекламного проекта.
        Для этого прокинуть слудующий интент:
        Android: `adb shell am start -a android.intent.action.VIEW -d "yandexnavi://build_route_on_map?lat_from=55.734337\&lon_from=37.589145\&lat_to=55.376780\&lon_to=37.396182"`
        iOS: `yandexnavi://build_route_on_map?lat_from=55.734337&lon_from=37.589145&lat_to=55.376780&lon_to=37.396182`
    - assert: |
        - В экране обзора появляется **свитчер с названием рекламной организации.** 
        - Все элементы отображаются в светлой теме
    - do: Переключить свитчер в положение включен.
    - assert: |
        - Добавляется виа точка нового перестроенного маршрута. Брендированность рекламной виа-точки не теряется (на значке отображается её логотип).
        - Артефакты темной темы отсутствуют.
    - do: Переключить свитчер в положение выключен.
    - assert: |
        **Маршрут перестроен, он может не совпадать с тем, который был до**. Маршрут НЕ проходит через рекламную организацию.
    - do: |
        - Снова включить свитчер бурана
        - Тап на "Поехали" 
    - assert: Происходит переход в режим ведения по маршруту через рекламную организацию 

    - platforms:
      - ios
      - android
    - tags:
        - assessors
    - testing:
      - acceptance_navi