components: gas_card_org
testing:
  - regress
integration_run:
  - tanker_sdk

specs-integration:
  aliases:
    - &Отображение_слоя_для_карточки_шаг
        - do: |
            - Использовать интенты:
              [collapsed-image](https://jing.yandex-team.ru/files/midway/download-4-2.png){title=QR-код}
        
              `yandexnavi://add_exp?navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
            - Перезагрузить приложение
        - do: Тап на колонку в таббаре
    - &Отображение_слоя_для_карточки_результат
        - assert: Отображаются зеленые пины с оплатой

specs:
  Карточка заправки. Проверка UI:
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин
    - assert: Отображается карточка организации АЗС
    - do: Раскрыть карточку
    - assert: |
        - Отображается полная карточка заправки
        - В карточке присутствует:
            - Фото заправки
            - Название заправки
            - Время работы
            - Время в пути до заправки
            - Расстояние до заправки
            - Кнопка "Заправиться"
            - Кнопка "Маршрут"
            - Кнопка "Отсюда"
            - Кнопка "Позвонить"
            - Кнопка "Поделиться"
            - Кнопка "Избранное"
            - Кнопка "Ссылки"
    - do: Повернуть устройство в горизонтальную ориентацию
    - assert: |
        - Элементы в карточке организации АЗС выровнены относительно друг друга
        - Другие пины на карте не пропадают
        - Названия заправок не меняются
        - Зум не меняется
    - do: Повернуть устройство в вертикальную ориентацию
    - assert: |
        - Элементы в карточке выровнены относительно друг друга
        - Другие пины на карте не пропадают
        - Названия заправок не меняются
        - Зум не меняется
    - do: Дождаться смены день/ночь
    - assert: |
        - Элементы в карточке выровнены относительно друг друга
        - Другие пины на карте не пропадают
        - Названия заправок не меняются
        - Зум не меняется

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Карточка заправки. Закрытие карточки в вертикальной ориентации:
    - info: Устройство в вертикальной ориентации
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап на крестик в карточке
    - assert: Карточка закрывается
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап по спану карты
    - assert: Карточка закрывается
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап по другому зеленому пину заправки
    - assert: |
        - Открывается карточка другой организации АЗС
        - Пин предыдущей заправки не выделен

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Карточка заправки. Закрытие карточки в горизонтальной ориентации:
    - info: Устройство в горизонтальной ориентации
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап на крестик в карточке
    - assert: Карточка закрывается
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап по спану карты
    - assert: Карточка закрывается
    - do: Тап по любому зеленому пину заправки
    - assert: Открывается карточка организации АЗС
    - do: Тап по другому зеленому пину заправки
    - assert: |
        - Открывается карточка другой заправки
        - Пин предыдущей заправки не выделен

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Сворачивание приложения при открытой карточке организации АЗС в среднем состоянии:
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается карточка организации АЗС в среднем состоянии

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Сворачивание приложения при открытой карточке организации АЗС в полном состоянии:
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Развернуть карточку
    - assert: Отображается полная карточка организации АЗС в полном состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается карточка организации АЗС в полном состоянии

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Сворачивание приложения при открытой карточке организации АЗС в минимальном состоянии:
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Свернуть карточку организации в минимальное состояние
    - assert: Отображается карточка организации АЗС в минимальном состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается карточка организации АЗС в минимальном состоянии

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Плашка гарантии качества топлива на карточке АЗС с оплатой:
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-8-2.png){title=QR-код}
        
          `yandexnavi://add_exp?navi_feature_gas_stations_insurance=enabled`
        - Перезагрузить приложение
    - do: Открыть любой заправочный пин АЗС с оплатой
    - assert: |
        - Открывается карточка организации АЗС с оплатой.
        - Над кнопкой "Заправиться" отображается плашка "Качество топлива застраховано"
    - do: Тап на любой другой пин АЗС без оплаты от Яндекса
    - assert: |
        - Открывается карточка организации АЗС с оплатой.
        - На карточке не отображается плашка “Качество топлива застраховано”

    - platforms:
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Открытие вебвью гарантии качества топлива на карточке АЗС с оплатой:
    - info: Устройство в вертикальной ориентации
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-8-2.png){title=QR-код}
        
          `yandexnavi://add_exp?navi_feature_gas_stations_insurance=enabled`
        - Перезагрузить приложение
    - do: Открыть любой заправочный пин АЗС с оплатой
    - assert: |
        - Открывается карточка организации АЗС с оплатой
        - Над кнопкой "Заправиться" отображается плашка "Качество топлива застраховано"
    - do: Тап на плашку “Качество топлива застраховано”
    - assert: Открывается вебвью

    - platforms:
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Отображение кнопки "Заправиться" около АЗС:
    - do: Построить маршрут, проходящий рядом с АЗС с оплатой
    - do: Запустить симуляцию движения со скоростью не выше 10 км/ч
    - assert: За 150м от АЗС над плашкой ЕТА отобразится кнопка "Заправиться"
    - do: Тап на кнопку “Заправиться”
    - assert: Открывается карточка заправки
    - do: Сменить ориентацию девайса
    - do: Закрыть карточку заправки
    - assert:  Над плашкой ЕТА отображается кнопка “Заправиться”
    - do: Дождаться пока курсор проедет АЗС 
    - assert: Кнопка "Заправиться" исчезает
   

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Отсутствие кнопки "Заправиться" около АЗС:
    - do: Построить маршрут, проходящий рядом с АЗС с оплатой
    - do: Запустить симуляцию движения со скоростью выше 10 км/ч
    - assert: При подъезде к АЗС кнопка "Заправиться" не появляется

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Кнопка "Заправиться" около АЗС и ЗСБ:
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/mikhail-vin/download-2.b60e70b.png){title=QR-код}
        
          `yandexnavi://reset_exp`
          [collapsed-image](https://jing.yandex-team.ru/files/mikhail-vin/download.7ed8e87.png){title=QR-код}

          `yandexnavi://set_ad_page_id?page_id=null`
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-30.png){title=QR-код}
        
          `yandexnavi://set_ad_page_id?page_type=zero_speed&page_id=navi_zero_speed_banner_10/testing_zsb_regular2`
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-10-1.png){title=QR-код}
        
          `yandexnavi://add_exp?navi_feature_force_zero_speed_state=enabled&navi_feature_ignore_ads_cooldown=enabled`
        - Перезагрузить приложение
    - do: |
        Построить маршрут, используя интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-31.png){title=QR-код}
        
          `yandexnavi://build_route_on_map?lat_from=54.195881&lon_from=37.663805&lat_to=54.1969736&lon_to=37.659952`
    - do: Запустить симуляцию движения со скоростью не выше 10 км/ч
    - assert: |
        Появляется баннер ЗСБ под плашой ЕТА
        За 150м от АЗС над плашкой ЕТА отобразится кнопка "Заправиться"
    - do: Раскрыть карточку ЗСБ тапом
    - assert: Карточка ЗСБ раскрывается, кнопка “Заправиться” исчезает
    - do: Сменить ориентацию девайса
    - do: Закрыть карточку ЗСБ
    - assert:  Над плашкой ЕТА отображается кнопка “Заправиться”

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Саджест заправится при открытом парковочном виджете:
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-5-3.png){title=QR-код}
        
          `yandexnavi://add_exp?navi_feature_day_night_fast_switch=enabled&navi_feature_debug_parking_polygon=enabled&navi_feature_parking_widget=enabled`
        
    - do: |
        - Построить маршрут, проходящий рядом с АЗС с оплатой внутри парковочного полигона
        - Запустить симуляцию движения со скоростью не выше 10 км/ч
    - assert: |
        За 150м от АЗС отобразится кнопка-саджест “Заправиться”
        За 100м до финиша появится Парковочный виджет
    - do: Тап по саджесту Заправиться
    - assert: Открывается карточка заправки на экране "Выбора колонки"

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Отображение бейджа в карточке АЗС:
    - info: |
        - Девайс в вертикальной ориентации
        - Открыт главный экран приложения
    - do: Тап на любой пин карточки заправки с оплатой
    - assert: |
        Отображается карточка организации АЗС
        Под заголовком карточки заправки отображается бейдж
    - do: Раскрыть карточку заправки свайпом вверх
    - assert: |
        Отображается раскрытая карточка организации АЗС
        Бейдж отображается
    - do: Сменить ориентацию девайса на горизонтальную
    - assert: |
        Отображается карточка организации АЗС в горизонтальной ориентации
        Бейдж отображается
        UI не ломается

    - tags:
        - assessors
    - platforms:
        - ios
        - android 


  Dont keep activities. Сворачивание приложения при открытой карточке организации АЗС в среднем состоянии:
    - info: Включен режим DKA
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается экран "Карта"

    - platforms:
        - android
    - tags:
        - assessors


  Dont keep activities. Сворачивание приложения при открытой карточке организации АЗС в полном состоянии:
    - info: Включен режим DKA
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Развернуть карточку
    - assert: Отображается полная карточка организации АЗС в полном состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается экран "Карта"

    - platforms:
        - android
    - tags:
        - assessors


  Dont keep activities. Сворачивание приложения при открытой карточке организации АЗС в минимальном состоянии:
    - info: Включен режим DKA
    - *Отображение_слоя_для_карточки_шаг
    - *Отображение_слоя_для_карточки_результат
    - do: Тап на любой зеленый пин заправки
    - assert: Отображается карточка организации АЗС в среднем состоянии
    - do: Свернуть карточку организации в минимальное состояние
    - assert: Отображается карточка организации АЗС в минимальном состоянии
    - do: Свернуть приложение
    - assert: Приложение сворачивается
    - do: Развернуть приложение
    - assert: Отображается экран "Карта"

    - platforms:
        - android
    - tags:
        - assessors