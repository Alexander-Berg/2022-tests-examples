components: gas_card_col
testing:
  - regress
integration_run:
  - tanker_sdk

specs-integration:
  aliases:
    - &Info_gas_card_col
        - info: Подменить местоположение на АЗС Тестировочная, Лобное место на Красной площади в Москве
    - &Отображение_карточки_шаг
        - do: |
            - Использовать интенты:
            [collapsed-image](https://jing.yandex-team.ru/files/midway/download-27.png){title=QR-код}

            `yandexnavi://add_exp?navi_feature_gas_stations_force_test_mode=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
            - Перезагрузить приложение
        - do: Тап на колонку в таббаре
        - do: Открыть тестировочную карточку АЗС с оплатой
        - do: Выбрать любую колонку и топливо
    - &Отображение_карточки_результат
        - assert: Отображается экран выбора обьема топлива



specs:
  Кнопка "Заправиться" в карточке (при нахождении в полигоне АЗС):
    - do: Выполнить поиск по категории "АЗС с оплатой"
    - do: Выбрать ближайшую АЗС к местоположению курсора
    - assert: В карточке объекта присутствуют кнопки "Заправиться" и "Маршрут"
    - do: Тап "Заправиться"
    - assert: Происходит переход к карточке Заправки со списком колонок для выбора
    - do: Выбрать любую колонку
    - assert: Происходит переход к окну выбора вида топлива, объема и способа оплаты
    - do: Выбрать любой вид топлива
    - assert: Отображается экран выбора обьема топлива. Внизу зеленая кнопка "оплатить"

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Открытие карточки заправки при заезде на АЗС:
    - do: Построить маршрут через территорию АЗС с оплатой.
    - do: Запустить симуляцию со скоростью меньше 25 км/ч
    - do: Дождаться открытия карточки заправки
    - assert: Автоматические открывается карточка заправки на экране "Выбора колонки"
    - do: Свайп вниз карточку
    - do: Тап по крестику
    - assert: Карточка закрылась

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Запрос авторизации при взаимодействии с Заправкой:
    - info: |
        - Пользователь неавторизован
        - Местоположение пользователя должно находиться на территории полигона АЗС с оплатой
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Тап на кнопку "Оплатить"
    - assert: Происходит переход к окну авторизации
    - do: Авторизоваться любым аккаунтом
    - assert: Просходит переход "способ оплаты"

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors
    - integration_run:
        - am_sdk

  Аннотация при выборе колонки АЗС:
    - do: Открыть карточку АЗС Shell с оплатой
    - do: Тап на заправиться
    - assert: Открывается карточка Заправки со списком колонок
    - do: Тап на любую колонку
    - do: Выбрать любой тип топлива
    - assert: |
        - Звучит аннотация "Сначала скажите заправщику, что оплата будет в навигаторе"
        - Над кнопкой "оплатить" отображается плашка с текстом : "Скажите заправщику, что оплата будет в навигаторе"
    - do: Вернуться к выбору колонки
    - do: Выбрать любой вид топлива
    - assert: |
        - Происходит переход к этапу выбора топлива
        - Аннотация не произносится

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Аннотация при выборе колонки АЗС(повторное открытие карточки):
    - do: Открыть карточку АЗС Shell с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: |
        - Открывается карточка Заправки на экране оплаты
        - Звучит аннотация "Сначала скажите заправщику, что оплата будет в навигаторе"
        - Над кнопкой "оплатить" отображается плашка с текстом : "Скажите заправщику, что оплата будет в навигаторе"
    - do: Закрыть карточку заправки
    - do: Повторно открыть карточку АЗС
    - do: Перейти к экрану оплаты
    - assert: |
        - Звучит аннотация "Сначала скажите заправщику, что оплата будет в навигаторе"
        - Над кнопкой "оплатить" отображается плашка с текстом : "Скажите заправщику, что оплата будет в навигаторе"

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Смена ориентации на экране выбора колонки.:
    - do: Найти любую АЗС с оплатой
    - do: Тап на заправиться
    - do: Изменить ориентацию устройства.
    - assert: |
        - Слева отображается карточка заправки с названием, адресом и номерами колонок
        - Элементы в карточке заправки выравнены относительно друг друга, верстка не едет
    - do: Изменить ориентацию устройства
    - assert: |
        - Элементы в карточке заправки выравнены относительно друг друга, верстка не едет
        - Отображается карточка заправки с названием, адресом и номером колонки

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправки. Выбор объема топлива ползунком.:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Передвигая ползунок выбрать обьем и сумму топлива
    - assert: Отображается выбранное количество топлива и сумма
    - do: Сменить ориентацию устройства.
    - assert: Отображается раннее выбранное количество топлива и сумма

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Карточка заправки. Выбор объема топлива через сумму.:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на сумму
    - do: Выбрать любую сумму в указанных пределах
    - assert: Отображается выбранная сумма
    - do: Сменить ориентацию устройства
    - assert: Отображается раннее выбранная сумма
    - do: Тап на готово
    - assert: В пункте "количество" указана выбранная сумма

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Сброс данных с карточки заправки при разлогине:
    - *Info_gas_card_col
    - info: Пользователь авторизован
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Выйти из карточки Заправки
    - do: Перейти в Меню и выйти из аккаунта
    - do: Перейти на экран “Карта” и тап на пин заправки
    - do: Тап “Заправиться”
    - do: Перейти к экрану выбора обьема топлива
    - assert: В карточке отсутствуют данные предыдущего пользователя

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправок при авиарежиме:
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Перевести девайс в авиарежим
    - do: Тап на заправиться
    - assert: Открывается карточка Заправки, отображается ошибка отсутствия сети.
    - do: Отключить авиарежим
    - do: Тап по кнопке "Повторить"
    - assert: Подгружается информация на карточке заправки

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Карточка заправок после выгрузки приложения:
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - assert: Открывается карточка Заправки со списком колонок.
    - do: Выгрузить приложение из меню мультизадачности
    - do: Запустить приложение
    - assert: |
        - Отображается местоположение пользователя
        - Карточка заправки не отображается

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправок при скролле карты:
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - assert: Открывается карточка Заправки со списком колонок.
    - do: Поскроллить карту
    - assert: |
        - Карточка заправки не скрывается
        - Карточка заправки не меняет степень своего раскрытия

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Карточка заправок при зуме карты:
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - assert: Открывается карточка Заправки со списком колонок.
    - do: Изменить зум карты
    - assert: |
        - Карточка заправки не скрывается
        - Карточка заправки не меняет степень своего раскрытия

    - platforms:
        - ios
        - t3am
        - android
        - motrex
        - autochip
        - second_run_hu
    - tags:
        - assessors


  Карточка заправок после сворачивания приложения:
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Выбрать любое количество топлива
    - assert: Все выбранные данные отображаются в карточке заправки
    - do: Свернуть-развернуть приложение
    - assert: |
        - Состояние карточки не сброшено
        - Введеные ранее данные не сбрасываются

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Dont keep activities. Карточка заправок после сворачивания приложения:
    - info: Включен режим DKA
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Выбрать любое количество топлива
    - assert: Все выбранные данные отображаются в карточке заправки
    - do: Свернуть-развернуть приложение
    - assert: Открывается экран "Карта"

    - platforms:
        - android
    - tags:
        - assessors



  Карточка заправки. Отображаение колонок.:
    - *Info_gas_card_col
    - do: |
        - Использовать интенты:
            [collapsed-image](https://jing.yandex-team.ru/files/midway/download-1-2.png){title=QR-код}

            `yandexnavi://add_exp?navi_feature_gas_stations_force_test_mode=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
        - Перезагрузить приложение
    - do: Тап на колонку в таббаре
    - do: Открыть тестировочную карточку АЗС с оплатой
    - assert: |
        - Открывается карточка заправки на экране "Выбора колонки"
        - У каждой колонки помимо ее номера отображается доступный тип топлива на этой колонке

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Карточка заправки. UI полного бака:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Ползунком изменить кол-во топлива до максимального значения
    - assert: |
        - Надпись на ползунке "полный бак" из серой стала черной в светлой теме (либо белой в темной теме)
        - Под надписью кол-во литров появляется кнопка "править"
    - do: Тап на кнопку "править"
    - assert: |
        - Открывается экран "Полный бак"
        - С поясняющей надписью по оплате
        - Блоком для изменения кол-ва литров
        - Кнопкой подтверждения в виде галочки с подписью Готово
    - do: Сменить ориентацию
    - assert: |
        - Карточка заправки не закрывается
        - Элементы в карточке выровнены относительно друг друга
        - Верстка не едет
        - Карточка заправки подстраивается под ориентацию девайса
    - do: Дождаться смены день/ночь
    - assert: |
        - Карточка заправки не закрывается
        - Элементы в карточке выровнены относительно друг друга
        - Верстка не едет
        - Артефакты противоположной темы отсутствуют

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправки. Изменение полного бака тапом на плейсхолдеры:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Ползунком изменить кол-во топлива до максимального значения
    - assert: Под надписью кол-во литров появляется кнопка "править"
    - do: Тап на кнопку "править"
    - assert: Открывается экран "Полный бак"
    - do: Тап на +/- в блоке для изменения кол-ва литров
    - assert: |
        - В самом блоке меняется кол-во литров в полном баке
        - В поясняющей надписи меняется сумма, которая будет заблокирована при оплате
    - do: Тап на кнопку Готово
    - assert: |
        - Происходит переход на экран с изменением суммы/кол-ва топлива
        - С правой стороны от ползунка указывается кол-во литров в полном баке, которое было выбрано ранее

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправки. Правка полного бака:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на "Полный бак"
    - assert: Открывается вебвью с изменением количества литров для полного бака
    - do: Тап на плейсхолдеры (кнопки "+" и "-")
    - assert: |
        - Плейсхолдеры тапабельны
        - Меняется количество литров для полного бака
    - do: Тап на кнопку "править"
    - assert: Открывается экран ввода количества топлива
    - do: Ввести любое валидное значение и тап на кнопку "готово"
    - assert: На баке отображается примененное количество литров.

    - platforms:
        - t3am
        - android
    - tags:
        - assessors


  Карточка заправки. Правка полного бака на невалидное значение:
    - *Info_gas_card_col
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на "Полный бак"
    - assert: Открывается вебвью с изменением количества литров для полного бака
    - do: Тап на кнопку "править"
    - assert: Открывается экран ввода количества топлива
    - do: Ввести "1000"
    - assert: Значение не применяется

    - platforms:
        - t3am
        - android
    - tags:
        - assessors


  Заправка на одной колонке:
    - info: |
        - Пользователь авторизован
        - Найдена продовая АГЗС по адресу: Москва, Щербинка, Остафьевское шоссе 7
    - do: Открыть карточку организации АЗС
    - do: Тап на кнопку "Заправиться"
    - assert: Открывается экран выбора топлива

    - platforms:
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Показ и закрытие вебвью "Как оплатить топливо в приложении" на АЗС с постоплатой:
    - info: |
        - Пользователь не авторизован
        - Проверка происходит на продовой АЗС
    - do: |
        - Использовать интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-6-2.png){title=Qr-код}

          `yandexnavi://add_exp?gas_stations_landing_url=https%3A%2F%2Fyandex.ru%2Fweb-maps%2Fwebview%3Fmode%3Dgas-stations%26video%3Dfalse&navi_feature_day_night_fast_switch=enabled`
        - Перезагрузить приложение
    - do: Построить маршрут через территорию АЗС BP с постоплатой по адресу Москва, Волгоградский проспект 24, стр 1.
    - do: Запустить ведение по маршруту со скоростью меньше 25 км/ч и дождаться въезда на полигон АЗС
    - assert: При въезде на полигон открывается вебвью "Как оплатить топливо в приложении".
    - do: Тап "Выбрать колонку"
    - assert: |
        - Вебвью закрывается
        - Открывается карточка заправки нв экране "Выбора колонки"

    - platforms:
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Показ и закрытие вебвью "Как оплатить топливо в приложении" на АЗС с предоплатой:
    - info: |
        - Пользователь не авторизован
        - Проверка происходит на продовой АЗС
    - do: |
        - Использовать интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-6-2.png){title=Qr-код}

          `yandexnavi://add_exp?gas_stations_landing_url=https%3A%2F%2Fyandex.ru%2Fweb-maps%2Fwebview%3Fmode%3Dgas-stations%26video%3Dfalse&navi_feature_day_night_fast_switch=enabled`
        - Перезагрузить приложение
    - do: Построить маршрут через территорию АЗС с предоплатой
    - do: Запустить ведение по маршруту со скоростью меньше 25 км/ч и дождаться въезда на полигон АЗС
    - assert: При въезде на полигон открывается вебвью "Как оплатить топливо в приложении".
    - do: Тап "Выбрать колонку"
    - assert: |
        - Вебвью закрывается
        - Открывается карточка заправки нв экране "Выбора колонки"

    - platforms:
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Вебвью "Как оплатить топливо в приложении" проверка UI:
    - info: |
        - Девайс в вертикальной ориентации
        - Пользователь не авторизован
        - Проверка происходит на продовой АЗС
    - do: |
        - Использовать интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-6-2.png){title=Qr-код}

          `yandexnavi://add_exp?gas_stations_landing_url=https%3A%2F%2Fyandex.ru%2Fweb-maps%2Fwebview%3Fmode%3Dgas-stations%26video%3Dfalse&navi_feature_day_night_fast_switch=enabled`
        - Перезагрузить приложение
    - do: Тап на любую АЗС с предоплатой
    - do: Тап "Заправиться"
    - assert: |
        - Открывается вебвью "Как оплатить топливо в приложении"
        - Есть карусель с картинками и поясняющим текстом, кнопки "Выбрать колонку" и "Закрыть".
        - Картинки в карусели пролистываются автоматически
        - Верстка не ломается, указатели под картинками корректны
    - do: Просвайпать все картинки в карусели
    - assert: |
        - Автоматическое пролистывание останавливается
        - Верстка не ломается, указатели под картинками корректны
        - Текст под картинками соответствует описанию процесса заправки с предоплатной системой
    - do: Сменить ориентацию на горизонтальную
    - assert: |
        - Вебвью закрывается
        - Открывается карточка заправки нв экране "Выбора колонки"

    - platforms:
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Логика отображение вебвью "Как оплатить топливо в приложении" на одноколоночной АЗС:
    - info: |
        - Пользователь не авторизован
        - Проверка происходит на продовой АЗС
        - Найдена продовая АГЗС по адресу: Москва, Щербинка, Остафьевское шоссе 7
    - do: |
        - Использовать интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-6-2.png){title=Qr-код}

          `yandexnavi://add_exp?gas_stations_landing_url=https%3A%2F%2Fyandex.ru%2Fweb-maps%2Fwebview%3Fmode%3Dgas-stations%26video%3Dfalse&navi_feature_day_night_fast_switch=enabled`
        - Перезагрузить приложение
    - do: Построить маршрут через территорию АГЭС
    - do: Запустить ведение по маршруту и дождаться въезда на полигон АЗС
    - assert: При въезде на полигон открывается вебвью "Как оплатить топливо в приложении".
    - do: Тап "Выбрать колонку"
    - assert: |
        - Вебвью закрывается
        - Происходит переход к карточке Заправки с выбором топлива
    - do: Тап по стрелке "Назад"
    - assert: Происходит возврат к вебвью с каруселью "Как оплатить топливо в приложении"

    - platforms:
        - ios
    - tags:
        - assessors


  Отсутствие вебвью "Как оплатить топливо в приложении" для пользователей с историей заправок:
    - info: |
        - Проверка происходит на продовой АЗС
        - Авторизоваться аккаунтом yndx-gas-history / QAZwsx12345
    - do: |
        - Использовать интент:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-6-2.png){title=Qr-код}

          `yandexnavi://add_exp?gas_stations_landing_url=https%3A%2F%2Fyandex.ru%2Fweb-maps%2Fwebview%3Fmode%3Dgas-stations%26video%3Dfalse&navi_feature_day_night_fast_switch=enabled`
        - Перезагрузить приложение
    - do: |
        - Открыть любую карточку организации АЗС с оплатой
        - Тап "Заправиться" в карточке заправки
    - assert: |
        - Открывается карточка Заправки
        - Отсутствует вебвью "Как оплатить топливо в приложении"

    - platforms:
        - ios
    - tags:
        - assessors


  Закрытие формы чекаута на постоплатной АЗС при свободной колонке:
    - info: |
        - Пользователь авторизован
        - Подменить местоположение на АЗС Тестировчная POST адрес: Москва, ул.Ильинка 4
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-2-4.png){title=QR-код}

          `yandexnavi://add_exp?navi_feature_gas_stations_force_test_mode=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
        - Перезагрузить приложение
    - do: Тап на колонку в таббаре
    - do: Открыть тестировочную карточку АЗС с постоплатой
    - assert: |
        - Автоматический выбирается количество топлива и сумма
        - Открывается форма для выбора способа оплаты заправки
    - do: Подождать около минуты
    - assert: Форма автоматически скрывается

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  СБП у новых пользователей как способ оплаты по умолчанию:
    - info: |
        - Пользователь авторизован новым аккаунтом в приложение
        - Скачано хотя бы одно банковское приложение (логиниться в них не нужно)
        - Приложение не запушено
    - do: Запустить приложение
    - do: Тап на Меню
    - do: Тап «Яндекс.Заправки» в строке сервисов
    - do: Тап "Способы оплаты"
    - assert: СБП как способ оплаты стоит по умолчанию

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Выбор банка при оплате заправки по СБП:
    - info: |
        - Пользователь авторизован
        - Скачано несколько банковских приложений (логиниться в них не нужно)
        - Местоположение пользователя на любой АЗС с оплатой
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Тап "Оплатить"
    - assert: Появилась форма для выбора способа оплаты заправки
    - do: Выбрать СБП как способ оплаты
    - do: Тап "Подтвердить"
    - assert: |
        - Открывается форма для выбора банковского приложения для оплаты по СБП
        - Отображаются все установленные ранее банки
    - do: Выбрать любой банк
    - do: Тап "Выбрать"
    - assert: Происходит переход в выбранное банковское приложение

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Выбор банка при оплате заправки по СБП (один банк):
    - info: |
        - Пользователь авторизован
        - Скачано одно банковское приложение (логиниться не обязательно)
        - Местоположение пользователя на любой АЗС с оплатой
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Тап "Оплатить"
    - assert: Появилась форма для выбора способа оплаты заправки
    - do: Выбрать СБП как способ оплаты
    - do: Тап "Подтвердить"
    - assert: Происходит переход в ранее установленное приложение

    - platforms:
        - ios
        - android
    - tags:
        - assessors


  Ошибка при оплате заправки по СБП при отсутствии банковского приложения:
    - info: |
        - Пользователь авторизован
        - На девайсе отстуствуют банковские приложения
        - Местоположение пользователя на любой АЗС с оплатой
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Тап "Оплатить"
    - assert: Появилась форма для выбора способа оплаты заправки
    - do: Выбрать СБП как способ оплаты
    - do: Тап "Подтвердить"
    - assert: Отображается список банков

    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi
    - tags:
        - assessors


##  Блок Сервисный сбор в чекауте:
##    - info: |
##        Пользователь авторизован
##        На дейвасе отстуствуют банковские приложения
##        Местоположение пользователя на любой АЗС с оплатой
##        Открыта карточка АЗС с оплатой, рядом с которой находится пользователь
##    - do: |
##        Тап «Заправиться» в карточке заправки
##        Выбрать колонку, топливо , объем/количество литров
##        Тап "Оплатить"
##    - assert: |
##        Появилась форма для выбора способа оплаты заправки
##        В форме присутсвует блок "Работа сервиса"
##    - do: Тап на блок "Работа сервиса"
##    - assert: Появилась информация о блоке "Работа сервиса"
##
##    - platforms:
##        - android
##        - ios
##    - testing:
##       - acceptance_navi


  Форма оплаты (чекаут), отображение если подлключен Я.Плюс:
    - *Info_gas_card_col
    - info: |
        - Пользователь авторизован аккаунтом с Я.Плюс
        - У пользователя есть подписка на Я.Плюс
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" в карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - На ней размещены блоки:
        - Меня заправляет (выбор заправщика)
        - Способ оплаты
        - Баллы плюса
        - Кнопка "Подтвердить"

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут), отображение если не подключен Я.Плюс:
    - *Info_gas_card_col
    - info: Пользователь авторизован аккаунтом без Я.Плюс
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - На ней размещены блоки:
        - Меня заправляет (выбор заправщика)
        - Способ оплаты
        - Кнопка "Подтвердить"

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут). Проверка UI:
    - *Info_gas_card_col
    - info: Пользователь авторизован
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - Отображаются:
        - В Блоке "Меня заправляет" размещена иконка заправщика с подписью "Меня заправляет".
        - Далее есть кнопка "Выбрать"
        - Выводится не более 3 заправщиков с позывными.
        - Отображается чек-бокс "Оставить чаевые"
        - Далее поле "Способ оплаты"
        - В самом низу находится блок "Баллы Плюса" с кнопкой "Подтвердить"
        - Верстка не едет, все элементы отображаюися корректно
    - do: Сменить ориентацию
    - assert: |
        - Отображаются:
        - В Блоке "Меня заправляет" размещена иконка заправщика с подписью "Меня заправляет".
        - Далее есть кнопка "Выбрать"
        - Выводится не более 3 заправщиков с позывными.
        - Отображается чек-бокс "Оставить чаевые"
        - Далее поле "Способ оплаты"
        - В самом низу находится блок "Баллы Плюса" с кнопкой "Подтвердить"
        - Верстка не едет, все элементы отображаюися корректно
    - do: Дождаться смены день/ночь
    - assert: |
        - Карточка заправки не закрывается
        - Элементы в карточке выровнены относительно друг друга
        - Верстка не едет
        - Артефакты противоположной темы отсутствуют

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Форма оплаты (чекаут). Выбор заправщика:
    - *Info_gas_card_col
    - info: Пользователь авторизован
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: Открывается форма оплаты (чекаут).
    - do: Тап на любого из предложенных заправщиков
    - assert: |
        - В блоке "Меня заправляет" отображается только выбранный заправщик
        - Кнопка "Выбрать" и не выбранный заправщик исчезают
    - do: Тап на выбранного заправщика
    - assert: |
        - Выбор сбрасывается,
        - В блоке "Меня заправляет" появляется кнопка "Выбрать"
        - Выводится не более 3 заправщиков с позывными.

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Форма оплаты (чекаут). Ввод данных заправщика:
    - *Info_gas_card_col
    - info: Пользователь авторизован
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: Открывается форма оплаты (чекаут)
    - do: Тап на кнопку "Выбрать"
    - assert: Открывается форма "Выберите заправщика"
    - do: Ввести любой номер телефона
    - do: Тап на кнопку "Подтвердить"
    - assert: |
        - Экран "Выберите заправщика" закрывается.
        - Отображается экран формы оплаты (чекаут)
        - В блоке "Меня заправляет" отображается иконка аватар заправщика с позывным в виде его номера формата +7ХХХ...ХХ

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi
    - tags:
        - assessors


  Чекаут. Оставить Чаевые заправщику в первый раз:
    - *Info_gas_card_col
    - info: |
        - Пользователь авторизован
        - Пользователь оставляет чаевые в первый раз
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: Открывается форма оплаты (чекаут)
    - do: Тап на кнопку "Выбрать"
    - assert: Открывается форма "Выберите заправщика"
    - do: Тап на любой саджест
    - assert: |
        - Экран "Выберите заправщика" закрывается
        - Отображается экран формы оплаты (чекаут)
        - В блоке "Меня заправляет" отображается иконка заправщика
        - Отображается свитчер чаевых в неактивном состоянии
    - do: Тап на свитчер чаевых
    - assert: Открылось мини-вебвью "Чаевые заправщику" с выбором суммы
    - do: Выбрать любую сумму
    - assert: |
        - Мини-вебвью "Чаевые заправщику" с выбором суммы закрывается
        - Свитчер чаевых переключился в активное состояние
        - Отображается надпись "Переведем X руб по завершении заказа"

    - tags:
        - assessors
    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi


  Чекаут. Чаевые заправщику не в первый раз:
    - *Info_gas_card_col
    - info: |
        - Пользователь авторизован
        - Пользователь оставляет чаевые не в первый раз
    - *Отображение_карточки_шаг
    - *Отображение_карточки_результат
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: Открывается форма оплаты (чекаут)
    - do: Тап на кнопку "Выбрать"
    - assert: Открывается форма "Выберите заправщика"
    - do: Тап на любой саджест
    - assert: |
        - Экран "Выберите заправщика" закрывается
        - Отображается экран формы оплаты (чекаут)
        - В блоке "Меня заправляет" отображается иконка заправщика
        - Отображается свитчер чаевых в активном состоянии с надписью "Переведем X руб по завершении заказа"
    - do: Тап на свитчер чаевых
    - assert: Открылось мини-вебвью "Чаевые заправщику" с выбранной суммой
    - do: Тап "Без чаевых"
    - assert: |
        - Закрылось мини-вебвью "Чаевые заправщику" с выбором суммы
        - Свитчер чаевых переключился в неактивное состояние
        - Отобржается надпись "Оставить чаевые"

    - tags:
        - assessors
    - platforms:
        - ios
        - android
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут). Баллы плюса (баллов нет, заказ менее 1000р):
    - info: |
        - Пользователь авторизован аккаунтом, на котором нет бонусных баллов от плюса
        - У пользователя есть подписка на Я.Плюс
        - Добавлена банковская карта в способах оплаты
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Указать кол-во топлива менее 1000руб
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - В блоке "Баллы плюса" указывается информации по акции

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут). Баллы плюса (баллов нет, заказ более 1000р):
    - info: |
        - Пользователь авторизован аккаунтом, на котором нет бонусных баллов от плюса
        - У пользователя есть подписка на Я.Плюс
        - Добавлена банковская карта в способах оплаты
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Указать кол-во топлива более 1000руб
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - В блоке "Баллы плюса" указывается информации по акции
        - Отображается информация по кол-ву баллов, которые накопятся

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут). Баллы плюса (баллы есть, заказ менее 1000р):
    - info: |
        - Пользователь авторизован аккаунтом, на котором есть бонусные баллы от плюса
        - У пользователя есть подписка на Я.Плюс
        - Добавлена банковская карта в способах оплаты
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Указать кол-во топлива менее 1000руб
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - В блоке "Баллы плюса" указывается информации по акции
        - Появляется возможность списать накопленные баллы
    - do: Тап на "Списать"
    - assert: |
        - В свитчере выделяется кнопка "Списать"
        - Кнопка "Подтвердить" становится градиентной, итоговая сумма к оплате уменьшается на кол-во баллов

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Форма оплаты (чекаут). Баллы плюса (баллы есть, заказ более 1000р):
    - info: |
        - Пользователь авторизован аккаунтом, на котором есть бонусные баллы от плюса
        - У пользователя есть подписка на Я.Плюс
        - Добавлена банковская карта в способах оплаты
    - do: Открыть любую карточку организации АЗС с оплатой
    - do: Тап на заправиться
    - do: Выбрать любую колонку и топливо
    - assert: Отображается экран выбора обьема топлива
    - do: Указать кол-во топлива более 1000руб
    - do: Тап на кнопку "Оплатить" на карточке АЗС
    - assert: |
        - Открывается форма оплаты (чекаут)
        - В блоке "Баллы плюса" указывается информации по акции
        - Появляется возможность списать и накопить баллы
    - do: Тап на "Списать"
    - assert: |
        - В свитчере выделяется кнопка "Списать"
        - Кнопка "Подтвердить" становится градиентной, итоговая сумма к оплате уменьшается на кол-во баллов

    - platforms:
        - android
        - ios
    - testing:
        - acceptance_navi


  Скрытие плашек в карточке заправки при смене ориентации:
    - info: |
        - Подменить местоположение на АЗС Тестировочная, Лобное место на Красной площади в Москве
        - Устройство в вертикальной ориентации
    - do: |
        - Использовать интенты:
          [collapsed-image](https://jing.yandex-team.ru/files/midway/download-3-2.png){title=QR-код}

          `yandexnavi://add_exp?navi_feature_gas_stations_force_test_mode=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
        - Перезагрузить приложение
    - do: Тап на колонку в таббаре
    - do: Тап на пин тестировочной азс
    - assert: |
        - Открыватся экран выбора колонки
        - Под колонками отображается плашка "Качество топлива застраховано"
        - Внизу отображается плашка-баннер
    - do: Изменить ориентацию девайса на горизонтальную
    - assert: |
        - Колонки отображаются, верстка не едет
        - Нижний баннер-плашка скрываются

    - platforms:
        - t3am
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi


  Карточка заправки Нави. Наличие крестика в карточке АЗС в вертикольной ориентации:
    - info: |
        Пользователь авторизован
        Устройство в вертикальной ориентации
    - do: |
        Включить эксперименты `navi_feature_gas_stations_layer` и `navi_feature_day_night_fast_switch`
        [collapsed-image](https://jing.yandex-team.ru/files/aamikhailin/YQR%20%2812%29.png){title=QR-код}

        `yandexnavi://add_exp?navi_feature_gas_stations_layer=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
    - do: Перезагрузить приложение
    - do: Подменить местоположение пользователя на территорию полигона АЗС с оплатой (тестировочная АЗС- Москва, Красной площади, Лобное место)
    - do: Тап на колонку в таббаре
    - assert: Отображаются зеленые пины АЗС с оплатой
    - do: Тап по пину АЗС
    - assert: |
        - Отображается тестировочная карточка заправки с выбором колонки
        - Крестик закрытия карточки присутствует
    - do: Тап Заправиться
    - do: Тап на колонку
    - assert: |
        - Отображается экран выбора топлива
        - Крестик закрытия карточки присутствует
    - do: Выбрать топливо
    - assert: |
        - Отображается экран выбора количества топлива
        - Кнопка оплатить
        - Крестик закрытия карточки присутствует
    - do: Ползунком выбрать количество топлива
    - assert: |
        - Отображается выбранное количество топлива
        - Кнопка оплатить
        - Крестик закрытия карточки присутствует
    - do: Тап оплатить
    - assert: Отображается карточка выбора заправщика и способа оплаты
    - do: Тап подтвердить
    - assert: |
        - Проходит оплата
        - Отображается экран залива топлива
        - Крестик отсутствует на экране залива топлива
    - do: Дождаться окончания залива топлива
    - assert: |
        - Открывается экран чека
        - Крестик присутствует на экране чека
    - do: Тап крестик
    - assert: Карточка закрылась

    - platforms:
        - android
        - ios
    - testing:
        - regress


  Карточка заправки Нави. Наличие крестика в карточке АЗС в горизонтальной ориентации:
    - info: |
        Пользователь авторизован
        Устройство в горизонтальной ориентации
    - do: |
        Включить эксперименты `navi_feature_gas_stations_layer` и `navi_feature_day_night_fast_switch`
        [collapsed-image](https://jing.yandex-team.ru/files/aamikhailin/YQR%20%2812%29.png){title=QR-код}

        `yandexnavi://add_exp?navi_feature_gas_stations_layer=enabled&navi_feature_day_night_fast_switch=enabled&navi_feature_gas_stations_layer_geo_search=disabled`
    - do: Перезагрузить приложение
    - do: Подменить местоположение пользователя на территорию полигона АЗС с оплатой (тестировочная АЗС- Москва, Красной площади, Лобное место)
    - do: Тап на колонку в таббаре
    - assert: Отображаются зеленые пины АЗС с оплатой
    - do: Тап по пину АЗС
    - assert: |
        - Отображается тестировочная карточка заправки с выбором колонки
        - Крестик закрытия карточки присутствует
    - do: Тап Заправиться
    - do: Тап на колонку
    - assert: |
        - Отображается экран выбора топлива
        - Крестик закрытия карточки присутствует
    - do: Выбрать топливо
    - assert: |
        - Отображается экран выбора количества топлива
        - Кнопка оплатить
        - Крестик закрытия карточки присутствует
    - do: Ползунком выбрать количество топлива
    - assert: |
        - Отображается выбранное количество топлива
        - Кнопка оплатить
        - Крестик закрытия карточки присутствует
    - do: Тап оплатить
    - assert: Отображается карточка выбора заправщика и способа оплаты
    - do: Тап подтвердить
    - assert: |
        - Проходит оплата
        - Отображается экран залива топлива
        - Крестик отсутствует на экране залива топлива
    - do: Дождаться окончания залива топлива
    - assert: |
        - Открывается экран чека
        - Крестик присутствует на экране чека
    - do: Тап крестик
    - assert: Карточка закрылась

    - platforms:
        - android
        - ios
    - testing:
        - regress


  Предложение оплаты при заезде на АЗС при работе в фоне:
    - do: Построить маршрут через территорию АЗС с оплатой
    - do: Запустить симуляцию со скоростью меньше 25 км/ч
    - do: Дождаться открытия карточки заправки
    - assert: Автоматические открывается карточка заправки на экране "Выбора колонки"
    - do: Свернуть приложение
    - do: Дождаться выезда с территории полигона
    - do: Развернуть приложение
    - assert: Карточка Заправки закрыта

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Предложение оплаты при заезде на АЗС (минимальное состояние карточки):
    - do: Построить маршрут через территорию АЗС с оплатой
    - do: Запустить симуляцию со скоростью меньше 25 км/ч
    - do: Дождаться открытия карточки заправки
    - assert: Автоматические открывается карточка заправки на экране "Выбора колонки"
    - do: Свернуть карточку в минимальное состояние.
    - do: Дождаться выезда из полигона.
    - assert: Карточка закрывается автоматически

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Предложение оплаты при заезде на АЗС (среднее состояние карточки):
    - do: Построить маршрут через территорию АЗС с оплатой
    - do: Запустить симуляцию со скоростью меньше 25 км/ч
    - do: Дождаться открытия карточки заправки
    - assert: Автоматические открывается карточка заправки на экране "Выбора колонки" в среднем состоянии
    - do: Дождаться выезда из полигона.
    - assert: Карточка закрывается автоматически

    - platforms:
        - ios
        - t3am
        - android
    - tags:
        - assessors


  Кнопка "Заправиться" около АЗС при авиарежиме:
    - do: Построить маршрут, проходящий рядом с АЗС с оплатой
    - do: Запустить симуляцию движения со скоростью не выше 10 км/ч
    - do: Дождаться появления кнопки "заправиться"
    - assert: Над плашкой ЕТА отображается  кнопка “Заправиться”
    - do: Перевести девайс в авиарежим
    - do: Тап на кнопку “Заправиться”
    - assert: Открывается карточка заправки на экране "Выбора колонки" с сообщением об отсутствии интернета
    - do: Отключить авиарежим
    - do: Тап на кнопку "Повторить"
    - assert: Данные карточки подгружаются

    - platforms:
        - ios
        - android
    - tags:
        - assessors
    - testing:
        - acceptance_navi
