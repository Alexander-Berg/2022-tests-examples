// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM mail/backend/folder-navigator-backend.ts >>>

package com.yandex.xplat.testopithecus

import com.yandex.xplat.common.*
import com.yandex.xplat.eventus.common.*
import com.yandex.xplat.eventus.*
import com.yandex.xplat.mapi.*
import com.yandex.xplat.testopithecus.common.*

public open class FolderNavigatorBackend(private var mailListDisplayBackend: MessageListDisplayBackend, private var clientsHandler: MailboxClientHandler): FolderNavigator {
    open override fun ptrFoldersList(): Unit {
    }

    open override fun getFoldersList(): YSMap<FolderName, Int> {
        val folderToUnread = mutableMapOf<FolderName, Int>()
        this.clientsHandler.getCurrentClient().getFolderList().forEach( {
            meta ->
            folderToUnread.set(meta.name!!, meta.unreadCounter)
        })
        return folderToUnread
    }

    open override fun goToFolder(folderDisplayName: String, parentFolders: YSArray<String>): Unit {
        val folderBackendName = toBackendFolderName(folderDisplayName, parentFolders)
        val folder = this.clientsHandler.getCurrentClient().getFolderList().filter( {
            f ->
            f.name == folderBackendName
        })[0]
        this.mailListDisplayBackend.setCurrentFolderId(folder.fid)
    }

    open override fun getCurrentContainer(): String? {
        val currentFolderName = this.clientsHandler.getCurrentClient().getFolderList().filter( {
            meta ->
            meta.fid == this.mailListDisplayBackend.getCurrentFolderId()
        })[0].name!!
        return currentFolderName
    }

    open override fun closeFolderList(): Unit {
    }

    open override fun openFolderList(): Unit {
    }

    open override fun isInTabsMode(): Boolean {
        val currentSettings = this.clientsHandler.getCurrentClient().getSettings()
        return currentSettings.payload!!.userParameters.showFoldersTabs
    }

}

