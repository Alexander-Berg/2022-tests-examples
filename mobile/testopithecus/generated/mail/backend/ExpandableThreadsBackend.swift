// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM mail/backend/expandable-threads-backend.ts >>>

import Foundation

open class ExpandableThreadsBackend: ExpandableThreads {
  private var messageListDisplayBackend: MessageListDisplayBackend
  private var clientsHandler: MailboxClientHandler
  public init(_ messageListDisplayBackend: MessageListDisplayBackend, _ clientsHandler: MailboxClientHandler) {
    self.messageListDisplayBackend = messageListDisplayBackend
    self.clientsHandler = clientsHandler
  }

  @discardableResult
  open func collapseThread(_ order: Int32) throws -> Void {
    return
  }

  @discardableResult
  open func expandThread(_ order: Int32) throws -> Void {
    return
  }

  @discardableResult
  open func markThreadMessageAsRead(_ threadOrder: Int32, _ messageOrder: Int32) throws -> Void {
    let message = self.getMessageInThread(threadOrder, messageOrder)
    self.clientsHandler.getCurrentClient().markMessageAsRead(message.mid)
  }

  @discardableResult
  open func markThreadMessageAsUnRead(_ threadOrder: Int32, _ messageOrder: Int32) throws -> Void {
    let message = self.getMessageInThread(threadOrder, messageOrder)
    self.clientsHandler.getCurrentClient().markMessageAsUnread(message.mid)
  }

  @discardableResult
  private func getMessageInThread(_ threadOrder: Int32, _ messageOrder: Int32) -> MessageMeta {
    let thread = self.messageListDisplayBackend.getThreadMessage(threadOrder)
    let messages = self.clientsHandler.getCurrentClient().getMessagesInThread(thread.tid!, messageOrder + 1)
    return messages[messageOrder]
  }

}

