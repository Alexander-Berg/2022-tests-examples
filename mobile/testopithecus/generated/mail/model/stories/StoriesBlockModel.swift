// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM mail/model/stories/stories-block-model.ts >>>

import Foundation

open class StoriesBlockModel: StoriesBlock {
  public var hideClickedFlag: Bool = false
  public var displaysLeft: Int32 = 10
  public var container: MessageContainer! = nil
  public init() {
  }

  @discardableResult
  open func hideStories() throws -> Void {
    Log.info("Hiding all stories")
    self.hideClickedFlag = true
  }

  @discardableResult
  open func openStory(_ position: Int32) throws -> Void {
    Log.info("Opening story at \(position) position")
  }

  @discardableResult
  open func isHidden() throws -> Bool {
    return (self.hideClickedFlag || self.displaysLeft < 0 || !(self.container != nil && self.container!.type == MessageContainerType.folder && self.container!.name == DefaultFolderName.inbox))
  }

  open func blockShown() -> Void {
    if self.displaysLeft >= 0 {
      self.displaysLeft = self.displaysLeft - 1
    }
  }

}

open class StoriesBlockViewCounter: RotateListener, ContainerListener {
  private var model: StoriesBlockModel
  private var messageListDisplayModel: MessageListDisplayModel
  public init(_ model: StoriesBlockModel, _ messageListDisplayModel: MessageListDisplayModel) {
    self.model = model
    self.messageListDisplayModel = messageListDisplayModel
    self.model.container = messageListDisplayModel.getCurrentContainer()
  }

  open func blockShown() -> Void {
    self.model.blockShown()
  }

  open func folderOpened(_ container: MessageContainer) -> Void {
    self.model.container = container
    if container.type == MessageContainerType.folder && container.name == DefaultFolderName.inbox {
      self.blockShown()
    }
  }

  open func rotated(_ landscape: Bool) -> Void {
    self.folderOpened(self.messageListDisplayModel.getCurrentContainer())
  }

  open func containerChanged(_ container: MessageContainer) -> Void {
    self.folderOpened(container)
  }

}

