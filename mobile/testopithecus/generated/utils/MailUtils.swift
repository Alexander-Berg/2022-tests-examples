// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM utils/mail-utils.ts >>>

import Foundation

@discardableResult
public func reduced(_ id: ID) -> String {
  let s = id.toString()
  return s.slice(s.length - 3, s.length)
}

@discardableResult
public func getRandomInt32(_ max: Int32) -> Int32 {
  return doubleToInt32(floorDouble(randomDouble() * int32ToDouble(max))) % max
}

@discardableResult
public func display(_ email: Email) -> String {
  return "\(email.login)@\(email.domain)"
}

@discardableResult
public func formatFolderName(_ folderName: FolderName, _ parentFolders: YSArray<FolderName> = YSArray()) -> FolderName {
  let result = copyArray(parentFolders)
  result.push(folderName)
  return result.join("|")
}

@discardableResult
public func fakeMid() -> Int64 {
  return int64(-1)
}

@discardableResult
public func resolveThrow<T>(_ action: @escaping () throws -> T, _ defVal: T) -> T {
  do {
    return (try action())
  } catch {
    let e = error
    return defVal
  }
}

@discardableResult
public func removeAllNonLetterSymbols(_ str: String) -> String {
  let tags = YSArray("<br />", "<p>", "</p>", "<br>", "\r", "\n")
  var result = str
  tags.forEach({
    (tag) in
    result = stringReplaceAll(result, tag, "")
  })
  return result
}

@discardableResult
public func formatLogin(_ login: String) -> String {
  let index = login.lastIndexOf("-")
  return "\(login.slice(0, index)).\(login.slice(index + 1, login.length))"
}

open class TextGenerator {
  public static var basicLatin: String = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_-+=/|~:; "
  public static var lowerCaseLatin: String = "abcdefghijklmnopqrstuvwxyz"
  @discardableResult
  open func generateRandomString(_ charSet: String, _ length: Int32) -> String {
    let result: YSArray<String> = YSArray()
    while result.length < length {
      result.push(charSet.split("")[getRandomInt32(charSet.length)])
    }
    return result.join("")
  }

}

