// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM tests/pin-tests.ts >>>

package com.yandex.xplat.testopithecus

import com.yandex.xplat.common.*
import com.yandex.xplat.eventus.common.*
import com.yandex.xplat.eventus.*
import com.yandex.xplat.mapi.*
import com.yandex.xplat.testopithecus.common.*

public open class TurnOnPinTest(): RegularYandexMailTestBase("Pin. Установка входа по паролю") {
    private var password: String = "1234"
    open override fun setupSettings(settings: TestSettings): Unit {
        settings.iosCase(87).androidCase(9861)
    }

    open override fun prepareAccount(builder: MailboxBuilder): Unit {
    }

    open override fun testScenario(account: UserAccount): TestPlan {
        return this.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(this.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(this.password))
    }

}

public open class TurnOffPinTest(): RegularYandexMailTestBase("Pin. Отключение входа по паролю") {
    private var password: String = "1234"
    open override fun setupSettings(settings: TestSettings): Unit {
        settings.iosCase(119).androidCase(11163)
    }

    open override fun prepareAccount(builder: MailboxBuilder): Unit {
    }

    open override fun testScenario(account: UserAccount): TestPlan {
        return this.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(this.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(this.password)).then(TurnOffLoginUsingPasswordAction()).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState())
    }

}

public open class ChangePinTest(): RegularYandexMailTestBase("Pin. Изменение пароля") {
    private var password: String = "1234"
    private var newPassword: String = "5678"
    open override fun setupSettings(settings: TestSettings): Unit {
        settings.iosCase(88).androidCase(11164)
    }

    open override fun prepareAccount(builder: MailboxBuilder): Unit {
    }

    open override fun testScenario(account: UserAccount): TestPlan {
        return this.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(this.password)).then(ChangePasswordAction(this.newPassword)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(this.newPassword)).then(ChangePasswordAction(this.newPassword))
    }

}

public open class ResetPinTest(): MBTTest<MailboxBuilder>("Pin. Сброс пароля") {
    private var password: String = "1234"
    open override fun requiredAccounts(): YSArray<AccountType2> {
        return mutableListOf(AccountType2.Yandex, AccountType2.Yandex)
    }

    open override fun setupSettings(settings: TestSettings): Unit {
        settings.iosCase(103).androidCase(9771)
    }

    open override fun prepareAccounts(preparers: YSArray<MailboxBuilder>): Unit {
        preparers[0].nextMessage("subj1")
        preparers[1].nextMessage("subj2")
    }

    open override fun scenario(accounts: YSArray<UserAccount>, _model: AppModel?, _supportedFeatures: YSArray<FeatureID>): TestPlan {
        return TestPlan.empty().then(YandexLoginAction(accounts[0])).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(this.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(ResetPasswordAction()).then(YandexLoginAction(accounts[1])).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction())
    }

}

