// <<< AUTOGENERATED BY YANDEX.SCRIPT FROM tests/pin-tests.ts >>>

import Foundation

open class TurnOnPinTest: RegularYandexMailTestBase {
  private var password: String = "1234"
  public init() {
    super.init("Pin. Установка входа по паролю")
  }

  open override func setupSettings(_ settings: TestSettings) -> Void {
    settings.iosCase(87).androidCase(9861)
  }

  open override func prepareAccount(_ builder: MailboxBuilder) -> Void {
  }

  @discardableResult
  open override func testScenario(_ account: UserAccount) -> TestPlan {
    return self.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(self.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(self.password))
  }

}

open class TurnOffPinTest: RegularYandexMailTestBase {
  private var password: String = "1234"
  public init() {
    super.init("Pin. Отключение входа по паролю")
  }

  open override func setupSettings(_ settings: TestSettings) -> Void {
    settings.iosCase(119).androidCase(11163)
  }

  open override func prepareAccount(_ builder: MailboxBuilder) -> Void {
  }

  @discardableResult
  open override func testScenario(_ account: UserAccount) -> TestPlan {
    return self.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(self.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(self.password)).then(TurnOffLoginUsingPasswordAction()).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState())
  }

}

open class ChangePinTest: RegularYandexMailTestBase {
  private var password: String = "1234"
  private var newPassword: String = "5678"
  public init() {
    super.init("Pin. Изменение пароля")
  }

  open override func setupSettings(_ settings: TestSettings) -> Void {
    settings.iosCase(88).androidCase(11164)
  }

  open override func prepareAccount(_ builder: MailboxBuilder) -> Void {
  }

  @discardableResult
  open override func testScenario(_ account: UserAccount) -> TestPlan {
    return self.yandexLogin(account).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(self.password)).then(ChangePasswordAction(self.newPassword)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(EnterPasswordAction(self.newPassword)).then(ChangePasswordAction(self.newPassword))
  }

}

open class ResetPinTest: MBTTest<MailboxBuilder> {
  private var password: String = "1234"
  public init() {
    super.init("Pin. Сброс пароля")
  }

  @discardableResult
  open override func requiredAccounts() -> YSArray<AccountType2> {
    return YSArray(AccountType2.Yandex, AccountType2.Yandex)
  }

  open override func setupSettings(_ settings: TestSettings) -> Void {
    settings.iosCase(103).androidCase(9771)
  }

  open override func prepareAccounts(_ preparers: YSArray<MailboxBuilder>) -> Void {
    preparers[0].nextMessage("subj1")
    preparers[1].nextMessage("subj2")
  }

  @discardableResult
  open override func scenario(_ accounts: YSArray<UserAccount>, _ _model: AppModel!, _ _supportedFeatures: YSArray<FeatureID>) -> TestPlan {
    return TestPlan.empty().then(YandexLoginAction(accounts[0])).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction()).then(TurnOnLoginUsingPasswordAction(self.password)).then(GoToBackgroundState()).then(WaitForPinToTriggerAction()).then(GoToForegroundState()).then(ResetPasswordAction()).then(YandexLoginAction(accounts[1])).then(OpenFolderListAction()).then(OpenSettingsAction()).then(OpenGeneralSettingsAction())
  }

}

