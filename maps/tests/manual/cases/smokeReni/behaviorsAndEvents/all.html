<!DOCTYPE HTML>
<!--
Title:
Поведение и события на картах

Description:
Поведение карты: Пользовательское взаимодействие.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
smoke

Estimated time: 
1200000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней. 

  Expectation:
  Карта отобразилась корректно.
  На карте спан Москвы, по центру спана два ряда элементов синего и зеленого цвета: метка, кривая линия, многоугольник, прямоугольник, круг. 
  Сверху справа имеется кнопка "behavior" с выпадающим списком.

Step:
  Action:
  Навести курсор на элементы на спане.
  Попробовать взаимодействовать с картой: масштабировать дабл-зумом ПКМ/ЛКМ, перемещать карту зажав ЛКМ.

  Expectation:
  При наведении курсором имеется ховер эффект - палец.
  Карта не реагирует на взаимодействие.

Step:
  Action:
  Кликнуть в кнопку "behavior", выбрать кликом "dblClickZoom" и "drag".
  Дабл-кликом ПКМ отзумится до крайнего значения(карта с материками).

  Expectation:
  Происходит корректный отзум: нет миганий, постепенно меняется отрисовка карты(пропадает цветовая рельефность, подписи)
  На последнем значении зума на карте из элементов только метка.

Step:
  Action:
  Дабл-кликом ЛКМ призумится к спану карты до максимума.
  
  Expectation:
  Происходит корректный зум: нет миганий, постепенно меняется отрисовка карты(появляются подписи, появляется цветовая рельефность)
  На последнем значении зума на карте метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выполнить отзум карты дабл тачем на тачпаде.
  
  Expectation:
  Происходит корректный отзум: нет миганий, постепенно меняется отрисовка карты(пропадает цветовая рельефность, подписи)
  На последнем значении зума на карте на карте из элементов только метка.

Step:
  Action:
  Выполнить призум карты дабл тачем на тачпаде.
  
  Expectation:
  Происходит корректный зум карты: нет миганий, постепенно меняется отрисовка карты(появляются подписи, появляется цветовая рельефность)
  На последнем значении зума на карте метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
  (Для выполнения следующего шага в списке "behavior" выбрать "scrollZoom", отзумить карту на уровень соотвестующий первому шагу, затем отключить опцию "scrollZoom")

Step:
  Action:
  С зажатой ЛКМ дёрнули карту немного вправо-влево(статичный драг), вверх вниз несколько раз.
  
  Expectation:
  Перемещение карты драгом корректное: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.

Step:
  Action:
  Выполнить инертный драг: зажав ЛКМ дернули карту с усилием и отпустили ЛКМ, так, что спан карты продолжит движение до остановки.
  
  Expectation:
  Перемещение карты драгом корректное: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.

Step:
  Action:
  Выполнить статичный и инертный драг карты тачем на тачпаде несколько раз.
  
  Expectation:
  Перемещение карты драгом корректное: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.

Step:
  Action:
  Кликнуть в кнопку "behavior", кликом отключить опции "dblClickZoom" и "drag", кликнуть в списке "multiTouch".
  * Опция воспроизводится на ноутбуках с включенной опцией сенсорного экрана, планшетах, тач-девайсах.
  Выполнить зум/отзум карты пинч-зумом(двумя пальцами). Если у вас опции нет или окружение не предусматривает проверку тест кейса переходите к следующему шагу.
    
  Expectation:
  Зум/отзум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При отзуме постепенно меняется отрисовка карты(пропадает цветовая рельефность, подписи)
  При зуме постепенно появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "multiTouch", кликнуть в списке "routeEditor".
  Кликнуть в любое место на карте.  
  
  Expectation:
  В месте клика появляется метка с цифрой "1".

Step:
  Action:
  Кликнуть в другое место на карте на удалении от метки "1".

  Expectation:
  В месте клика появляется метка с цифрой "2".
  Между меткой "1" и меткой "2" появляется фиолетовая нитка маршрута.

Step:
  Action:
  Провести курсором по линии маршрута, затем кликнуть в метку "1".

  Expectation:
  На линии маршрута курсор меняется на палец, по линии маршрута с курсором перемещается белая круглая метка.
  При клике в метку "1" на карте появляется балун с координатами местоположения метки.

Step:
  Action:
  Закрыть балун метки "1" кликом в крестик.
  Навести курсор на центр нитки маршрута, зажать ЛКМ и переставить белую метку в сторону от линии маршрута.

  Expectation:
  При оттаскивании маршрутная линия перестраивается с учетом местоположения перемещенной белой метки.

Step:
  Action:
  Дабл-клик в белую промежуточную метку маршрута, выставленную на прошлом шаге.
  
  Expectation:
  Белая метка пропадает, маршрутная линия перестраивается, строя маршрут между метками "1" и "2".

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "routeEditor", кликнуть в списке "ruler".
  Кликнуть в любое место на карте.  
  
  Expectation:
  В месте клика появляется белая круглая метка с серым контуром.
  (Маршрутные метки "1" и "2" и нитка маршрута построенные на предыдущем шаге остались без изменений)

Step:
  Action:
  Кликнуть в другое место на карте на удалении от первой метки.  
  
  Expectation:
  В месте клика появляется еще одна белая круглая метка с серым контуром, с балуном с расстоянием между метками.
  Между метками появляется прямая серая линия линейки.

Step:
  Action:
  Провести курсором по линии.
  Навести курсор на центр линии, зажать ЛКМ и переставить серую метку в сторону от линии.  
  
  Expectation:
  Курсор меняется на палец, на линии измерителя к пальцу прилипает серая метка с хинтом с расстоянием от первой метки, при перемещении данные в хинте меняются.
  В месте клика появляется еще одна круглая белая метка с сервым контуром, хинт пропадает, при перетаскивании метки линия измерителя разделилась на два отрезка, данные о расстоянии между отрезками между метками меняются в балуне у конечной метки. 

Step:
  Action:
  Навести курсор на метку созданную на предыдущем шаге.
  Дабл-клик по указанной метке.  
  
  Expectation:
  Курсор меняется на палец, появляется хинт с расстоянием от первой метки. Балун с расстоянием на последней метке не пропадает.
  Метка пропадает, линия измерителя перестраивается между двумя метками. Балун с расстоянием на последней метке не пропадает.

Step:
  Action:
  Кликнуть в крестик балуна с расстоянием на последней метке.
    
  Expectation:
  Метки линейки и линия измерения на карте пропадают.
  
Step:
  Action:
  Выставить на карте 4 метки линейки, кликом ЛКМ в разные места карты.
  
  Expectation:
  При каждом клике на карте появляется круглая белая метка с серым контуром. 
  Со второй метки между метками появляется прямая серая линия измерителя.
  Со второй метки - появляется балун с расстоянием, который перемещается к крайней метке при выставлении 3 и 4 метки.

Step:
  Action:
  Кликнуть в крестик балуна с расстоянием на последней метке.
    
  Expectation:
  Появляется диалоговое окно удаления всех меток и подсказкой для удаления одной метки. В окне имеются кнопки "Да", "Нет".

Step:
  Action:
  Кликнуть на кнопку "Да" в диалоговом окне. 
    
  Expectation:
  Элементы измерения расстояний пропали с карты, остальные элементы на карте без изменений.

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "ruler", кликнуть в списке "scrollZoom".
  Кликнуть в любое место на карте, для пропадания списка "behavior".
  Выполнить максимальный отзум карты скроллом мыши.
  
  Expectation:
  Отзум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При отзуме постепенно меняется отрисовка карты (пропадает цветовая рельефность, подписи).

Step:
  Action:
  Выполнить максимальный призум карты скроллом мыши.
  
  Expectation:
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выполнить максимальный отзум карты скроллом на тачпаде.
  
  Expectation:
  Отзум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При отзуме постепенно меняется отрисовка карты (пропадает цветовая рельефность, подписи).

Step:
  Action:
  Выполнить максимальный призум карты скроллом на тачпаде.
  
  Expectation:
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
  (Для выполнения следующего шага в списке, отзумить скролом мыши карту на уровень соотвестующий первому шагу)

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "scrollZoom", кликнуть в списке "leftMouseButtonMagnifier".
  Кликнуть в любое место на карте, для пропадания списка "behavior".
    
  Expectation:
  Курсор изменился на лупу с плюсом. 
  
Step:
  Action:
  Зажав ЛКМ перемещаем курсор выделяя при этом на карте область, после чего отпускаем ЛКМ.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выделить область на карте для призума при помощи тачпада.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выделяя область на карте ЛКМ выполнить максимальный призум.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
  (Для выполнения следующего шага в списке "behavior" выбрать "scrollZoom", отзумить карту на уровень соотвестующий первому шагу, затем отключить опцию "scrollZoom")

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "leftMouseButtonMagnifier", кликнуть в списке "rightMouseButtonMagnifier".
  Кликнуть в любое место на карте, для пропадания списка "behavior".
    
  Expectation:
  Курсор стал стандартным - стрелка. 

Step:
  Action:
  Зажав ПКМ переместить курсор выделяя при этом на карте область, после чего отпускаем ПКМ.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выделить область на карте для призума на тачпада.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выделяя область на карте ПКМ выполнить максимальный призум.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
  (Для выполнения следующего шага в списке "behavior" выберить "scrollZoom" и произведите отзум карты на уровень соотвестующий первому шагу, затем отключите опцию "scrollZoom")

Step:
  Action:
  Кликнуть в кнопку "behavior", отключить опцию "rightMouseButtonMagnifier". 
  Последовательно включить(выставить галочку) напротив опций "dblClickZoom","drag", "multiTouch", "routeEditor".
  Кликнуть в любое место на карте, для пропадания списка "behavior".
    
  Expectation:
  При клике в карту на ней появляется метка "1".
  Остальные элементы карты без изменений.

Step:
  Action:
  Кликнуть в другое место на карте на удалении от метки "1".

  Expectation:
  В месте клика появляется метка с цифрой "2".
  Между меткой "1" и меткой "2" появляется фиолетовая нитка маршрута.

Step:
  Action:
  Выполнить дабл-клик ЛКМ(на несколько значений зума).
  Выполнить дабл-клик ПКМ(на несколько значений зума).
  Выполнить дабл-тач используя тачпад(на несколько значений зума).
  
  Expectation:
  Происходит зум/отзум карты, при этом: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.

Step:
  Action:
  Зажав ЛКМ подергать карту влево-вправо, вверх-вниз(статичный драг).
  Зажав ЛКМ дернули карту с усилием и отпустили ЛКМ, так, что спан карты продолжит движение до остановки(инертный драг).
  Повторить статичный и инертный драг карты с помощью тачпада.  

  Expectation:
  Перемещение карты драгом корректное: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.

Step:
  Action:
  Выполнить зум/отзум карты пинч-зумом(двумя пальцами).
  * Опция "miltiYouch" воспроизводится на ноутбуках с включенной опцией сенсорного экрана, планшетах, тач-девайсах.
      
  Expectation:
  Зум/отзум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При отзуме постепенно меняется отрисовка карты(пропадает цветовая рельефность, подписи)
  При зуме постепенно появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Кликнуть в кнопку "behavior". 
  Не отключая других опций, последовательно включить(выставить галочку) напротив опций "ruler", "scrollZoom", "leftMouseButtonMagnifier", "rightMouseButtonMagnifier".
  Кликнуть в любое место на карте, для пропадания списка "behavior".
    
  Expectation:
  При клике в карту на ней появляется круглая белая метка с серым контуром.
  Остальные элементы карты без изменений.

Step:
  Action:
  Кликнуть в другое место на карте на удалении от первой метки.  
  
  Expectation:
  В месте клика появляется еще одна белая круглая метка с серым контуром, над которой появляется балун с расстоянием между метками.
  Между метками появляется прямая серая линия линейки.

Step:
  Action:
  Выполнить максимальный зум карты скроллом мыши.
  
  Expectation:
  Отзум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При отзуме постепенно меняется отрисовка карты (пропадает цветовая рельефность, подписи).

Step:
  Action:
  Выполнить максимальный отзум карты скроллом при помощи тачпада.
  
  Expectation:
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.

Step:
  Action:
  Выделяя область на карте ЛКМ выполнить максимальный призум.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
  (Для выполнения следующего шага скролом мыши произвести отзум карты на уровень соотвестующий первому шагу)

Step:
  Action:
  Зажав ПКМ перемещаем курсор выделяя при этом на карте область, после чего отпускаем ПКМ.
    
  Expectation:
  Происходит призум выделенной области.
  Зум работает корректно: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при масштабировании карты.
  При зуме постепенно меняется отрисовка карты: появляются подписи, рельефность, метки организаций - ПОИ, подписи дорог, иконки остановок, стрелки направления движений на некоторых дорогах.
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <script src="../../../helper.js"></script>
    <script src="../../../js/geoCS.js"></script>
    <script type=text/javascript>

        Api('init');

        function init(ymaps) {
            ymaps = ym;

            var map = myMap = new ym.Map('map', {
                center: [55.73259667357658, 37.70153663432529],
                zoom: 9,
                behaviors: [],
                controls: ['fullscreenControl']
            }, {
                backgroundVisible: false
            }), i, control;

            addGrid(myMap);
            var log = new Log();
            geoCSSource(ym, myMap, this);

            log.info('All behaviors disabled.');
            log.info('Choose behavior from listbox to enable.');

            var collection = new ymaps.GeoObjectCollection();
            collection
                    .add(geoObjectPlacemark)
                    .add(geoObjectPolyline)
                    .add(geoObjectPolygon)
                    .add(geoObjectRectangle)
                    .add(geoObjectCircle)
                    .add(placemark)
                    .add(polyline)
                    .add(polygon)
                    .add(rectangle)
                    .add(circle);
            map.geoObjects.add(collection);

            var items = [
                new ymaps.control.ListBoxItem({data: {content: 'dblClickZoom'}}),
                new ymaps.control.ListBoxItem({data: {content: 'drag'}}),
                new ymaps.control.ListBoxItem({data: {content: 'multiTouch'}}),
                new ymaps.control.ListBoxItem({data: {content: 'routeEditor'}}),
                new ymaps.control.ListBoxItem({data: {content: 'ruler'}}),
                new ymaps.control.ListBoxItem({data: {content: 'scrollZoom'}}),
                new ymaps.control.ListBoxItem({data: {content: 'leftMouseButtonMagnifier'}}),
                new ymaps.control.ListBoxItem({data: {content: 'rightMouseButtonMagnifier'}})
            ];

            var behaviorButton = new ymaps.control.ListBox({
                data: {
                    content: 'behavior',
                    title: 'behavior'
                },
                items: items
            });

            behaviorButton.get(0).events
                    .add('select', function (e) {
                        enable('dblClickZoom')
                    })
                    .add('deselect', function (e) {
                        disable('dblClickZoom')
                    });
            behaviorButton.get(1).events
                    .add('select', function (e) {
                        enable('drag')
                    })
                    .add('deselect', function (e) {
                        disable('drag')
                    });
            behaviorButton.get(2).events
                    .add('select', function (e) {
                        enable('multiTouch')
                    })
                    .add('deselect', function (e) {
                        disable('multiTouch')
                    });
            behaviorButton.get(3).events
                    .add('select', function (e) {
                        enable('routeEditor')
                    })
                    .add('deselect', function (e) {
                        disable('routeEditor')
                    });
            behaviorButton.get(4).events
                    .add('select', function (e) {
                        enable('ruler')
                    })
                    .add('deselect', function (e) {
                        disable('ruler')
                    });
            behaviorButton.get(5).events
                    .add('select', function (e) {
                        enable('scrollZoom')
                    })
                    .add('deselect', function (e) {
                        disable('scrollZoom')
                    });
            behaviorButton.get(6).events
                    .add('select', function (e) {
                        enable('leftMouseButtonMagnifier')
                    })
                    .add('deselect', function (e) {
                        disable('leftMouseButtonMagnifier')
                    });
            behaviorButton.get(7).events
                    .add('select', function (e) {
                        enable('rightMouseButtonMagnifier')
                    })
                    .add('deselect', function (e) {
                        disable('rightMouseButtonMagnifier')
                    });

            map.controls.add(behaviorButton, {float: 'right'});

            function enable(behavior) {
                map.behaviors.enable([behavior]);
                log.info(behavior + ' is enabled')
            }

            function disable(behavior) {
                map.behaviors.disable([behavior]);
                log.info(behavior + ' is disabled')
            }

        }
    </script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
<div style="height: 1512px; width: 1512px;"></div>
</body>
</html>