<!DOCTYPE HTML>
<!--
Title:
Маршрутная панель

Description:
Проверяем построение маршрутов с маршрутной панелью.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
smoke

Estimated time: 
270000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней.

  Expectation:
  Карта отобразилась корректно.
  На карте спан Москвы.
  На спане карты выставлена метка "А" c данными: "улица Льва Толстого, 16".
  Сверху слева имеется маршрутная панель с инпутами ввода, при этом верхний инпут автоматически заполняется данными метки(улица Льва Толстого, 16).
  Справа от маршрутной панели кнопка "Поменять точки ме...".
  К курсору прилипает метка "B".
  Инпут точки "B" активный, рамка инпута желтая. В инпуте мигает каретка, имеется стрелка контрола местоположения.

Step:
  Action:
  Ввести в инпут "Мытищи", нажать Enter.

  Expectation:
  Смена спана и призум на построенный маршрут.
  В области видимости маршрут на общественном транспорте с метками "А" - улица Льва Толстого, 16, "B" - Мытищи. Основная маршрутная линия - фиолетовая. Альтернативная - серая.
  На маршруте имется метки с видами общественного транспорта - метка метро (Парк культуры), метка электрички(Москва(Ярославский вокзал)), метка маршрутки (Станция Мытищи).

Step:
  Action:
  Последовательно призумится к меткам "A" и "B".

  Expectation:
  При призуме на маршруте возмле меток "A" и "B" появляются пешеходные метки с данными о времени и расстоянии маршрута.

Step:
  Action:
  Выполнить отзум для обозрения всего маршрута.
  Выполнить клик в иконку человека в маршрутной панели(сменить тип маршрута).

  Expectation:
  На спане перестраивается маршрут, меняется маршрутная линия - становится пунктирной, появляется пешеходная метка с расстоянием.

Step:
  Action:
  Клик в линию маршрута.

  Expectation:
  Открывается балун с иконкой человека, временем "4 ч 49 мин" расстоянием "24 км", и кнопкой "Подробнее".

Step:
  Action:
  Клик в кнопку "Поменять точки ме...".

  Expectation:
  В маршрутной панели меняются местами значения в инпутах точек "A" и "B", на спане карты меняются местами маршрутные метки "A" и "B".

Step:
  Action:
  Клик в линию маршрута.

  Expectation:
  Открывается балун с иконкой человека, временем "4 ч 49 мин" расстоянием "24 км", и кнопкой "Подробнее".
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="../../../helper.js"></script>
    <script type=text/javascript>

        Api('init');

        function init(ymaps) {
                var myMap = new ymaps.Map('map', {
                    center: [55.753994, 37.622093],
                    zoom: 9,
                    // Добавим панель маршрутизации.
                    controls: ['routePanelControl']
                }, {
                    backgroundVisible: false
                });

                var control = myMap.controls.get('routePanelControl');

                // Зададим состояние панели для построения машрутов.
                control.routePanel.state.set({
                    // Тип маршрутизации.
                    type: 'masstransit',
                    // Выключим возможность задавать пункт отправления в поле ввода.
                    fromEnabled: false,
                    // Адрес или координаты пункта отправления.
                    from: 'Москва, Льва Толстого 16',
                    // Включим возможность задавать пункт назначения в поле ввода.
                    toEnabled: true
                    // Адрес или координаты пункта назначения.
                    //to: 'Петербург'
                });

                // Зададим опции панели для построения машрутов.
                control.routePanel.options.set({
                    // Запрещаем показ кнопки, позволяющей менять местами начальную и конечную точки маршрута.
                    allowSwitch: false,
                    // Включим определение адреса по координатам клика.
                    // Адрес будет автоматически подставляться в поле ввода на панели, а также в подпись метки маршрута.
                    reverseGeocoding: true,
                    // Зададим виды маршрутизации, которые будут доступны пользователям для выбора.
                    types: { masstransit: true, pedestrian: true }
                });

                // Создаем кнопку, с помощью которой пользователи смогут менять местами начальную и конечную точки маршрута.
                var switchPointsButton = new ymaps.control.Button({
                    data: {content: "Поменять точки местами", title: "Поменять точки местами"},
                    options: {selectOnClick: false, maxWidth: 160}
                });
                // Объявляем обработчик для кнопки.
                switchPointsButton.events.add('click', function () {
                    // Меняет местами начальную и конечную точки маршрута.
                    control.routePanel.switchPoints();
                });
                myMap.controls.add(switchPointsButton);
        }
    </script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>
