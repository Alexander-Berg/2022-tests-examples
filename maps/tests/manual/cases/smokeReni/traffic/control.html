<!DOCTYPE HTML>
<!--
Title:
Карта с отображением пробок с инфоточками

Description:
Создаем карту с отображением пробок и инфоточек.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
smoke

Estimated time: 
270000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней. 

  Expectation:
  Карта отобразилась корректно, со спаном СПб.
  Сверху справа контрол пробок - активен, передает актуальную информацию о пробках, со временем передачи актуальной информации и обозначением дорожной ситуации вида: "3 балла".
  На карте линии пробок(зеленые, желтые, красные линии), имеются метки дорожных событий.
  
Step:
  Action:
  Навести курсор на нитки пробочных линий различных цветов.

  Expectation:
  При наведении курсора на линии в хинте появляется информация о скорости на участке вида "40 км/ч".

Step:
  Action:
  Навести курсор на метки дорожных событий.

  Expectation:
  При наведении курсора на метку появляется хинт с отображением информации о дорожном событии. 
  Виды событий: метка с а/м - хинт "ДТП"; метка c рабочими - хинт "Дорожные работы"; метка с мостом - хинт "Развод моста"; метка с кирпичем - хинт "Перекрытие движения"; метка с восклицательным знаком - хинт "Прочее".
  
Step:
  Action:
  Выполнить призум к текущему спану карты на 3 значения скрол колесика мыши.
  
  Expectation:
  Происходит корректный призум карты: карта не мигает, не пропадает.
  Пробочные лини отображаются на спане карты, метки доожных событий также имеются на спане карты.

Step:
  Action:
  Зажав ЛКМ поперемещать спан карты (выполнить статичный и инертный драг карты).

  Expectation:
  Перемещение карты корректное: карта не мигает, не пропадает.
  Пробочные линии, метки дорожных событий отображаются на карте.

Step:
  Action:
  Выполнить клик в котрол пробок.
  
  Expectation:
  Контрол пробок стал неактивным - окрашен белым.
  Линии пробок и метки дорожных событий пропали с карты.
  Карта отображается корректно: видны подписи топонимов(улиц, районов), имеются метки станций метро и метки достопримечательностей. 

Step:
  Action:
  Выполнить клик в котрол пробок.
  
  Expectation:
  Контрол пробок стал активным - окрашен желтым.
  На карте появились разноцветные линии пробок и метки дорожных событий.
  Карта отображается корректно: видны подписи топонимов(улиц, районов), имеются метки станций метро и метки достопримечательностей. 

Step:
  Action:
  Выполнить клик в метку ДТП.
  
  Expectation:
  Спан карты может сместится для открытия балуна. 
  Открывается балун с заголовком "ДТП" и информацией о событии.
  Пробочные линии и метки других дорожных событий на карте.

Step:
  Action:
  Выполнить клик в метку дорожных работ.
  
  Expectation:
  Спан карты может сместится для открытия балуна. 
  Открывается балун с заголовком "Дорожные работы" и информацией о событии.
  Пробочные линии и метки других дорожных событий на карте.

Step:
  Action:
  Выполнить клик в метку моста.
  
  Expectation:
  Спан карты может сместится для открытия балуна. 
  Открывается балун с заголовком "Развод моста" и информацией о событии.
  Пробочные линии и метки других дорожных событий на карте.


Step:
  Action:
  Выполнить клик в метку со знаком "кирпич".
  
  Expectation:
  Спан карты может сместится для открытия балуна. 
  Открывается балун с заголовком "Перекрытие движения" и информацией о событии.
  Пробочные линии и метки других дорожных событий на карте.
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="../../../helper.js"></script>
    <script type=text/javascript>

        Api('init');

        function init(ymaps) {

            //ymaps = ym;
            var myMap = new ymaps.Map('map', {
                //заменил центр так как инфоточки в тестинге мало где есть
                center: [59.9312, 30.3281],
                zoom: 10,
                controls: []
            }, {
                backgroundVisible: false
            });
            addGrid(myMap);
            var log = new Log();
            log.info("Test case: На карте включены пробки и инфоточки");

            // Создадим элемент управления "Пробки".
            var trafficControl = new ymaps.control.TrafficControl({ state: {
                // Отображаются пробки "Сейчас".
                providerKey: 'traffic#actual',
                // Начинаем сразу показывать пробки на карте.
                trafficShown: true
            }});
            // Добавим контрол на карту.
            myMap.controls.add(trafficControl);
            // Получим ссылку на провайдер пробок "Сейчас" и включим показ инфоточек.
            trafficControl.getProvider('traffic#actual').state.set('infoLayerShown', true);
        }
    </script>
</head>
<body>
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>