<!DOCTYPE HTML>
<!--
Title:
Виды меток

Description:
Вариации меток на карте.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
smoke

Estimated time:
270000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней. 

  Expectation:
  Карта отобразилась корректно. 
  На карте спан Москвы.
  На карте имеются контролы: масштабирования - "+/-", местоположения, кнопки "Найти", "Пробки", "Слои", кнопка разворачивания экрана, кнопка линейки. 
  На карте размещены 11 различных меток с балунами.
  
Step:
  Action:
  Навести курсор на каждую из меток.
    
  Expectation:
  При наведении курсор меняется на палец.
  У метки с текстом "Я тащусь" - хинт "Ну давай уже тащи".
  У метки цвета морской волны курсор - стрелка со знаком вопроса. 
  
Step:
  Action:
  Клик в круглую метку с зеленым кромкой.
    
  Expectation:
  Появляется балун "цвет влюбленной жабы".

Step:
  Action:
  Клик в метку коллекции светло-зеленого цвета с закрепленным к метке текстом "Очень длинный, но неверо...".
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет вконтакте".
  
Step:
  Action:
  Клик в круглую метку с серым флагом.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет фэйсбука".

Step:
  Action:
  Клик в фиолетовую метку коллекции.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "серобуромалиновый цвет".
    
Step:
  Action:
  Захватить метку с текстом "Я тащусь" и переставить в свободное место на карте.
    
  Expectation:
  Метка перемещается, после выставления метки на карте под блоком текста появляется надпись с координатами метки: "[dragend event] new position is 55.795508403212125,37.69259009044534".
  Балун предыдущей метки остался открыт.

Step:
  Action:
  Клик в голубую круглую метку с текстом "Очен...".
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет голубой".

Step:
  Action:
  Клик в метку коллекции цвета морской волны.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет воды пляжа бонди".

Step:
  Action:
  Клик в красную метку со штангой.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет красный". 

Step:
  Action:
  Клик в круглую желтую метку.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "цвет десткой неожиданности". 

Step:
  Action:
  Клик в метку - канцелярскую кнопку.
    
  Expectation:
  Балун предыдущей метки закрылся.
  Появляется балун "своя картинка иконка-кнопка". 

Step:
  Action:
  С зажатой левой кнопкой мыши дёрнули карту немного вправо-влево(статичный драг), вверх вниз несколько раз.
  
  Expectation:
  Перемещение карты драгом корректное: нет странных визуальных эффектов на карте и с элементами. 
  Карта не дрожит и не мигает цветами.
  Нет заметных тормозов при передвижении карты.
  Метки не перемещаются с драгом или за курсором, остаются на местах.

-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="../../../helper.js"></script>
    <script type=text/javascript>

        Api('init');

        function init(ymaps) {
            //ymaps = ym;
            var myMap = new ymaps.Map("map", {
                        center: [55.76, 37.64],
                        zoom: 10
                    }, {
                        suppressObsoleteBrowserNotifier: false,
                        suppressMapOpenBlock: false,
                        backgroundVisible: false

                    }),

            // Создаем геообъект с типом геометрии "Точка".
                    myGeoObject = new ymaps.GeoObject({
                        // Описание геометрии.
                        geometry: {
                            type: "Point",
                            coordinates: [55.8, 37.8]
                        },
                        // Свойства.
                        properties: {
                            // Контент метки.
                            iconContent: 'Я тащусь',
                            hintContent: 'Ну давай уже тащи'
                        }
                    }, {
                        // Опции.
                        // Иконка метки будет растягиваться под размер ее содержимого.
                        preset: 'islands#blackStretchyIcon',
                        // Метку можно перемещать.
                        draggable: true
                    }),
                    myPieChart = new ymaps.Placemark([
                        55.847, 37.6
                    ], {
                        // Данные для построения диаграммы.
                        data: [
                            {weight: 8, color: '#0E4779'},
                            {weight: 6, color: '#1E98FF'},
                            {weight: 4, color: '#82CDFF'}
                        ],
                        iconCaption: "Диаграмма"
                    }, {
                        // Зададим произвольный макет метки.
                        iconLayout: 'default#pieChart',
                        // Радиус диаграммы в пикселях.
                        iconPieChartRadius: 30,
                        // Радиус центральной части макета.
                        iconPieChartCoreRadius: 10,
                        // Стиль заливки центральной части.
                        iconPieChartCoreFillStyle: '#ffffff',
                        // Cтиль линий-разделителей секторов и внешней обводки диаграммы.
                        iconPieChartStrokeStyle: '#ffffff',
                        // Ширина линий-разделителей секторов и внешней обводки диаграммы.
                        iconPieChartStrokeWidth: 3,
                        // Максимальная ширина подписи метки.
                        iconPieChartCaptionMaxWidth: 200
                    });

            myGeoObject.events.add('dragend', function (e) {
                __log__('[dragend event] new position is ' + myGeoObject.geometry.getCoordinates());

            });

            myMap.geoObjects
                    .add(myGeoObject)
                    .add(myPieChart)
                    .add(new ymaps.Placemark([55.684758, 37.738521], {
                        balloonContent: 'цвет <strong>воды пляжа бонди</strong>'
                    }, {
                        preset: 'islands#icon',
                        iconColor: '#0095b6',
                        cursor: 'help'
                    }))
                    .add(new ymaps.Placemark([55.833436, 37.715175], {
                        balloonContent: '<strong>серобуромалиновый</strong> цвет'
                    }, {
                        preset: 'islands#dotIcon',
                        iconColor: '#735184'
                    }))
                    .add(new ymaps.Placemark([55.687086, 37.529789], {
                        balloonContent: 'цвет <strong>влюбленной жабы</strong>'
                    }, {
                        preset: 'islands#circleIcon',
                        iconColor: '#3caa3c'
                    }))
                    .add(new ymaps.Placemark([55.782392, 37.614924], {
                        balloonContent: 'цвет <strong>детской неожиданности</strong>'
                    }, {
                        preset: 'islands#circleDotIcon',
                        iconColor: 'yellow'
                    }))
                    .add(new ymaps.Placemark([55.642063, 37.656123], {
                        balloonContent: 'своя картинка <strong>иконка-кнопка</strong>'
                    }, {
                        // Опции.
                        // Необходимо указать данный тип макета.
                        iconLayout: 'default#image',
                        // Своё изображение иконки метки.
                        iconImageHref: '../../../img/myIcon.gif',
                        // Размеры метки.
                        iconImageSize: [30, 42],
                        // Смещение левого верхнего угла иконки относительно
                        // её "ножки" (точки привязки).
                        iconImageOffset: [-3, -42]
                    }))
                    .add(new ymaps.Placemark([55.642063, 37.656123], {
                        balloonContent: 'цвет <strong>красный</strong>'
                    }, {
                        preset: 'islands#redSportIcon'
                    }))
                    .add(new ymaps.Placemark([55.826479, 37.487208], {
                        balloonContent: 'цвет <strong>фэйсбука</strong>'
                    }, {
                        preset: 'islands#governmentCircleIcon',
                        iconColor: '#3b5998'
                    }))
                    .add(new ymaps.Placemark([55.694843, 37.435023], {
                        balloonContent: 'цвет <strong>вконтакте</strong>',
                        iconCaption: 'Очень длиннный, но невероятно интересный текст'
                    }, {
                        preset: 'islands#greenDotIconWithCaption'
                    }))
                    .add(new ymaps.Placemark([55.790139, 37.814052], {
                        balloonContent: 'цвет <strong>голубой</strong>',
                        iconCaption: 'Очень длиннный, но невероятно интересный текст'
                    }, {
                        preset: 'islands#blueCircleDotIconWithCaption',
                        iconCaptionMaxWidth: '50'
                    }))
                    .add(new ymaps.Placemark([55.790139, 37.814052], {
                        balloonContent: 'цвет <strong>твиттера</strong>'
                    }, {
                        preset: 'islands#circleDotIcon',
                        iconColor: '#1faee9'
                    }));
            addGrid(myMap);

            __log__('Test script: метки имеют балуны с описанием');
            __log__('Stretch метка: нет балуна, есть хинт, есть iconContent, драгается');
            __log__('Метка-кнопка на карте');
            __log__('Курсор помощи над меткой цвета воды пляжа бонди');
            __log__('Текст метки голубого цвета: "maxWidth: 50px"');
            __log__('Красная метка: есть иконка "sport"');
            __log__('При переходе на БЯК открывается только um');

            myMap.state.set('mapSid', "93jfWjoXws37exPmKH-OFIuj3IQduHal");
            myMap.state.set('mapSourceType', "mymaps");
        }
    </script>
</head>
<body>
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>
