<!DOCTYPE HTML>
<!--
Title:
Контрол: опции удаления и добавления контролов поиска

Description:
Проверка опций удаления и добавления контролов поиска.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
control

Estimated time:
240000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней.

  Expectation:
  Карта отобразилась корректно.
  На карте спан Москвы, сверху имеется контрол "Найти", поисковый инпут с желтой кнопкой "Найти". 
  Снизу справа кнопки "visibleControl", "remove".

Step:
  Action:
  Выполнить клик в контрол поиска в виде кнопки "Найти".

  Expectation:
  Сверху выпадает плашка с поисковым инпутом и кнопкой "Найти" и кнопкой сворачивания поиского инпута. 

Step:
  Action:
  Ввести в инпут "Москва Кремль", клик в "Найти".

  Expectation:
  Плашка с поисковым инпутом пропадает. Cверху контрол "Найти", поисковый инпут с желтой кнопкой "Найти".
  Происходит смена спана с призумом к области запроса, на спане открывается балун с карточкой Кремля. 

Step:
  Action:
  Выполнить клик в кнопку "visibleControl".

  Expectation:
  Из контейнера пропадают контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти". 
  Спан карты без изменений, балун Кремля на месте.

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  Со спана карты пропадает балун с карточкой Кремля.

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  На спане карты в местенахождении балуна карточки Кремля появляется синяя метка коллекции.

Step:
  Action:
  Выполнить клик в кнопку "visibleControl".

  Expectation:
  В контейнере с картой появляются контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти". 

Step:
  Action:
  Выполнить клик в поисковый инпут, ввести в инпут "Больница" клик в "Найти".

  Expectation:
  Под поисковым инпутом появляется панель со сниппетами топонимов по запросу(поселок, деревня, метро, станция, микрорайон). 

Step:
  Action:
  Выполнить клик в кнопку "visibleControl".

  Expectation:
  Из контейнера пропадают контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами. 
  Спан карты без изменений, метка коллекции в Кремле на месте.

Step:
  Action:
   Выполнить клик в кнопку "visibleControl".

  Expectation:
  В контейнере появляются контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запрсоу "Больница". 

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  Из контейнера пропадают контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами. 
  Метка коллекции в Кремле также пропадает.

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  В контейнере появляются контролы поиска: контрол "Найти", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запрсоу "Больница". 

Step:
  Action:
  Выполнить клик в контрол поиска в виде кнопки "Найти".

  Expectation:
  Сверху выпадает плашка с поисковым инпутом и кнопкой "Найти" и кнопкой сворачивания поиского инпута, при этом в поисковом инпуте плашки "Москва Кремль". 
  Панель со сниппетами по запросу "Больница" не прпоаадет.

Step:
  Action:
  Удалить значение "Москва Кремль", ввести в инпут "Яндекс" клик в "Найти".

  Expectation:
  Под плашкой с инпутом появляется строка "Идет запрос к серверу", после чего под инпутом выпадает плашка с ответом: "Ничего не нашлось", ниже нее плашка с текстом-кнопкой "Дополнить карту". 

Step:
  Action:
  Выполнить клик в кнопку "visibleControl".

  Expectation:
  Из контейнера пропадают контролы поиска: поисковый инпут в виде плашки с результатами поиска по запросу "Яндекс", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запросу "Больница". 
  Спан карты без изменений, метки коллекции в Кремле нет.

Step:
  Action:
  Выполнить клик в кнопку "visibleControl".

  Expectation:
  В контейнере появляются поисковый инпут в виде плашки с результатами поиска по запросу "Яндекс", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запросу "Больница". 
  Спан карты без изменений.

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  Из контейнера пропадают контролы поиска: поисковый инпут в виде плашки с результатами поиска по запросу "Яндекс", поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запросу "Больница". 
  Спан карты без изменений, метки коллекции в Кремле нет.

Step:
  Action:
  Выполнить клик в кнопку "remove".

  Expectation:
  В контейнере появляются поисковый контрол "Найти"(плашка с результатами поиска по запросу "Яндекс" не появляется), поисковый инпут с желтой кнопкой "Найти" с панелью со сниппетами по запросу "Больница". 
  Спан карты без изменений.
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <script src="../../../helper.js"></script>
    <script type=text/javascript>

        Api('init');

        function init(ymaps) {
            ymaps = ym;

            var map = myMap = new ym.Map('map', {
                center: [55.72725771214265, 37.640390506634006],
                zoom: 10,
                behaviors: ['default', 'scrollZoom'],
                controls: ['fullscreenControl']
            });

            addGrid(myMap);
            var log = new Log();

            var search1 = new ymaps.control.SearchControl();
            var search2 = new ymaps.control.SearchControl();
            map.controls
                    .add(search1, {size: 'large'})
                    .add(search2, {size: 'medium'});

            var removeButton = new ymaps.control.Button({data: {content: 'remove'}, options: {selectOnClick: true}});
            removeButton.events
                    .add('select', function () {
                        map.controls.remove(search1);
                        map.controls.remove(search2);
                    })
                    .add('deselect', function () {
                        map.controls.add(search1);
                        map.controls.add(search2);
                    });

            var hideButton = new ymaps.control.Button({data: {content: 'visibleControl'}, options: {selectOnClick: true, maxWidth: 200}});
            hideButton.events
                    .add('select', function () {
                        search1.options.set('visible', false);
                        search2.options.set('visible', false);
                    })
                    .add('deselect', function () {
                        search1.options.set('visible', true);
                        search2.options.set('visible', true);
                    });

            map.controls
                    .add(removeButton, {float: 'none', position: {bottom: 35, right: 10}})
                    .add(hideButton, {float: 'none', position: {bottom: 65, right: 10}});
        }
    </script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>