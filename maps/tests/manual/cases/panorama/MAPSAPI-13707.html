<!DOCTYPE HTML>
<!--
Title:
Панорама: применение неизвестного стиля

Description:
Проверка применения неизвестного стиля на панораме.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
panorama

Estimated time:
90000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть страницу и элементы на ней. 

  Expectation:
  На странице отображается наземная панорама.
  На панораме имеются контролы масштабирования "+/-", контрол разворачивания панорамы, контрол закрытия панорамного плеера - крестик, на наземной панораме имеются стрелки перехода к следующей панораме.

Step:
  Action:
  Поперемещаться по панораме с помощью стрелок. 

  Expectation:
  Происходит корректный переход по панораме, панорама не зависает.
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="../../helper.js"></script>
    <script type=text/javascript>

        Api('init', 'Panorama,panorama.Player');

        function init(ymaps) {
            var metadata = JSON.parse(
                '{"status":"success","data":{"Data":{"timestamp":1431691200,' +
                '"Point":{"type":"Point","coordinates":[37.6190794,55.768434' +
                '5,144.5],"name":"1-й Колобовский переулок"},"Equirectangula' +
                'rProjection":{"Origin":[96.810000000000002,27.8091000000000' +
                '01]},"Images":{"href":"https:/stv.maps.yandex.net/tiles?id=' +
                'b7292089&%c","imageId":"b7292089","Zooms":[{"level":0,"widt' +
                'h":17664,"height":6103},{"level":1,"width":7168,"height":24' +
                '76},{"level":2,"width":3584,"height":1238},{"level":3,"widt' +
                'h":1792,"height":619},{"level":4,"width":512,"height":176}]' +
                ',"Tiles":{"width":256,"height":256}},"View":{"Direction":[0' +
                ',0],"Span":[130,80]}},"Annotation":{"Graph":{"Nodes":[{"id"' +
                ':0,"lon":37.619078999999999,"lat":55.768433999999999,"panoi' +
                'd":"1298148373_673069514_23_1430821268","href":"https://api' +
                '-maps.yandex.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&pr' +
                'ovider=streetview&oid=1298148373_673069514_23_1430821268&fo' +
                'rmat=json"},{"id":1,"lon":37.619383999999997,"lat":55.76841' +
                '1,"panoid":"1298150190_673069764_23_1430821266","href":"htt' +
                'ps://api-maps.yandex.ru/services/panoramas/1.x/?l=stv&lang=' +
                'ru_RU&provider=streetview&oid=1298150190_673069764_23_14308' +
                '21266&format=json"},{"id":2,"lon":37.618772,"lat":55.768473' +
                ',"panoid":"1298146540_673069106_23_1430821271","href":"http' +
                's://api-maps.yandex.ru/services/panoramas/1.x/?l=stv&lang=r' +
                'u_RU&provider=streetview&oid=1298146540_673069106_23_143082' +
                '1271&format=json"},{"id":3,"lon":37.619689999999999,"lat":5' +
                '5.768386999999997,"panoid":"1298152017_673070017_23_1430821' +
                '264","href":"https://api-maps.yandex.ru/services/panoramas/' +
                '1.x/?l=stv&lang=ru_RU&provider=streetview&oid=1298152017_67' +
                '3070017_23_1430821264&format=json"},{"id":4,"lon":37.61842,' +
                '"lat":55.768554999999999,"panoid":"1298144439_673068236_23_' +
                '1430821273","href":"https://api-maps.yandex.ru/services/pan' +
                'oramas/1.x/?l=stv&lang=ru_RU&provider=streetview&oid=129814' +
                '4439_673068236_23_1430821273&format=json"},{"id":5,"lon":37' +
                '.620010999999998,"lat":55.768362000000003,"panoid":"1298153' +
                '927_673070281_23_1430821262","href":"https://api-maps.yande' +
                'x.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&provider=stre' +
                'etview&oid=1298153927_673070281_23_1430821262&format=json"}' +
                ',{"id":6,"lon":37.618155000000002,"lat":55.768649000000003,' +
                '"panoid":"1298142858_673067240_23_1430821275","href":"https' +
                '://api-maps.yandex.ru/services/panoramas/1.x/?l=stv&lang=ru' +
                '_RU&provider=streetview&oid=1298142858_673067240_23_1430821' +
                '275&format=json"},{"id":7,"lon":37.620323999999997,"lat":55' +
                '.768338,"panoid":"1298155798_673070540_23_1430821260","href' +
                '":"https://api-maps.yandex.ru/services/panoramas/1.x/?l=stv' +
                '&lang=ru_RU&provider=streetview&oid=1298155798_673070540_23' +
                '_1430821260&format=json"},{"id":8,"lon":37.617913999999999,' +
                '"lat":55.768738999999997,"panoid":"1298141423_673066290_23_' +
                '1430821278","href":"https://api-maps.yandex.ru/services/pan' +
                'oramas/1.x/?l=stv&lang=ru_RU&provider=streetview&oid=129814' +
                '1423_673066290_23_1430821278&format=json"},{"id":9,"lon":37' +
                '.620640999999999,"lat":55.768312999999999,"panoid":"1298157' +
                '691_673070803_23_1430821257","href":"https://api-maps.yande' +
                'x.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&provider=stre' +
                'etview&oid=1298157691_673070803_23_1430821257&format=json"}' +
                ',{"id":10,"lon":37.621077,"lat":55.768259999999998,"panoid"' +
                ':"1298160286_673071357_23_1493714588","href":"https://api-m' +
                'aps.yandex.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&prov' +
                'ider=streetview&oid=1298160286_673071357_23_1493714588&form' +
                'at=json"}],"Edges":[{"src":0,"dst":1},{"src":0,"dst":2},{"s' +
                'rc":1,"dst":3},{"src":2,"dst":4},{"src":3,"dst":5},{"src":4' +
                ',"dst":6},{"src":5,"dst":7},{"src":6,"dst":8},{"src":7,"dst' +
                '":9},{"src":9,"dst":10}]},"Thoroughfares":[{"Direction":[97' +
                '.839399999999998,0],"Connection":{"name":"1-й Колобовский п' +
                'ереулок","href":"https://api-maps.yandex.ru/services/panora' +
                'mas/1.x/?l=stv&lang=ru_RU&provider=streetview&oid=129815019' +
                '0_673069764_23_1430821266&format=json"},"style":"https://ya' +
                'ndex.st/swf/streetview/2_23/style/style.xml#highwayStyle"},' +
                '{"Direction":[-77.436300000000003,0],"Connection":{"name":"' +
                '1-й Колобовский переулок","href":"https://api-maps.yandex.r' +
                'u/services/panoramas/1.x/?l=stv&lang=ru_RU&provider=streetv' +
                'iew&oid=1298146540_673069106_23_1430821271&format=json"},"s' +
                'tyle":"https://yandex.st/swf/streetview/2_23/style/style.xm' +
                'l#highwayStyle"}],"Markers":[{"type":"Feature","properties"' +
                ':{"description":"1-й Колобовский переулок, 16с1","name":"16' +
                'с1","style":"https://yandex.st/swf/streetview/2_23/style/st' +
                'yle.xml#markerStyle"},"geometry":{"type":"Point","coordinat' +
                'es":[37.6187946,55.7684082,146.7489884]}},{"type":"Feature"' +
                ',"properties":{"description":"1-й Колобовский переулок, 18"' +
                ',"name":"18","style":"https://yandex.st/swf/streetview/2_23' +
                '/style/style.xml#markerStyle"},"geometry":{"type":"Point","' +
                'coordinates":[37.6194973,55.7683121,148.1690073]}},{"type":' +
                '"Feature","properties":{"description":"1-й Колобовский пере' +
                'улок, 23","name":"23","style":"https://yandex.st/swf/street' +
                'view/2_23/style/style.xml#markerStyle"},"geometry":{"type":' +
                '"Point","coordinates":[37.6191268,55.7684602,145.0127902]}}' +
                '],"HistoricalPanoramas":[{"timestamp":1431691200,"Connectio' +
                'n":{"oid":"1298148373_673069514_23_1430821268","name":"2015' +
                '","href":"https://api-maps.yandex.ru/services/panoramas/1.x' +
                '/?l=stv&lang=ru_RU&provider=streetview&oid=1298148373_67306' +
                '9514_23_1430821268&format=json","Point":{"type":"Point","co' +
                'ordinates":[37.6190794,55.7684345]}}},{"timestamp":13818384' +
                '00,"Connection":{"oid":"1298148123_673069432_23_1381581339"' +
                ',"name":"2013","href":"https://api-maps.yandex.ru/services/' +
                'panoramas/1.x/?l=stv&lang=ru_RU&provider=streetview&oid=129' +
                '8148123_673069432_23_1381581339&format=json","Point":{"type' +
                '":"Point","coordinates":[37.6190376,55.7684422]}}},{"timest' +
                'amp":1224072000,"Connection":{"oid":"1298148782_673069626_2' +
                '3_1224932936","name":"2008","href":"https://api-maps.yandex' +
                '.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&provider=stree' +
                'tview&oid=1298148782_673069626_23_1224932936&format=json","' +
                'Point":{"type":"Point","coordinates":[37.6191481,55.7684239' +
                ']}}},{"timestamp":1313409600,"Connection":{"oid":"129814883' +
                '6_673069428_23_1314105344","name":"2011","href":"https://ap' +
                'i-maps.yandex.ru/services/panoramas/1.x/?l=stv&lang=ru_RU&p' +
                'rovider=streetview&oid=1298148836_673069428_23_1314105344&f' +
                'ormat=json","Point":{"type":"Point","coordinates":[37.61915' +
                '7,55.7684426]}}}]},"Representation":""}}'
            ).data;
            metadata.Annotation.Markers[0].properties.style = metadata.Annotation.Markers[0].properties.style.replace('markerStyle', 'underground');
            var panorama = new ymaps.Panorama(metadata, 'yandex#panorama');
            var player = new ymaps.panorama.Player('map', panorama);
            console.log(metadata);
        }
    </script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>