<!DOCTYPE HTML>
<!--
Title:
CSP: метки SVG при применении правил CSP

Description:
Проверка отображения и функционирования меток SVG при применении правил CSP.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
CSP

Estimated time:
180000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней. 

  Expectation:
  Карта отобразилась корректно, в правом стороне спана оранжевая метка коллекции с оранжевой точкой внутри.
  В левой стороне спана имеются три черных метки разного размера(большая, средняя, маленькая).

Step:
  Action:
  Навести курсор на большую черную метку, зажать ЛКМ и перенести метку на спане карты.

  Expectation:
  При наведении курсор на метке - палец, захват метки корректный, метка перемещается на спане карты.

Step:
  Action:
  Навести курсор на среднюю черную метку, зажать ЛКМ и перенести метку на спане карты.

  Expectation:
  При наведении курсор на метке - палец, захват метки корректный, метка перемещается на спане карты.

Step:
  Action:
  Навести курсор на маленькую черную метку, зажать ЛКМ и перенести метку на спане карты.

  Expectation:
  При наведении курсор на метке - палец, захват метки корректный, метка перемещается на спане карты.
-->
<html>
<head>
    <title>2.1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="Content-Security-Policy"
          content="img-src 'self' data: blob: filesystem: *;media-src 'self' ;script-src 'self' 'unsafe-eval' https://*.yandex.ru 'nonce-eef8264c4994bf6409c51ac7c9614446' ;style-src 'self' 'unsafe-eval' data: blob: 'nonce-eef8264c4994bf6409c51ac7c9614446';">
    <script src="../../helper.js" nonce="eef8264c4994bf6409c51ac7c9614446"></script>
    <script type="text/javascript" nonce="eef8264c4994bf6409c51ac7c9614446">
        var define = function () {
                },
                module = {
                    exports: {}
                },
                exports = module.exports,
                modules = {};
    </script>
    <script type="text/javascript" src="https://api-maps.tst.c.maps.yandex.ru/2.1-dev/?mode=debug&namespace=ymaps&lang=ru_RU&csp[style_nonce]=eef8264c4994bf6409c51ac7c9614446&csp[_data_style]=1&host_config[hosts]"></script>
    <!--<script type="text/javascript" src="https://api-maps.tst.c.maps.yandex.ru/2.1-dev?&csp=true&mode=debag&lang=ru_RU"></script>-->
    <script type="text/javascript" nonce="eef8264c4994bf6409c51ac7c9614446">

        ymaps.ready(function(ymaps) {
            var map = myMap = new ymaps.Map('map', {
                center: [55.710901946294286, 37.30336807048247],
                zoom: 15,
                behaviors: ['default', 'scrollZoom'],
                controls: ['fullscreenControl', 'searchControl']
            });

            addGrid(map);
            document.getElementById('map').setAttribute('nonce','eef8264c4994bf6409c51ac7c9614446');

            __log__("SVG метки должны работать в режиме CSP");

            var options1 = {
                    draggable: true,
                    iconLayout: 'default#image',
                    iconImageHref: 'https://yastatic.net/constructor_v3/_/kMCN0Ba-oCwwkko5xsCFzc0vTA0.svg',
                    iconImageSize: [60, 60],
                    iconImageOffset: [-30, -60]
                },
               options2 = {
                    draggable: true,
                    iconLayout: 'default#image',
                    iconImageHref: 'https://yastatic.net/constructor_v3/_/kMCN0Ba-oCwwkko5xsCFzc0vTA0.svg',
                    iconImageSize: [10, 10],
                    iconImageOffset: [-5, -10]
                },
                options3 = {
                    draggable: true,
                    iconLayout: 'default#image',
                    iconImageHref: 'https://yastatic.net/constructor_v3/_/kMCN0Ba-oCwwkko5xsCFzc0vTA0.svg',
                    iconImageSize: [30, 30],
                    iconImageOffset: [-15, -30]
                },

                placemark1 = new ymaps.GeoObject({
                    geometry: {type: "Point", coordinates: [55.711, 37.297]}, properties: {custom: true}
                }, options1),
                placemark2 = new ymaps.GeoObject({
                    geometry: {type: "Point", coordinates: [55.712, 37.300]}, properties: {custom: true}
                }, options2),
                placemark3 = new ymaps.GeoObject({
                    geometry: {type: "Point", coordinates: [55.713, 37.297]}, properties: {custom: true}
                }, options3),
                myPlacemark0 = new ymaps.Placemark([55.79, 37.71], {iconCaption: '1'}, {preset: 'islands#pinkCircleIcon'}),
                myPlacemark1 = new ymaps.Placemark([55.80, 37.71], {iconCaption: 'Очень длиннный, но невероятно интересный текс. ' +
                '<p><br>Очень длиннный, но невероятно интересный текс.Очень длиннный, но невероятно интересный текс.Очень длиннный, ' +
                'но невероятно интересный текс.Очень длиннный, но невероятно интересный текс..Очень длиннный, но невероятно интересный текс..' +
                'Очень длиннный, но невероятно интересный текс..Очень длиннный, но невероятно интересный текс..Очень длиннный, но невероятно ' +
                'интересный текс..Очень длиннный, но невероятно интересный текс..Очень длиннный, но невероятно интересный текс..Очень длиннный, ' +
                'но невероятно интересный текс..Очень длиннный, но невероятно интересный текс..Очень длиннный, но невероятно интересный текс..' +
                'Очень длиннный, но невероятно интересный текс.'}, {preset: 'islands#pinkCircleIcon', iconCaptionMaxWidth: '20', iconColor: "black"}),
                myPlacemark2 = new ymaps.Placemark([55.71, 37.310], {iconCaption: ''}, {preset: 'islands#orangeDotIconWithCaption', iconCaptionMaxWidth: '20'}),
                myPlacemark3 = new ymaps.Placemark([55.72, 37.310], {iconCaption: ''}, {preset: 'islands#blueCircleDotIconWithCaption'}),
                myPlacemark4 = new ymaps.Placemark([55.73, 37.310], {iconCaption: '...........'}, {preset: 'islands#blackDotIconWithCaption'}),
                myPlacemark5 = new ymaps.Placemark([55.74, 37.310], {iconCaption: '...........'}, {preset: 'islands#blueCircleDotIconWithCaption'}),
                myPlacemark6 = new ymaps.Placemark([55.75, 37.310], {iconCaption: '22'}, {preset: 'islands#blueDotIconWithCaption'}),
                myPlacemark7 = new ymaps.Placemark([55.76, 37.310], {iconCaption: 'Очень длиннный, но невероятн'}, {preset: 'islands#blueCircleDotIconWithCaption', iconCaptionMaxWidth: 200}),
                myPlacemark8 = new ymaps.Placemark([55.77, 37.310], {iconCaption: 'Очень длиннный, но невероятно интересный текс.'}, {preset: 'islands#redDotIconWithCaption'}),
                myPlacemark9 = new ymaps.Placemark([55.78, 37.310], {iconCaption: 'Очень длиннный, но невероятно интересный текс.'}, {preset: 'islands#blueCircleDotIconWithCaption'}),
                myPlacemark10 = new ymaps.Placemark([55.79, 37.310], {iconCaption: '22'}, {preset: 'islands#greenDotIconWithCaption'}),
                myPlacemark11 = new ymaps.Placemark([55.80, 37.310],{iconCaption: '22'}, {preset: 'islands#grayStretchyIcon'}),
                collection = new ymaps.GeoObjectCollection();

            collection
                    .add(myPlacemark0)
                    .add(myPlacemark1)
                    .add(myPlacemark2)
                    .add(myPlacemark3)
                    .add(myPlacemark4)
                    .add(myPlacemark5)
                    .add(myPlacemark6)
                    .add(myPlacemark7)
                    .add(myPlacemark8)
                    .add(myPlacemark9)
                    .add(myPlacemark10)
                    .add(myPlacemark11);

            map.geoObjects
                    .add(placemark1)
                    .add(placemark2)
                    .add(placemark3)
                    .add(collection);

        });
    </script>
</head>
<style type="text/css" nonce="eef8264c4994bf6409c51ac7c9614446">
    html, body, #map {
        margin: 0;
        padding: 0;
        height: 512px;
        width: 512px;
    }
</style>
<body>
    <div id="map"></div>
</body>
</html>