<!DOCTYPE HTML>
<!--(skip)(description)
geoObject.geometry: set
-->
<!--(version)
2.1
-->
<!--(commands)
sleep(2000);
test();
click(4);
sleep(2000);
click(2);
test();
-->
<html>
<head>
<title>2.1</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<script src="../../../helper.js"></script>
<script src="../geoCS.js"></script>
<script type=text/javascript>
//TODO: завалидировать всё!
Api('init');

function init(ymaps) {
    ymaps = ym; // hack

    var map = myMap = new ym.Map('map', {
        center: [55.73259667357658, 37.70153663432529],
        zoom: 9,
        behaviors: ['default', 'scrollZoom'],
        controls: ['fullscreenControl']
    });

    var newMap = new ym.Map('map1', {
        center: [55.73259667357658, 37.70153663432529],
        zoom: 8,
        behaviors: ['default', 'scrollZoom']
    });

    geoCSSource(ym, myMap, this);
    addGrid(myMap);
    var log = new Log();

    var button = new ymaps.control.Button('check');
    var clearButton = new ymaps.control.Button('clear');

    button.events.add('click', function () {
        log.info('');
        log.info('Coordinates: ');
        geoObjectPlacemark.geometry.setCoordinates([55.912150224943986, 37.29753265380539]);
        geoObjectPolyline.geometry.setCoordinates([
            [55.97596807270264, 37.49213562011659],
            [55.86646804437069, 37.43433227538992],
            [55.97395964586614, 37.37896423339792]
        ]);
        geoObjectPolygon.geometry.setCoordinates([
            [
                [55.97698207150061, 37.571533203124304],
                [55.977780948987515, 37.66869354247962],
                [55.876808118310706, 37.66697692871001],
                [55.87638191482625, 37.565603637694494],
                [55.97698207150061, 37.571533203124304]
            ],
            [
                [55.97544201439153, 37.71984863281182],
                [55.876808118310706, 37.66697692871001],
                [55.8748378377763, 37.78258361816322],
                [55.97544201439153, 37.71984863281182]
            ]
        ]);
        geoObjectRectangle.geometry.setCoordinates([
            [55.973805634187, 37.81389007567776],
            [55.87510965298843, 37.95396575927215]
        ]);
        geoObjectCircle.geometry.setCoordinates([55.9238145091058, 38.097131347654376]);
        placemark.geometry.setCoordinates([55.71574031323344, 37.29753265380539]);
        polyline.geometry.setCoordinates([
            [55.790716316844474, 37.50037536621043],
            [55.680690559796844, 37.442572021483656],
            [55.788698241203036, 37.38720397949171]
        ]);
        polygon.geometry.setCoordinates([
            [
                [55.787092634473694, 37.667663574218096],
                [55.68797724922255, 37.666976928710035],
                [55.68754896639797, 37.57658996581947],
                [55.78474860376539, 37.57684020996037],
                [55.787092634473694, 37.667663574218096]
            ],
            [
                [55.78709263446105, 37.71984863281182],
                [55.68797724922255, 37.666976928710035],
                [55.68599735621169, 37.78258361816322],
                [55.78709263446105, 37.71984863281182]
            ]
        ]);
        rectangle.geometry.setCoordinates([
            [55.785448262083506, 37.816636657710355],
            [55.68782209653647, 37.945726013178486]
        ]);
        circle.geometry.setCoordinates([55.73211355439117, 38.097131347654376]);
        validateValue(geoObjectPlacemark.geometry.getCoordinates(), "55.912150224943986,37.29753265380539");
        validateValue(geoObjectPolyline.geometry.getCoordinates(), "55.97596807270264,37.49213562011659,55.86646804437069,37.43433227538992,55.97395964586614,37.37896423339792");
        validateValue(geoObjectPolygon.geometry.getCoordinates(), "55.97698207150061,37.571533203124304,55.977780948987515,37.66869354247962,55.876808118310706,37.66697692871001,55.87638191482625,37.565603637694494,55.97698207150061,37.571533203124304,55.97544201439153,37.71984863281182,55.876808118310706,37.66697692871001,55.8748378377763,37.78258361816322,55.97544201439153,37.71984863281182");
        validateValue(geoObjectRectangle.geometry.getCoordinates(), "55.973805634187,37.81389007567776,55.87510965298843,37.95396575927215");
        validateValue(geoObjectCircle.geometry.getCoordinates(), "55.9238145091058,38.097131347654376");
        validateValue(placemark.geometry.getCoordinates(), "55.71574031323344,37.29753265380539");
        validateValue(polyline.geometry.getCoordinates(), "55.790716316844474,37.50037536621043,55.680690559796844,37.442572021483656,55.788698241203036,37.38720397949171");
        validateValue(polygon.geometry.getCoordinates(), "55.787092634473694,37.667663574218096,55.68797724922255,37.666976928710035,55.68754896639797,37.57658996581947,55.78474860376539,37.57684020996037,55.787092634473694,37.667663574218096,55.78709263446105,37.71984863281182,55.68797724922255,37.666976928710035,55.68599735621169,37.78258361816322,55.78709263446105,37.71984863281182");
        validateValue(rectangle.geometry.getCoordinates(), "55.785448262083506,37.816636657710355,55.68782209653647,37.945726013178486");
        validateValue(circle.geometry.getCoordinates(), "55.73211355439117,38.097131347654376");
        __log__('Map: ');
        geoObjectPlacemark.geometry.setMap(newMap);
        geoObjectPolyline.geometry.setMap(newMap);
        geoObjectPolygon.geometry.setMap(newMap);
        geoObjectRectangle.geometry.setMap(newMap);
        geoObjectCircle.geometry.setMap(newMap);
        placemark.geometry.setMap(newMap);
        polyline.geometry.setMap(newMap);
        polygon.geometry.setMap(newMap);
        rectangle.geometry.setMap(newMap);
        circle.geometry.setMap(newMap);
        validateValue(geoObjectPlacemark.geometry.getMap().getZoom(), 8);
        validateValue(geoObjectPolyline.geometry.getMap().getZoom(), 8);
        validateValue(geoObjectPolygon.geometry.getMap().getZoom(), 8);
        validateValue(geoObjectRectangle.geometry.getMap().getZoom(), 8);
        validateValue(geoObjectCircle.geometry.getMap().getZoom(), 8);
        validateValue(placemark.geometry.getMap().getZoom(), 8);
        validateValue(polyline.geometry.getMap().getZoom(), 8);
        validateValue(polygon.geometry.getMap().getZoom(), 8);
        validateValue(rectangle.geometry.getMap().getZoom(), 8);
        validateValue(circle.geometry.getMap().getZoom(), 8);
        __log__('Radius: ');
        geoObjectCircle.geometry.setRadius(2500);
        circle.geometry.setRadius(2500);
        validateValue(geoObjectCircle.geometry.getRadius(), "2500");
        validateValue(circle.geometry.getRadius(), "2500");
        __log__('FillRule: ');
        geoObjectPolygon.geometry.setFillRule('evenOdd');
        polygon.geometry.setFillRule('evenOdd');
        validateValue(geoObjectPolygon.geometry.getFillRule(), 'evenOdd');
        validateValue(polygon.geometry.getFillRule(), 'evenOdd');
        //log.info('Contour coords: ');
        //geoObjectPolygon.geometry.set([0][0], [55.73259667357658, 37.70153663432529]);
        //log.info(geoObjectPolygon.geometry.get([0][0]));
    });

    geoObjectPlacemark.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (geoObjectPlacemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (geoObjectPlacemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (geoObjectPlacemark)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (geoObjectPlacemark)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (geoObjectPlacemark)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (geoObjectPlacemark)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (geoObjectPlacemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (geoObjectPlacemark)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    geoObjectPolyline.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (geoObjectPolyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (geoObjectPolyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (geoObjectPolyline)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (geoObjectPolyline)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (geoObjectPolyline)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (geoObjectPolyline)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (geoObjectPolyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (geoObjectPolyline)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    geoObjectPolygon.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (geoObjectPolygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (geoObjectPolygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (geoObjectPolygon)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (geoObjectPolygon)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (geoObjectPolygon)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (geoObjectPolygon)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (geoObjectPolygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (geoObjectPolygon)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    geoObjectRectangle.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (geoObjectRectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (geoObjectRectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (geoObjectRectangle)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (geoObjectRectangle)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (geoObjectRectangle)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (geoObjectRectangle)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (geoObjectRectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (geoObjectRectangle)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    geoObjectCircle.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (geoObjectCircle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (geoObjectCircle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (geoObjectCircle)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (geoObjectCircle)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (geoObjectCircle)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (geoObjectCircle)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (geoObjectCircle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (geoObjectCircle)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    placemark.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (placemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (placemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (placemark)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (placemark)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (placemark)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (placemark)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (placemark)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (placemark)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    polyline.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (polyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (polyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (polyline)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (polyline)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (polyline)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (polyline)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (polyline)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (polyline)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    polygon.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (polygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (polygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (polygon)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (polygon)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (polygon)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (polygon)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (polygon)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (polygon)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    rectangle.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (rectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (rectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (rectangle)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (rectangle)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (rectangle)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (rectangle)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (rectangle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (rectangle)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });
    circle.events
            .add('editorstatechange', function (e) {
                log.info('editorstatechange (circle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('geometrychange', function (e) {
                log.info('geometrychange (circle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('mapchange', function (e) {
                log.info('mapchange (circle)');
                log.info('oldMap: ' + e.get('oldMap'));
                log.info('newMap: ' + e.get('newMap'));
            })
            .add('optionschange', function (e) {
                log.info('optionschange (circle)')
            })
            .add('overlaychange', function (e) {
                log.info('overlaychange (circle)');
                log.info('oldOverlay: ' + e.get('oldOverlay'));
                log.info('newOverlay: ' + e.get('newOverlay'));
            })
            .add('parentchange', function (e) {
                log.info('parentchange (circle)');
                log.info('oldParent: ' + e.get('oldParent'));
                log.info('newParent: ' + e.get('newParent'));
            })
            .add('propertieschange', function (e) {
                log.info('propertieschange (circle)');
                log.info('originalEvent: ' + e.get('originalEvent'));
            })
            .add('pixelgeometrychange', function (e) {
                log.info('pixelgeometrychange (circle)');
                log.info('oldPixelGeometry: ' + e.get('oldPixelGeometry'));
                log.info('newPixelGeometry: ' + e.get('newPixelGeometry'));
            });

    myMap.controls.add(button);
    myMap.controls.add(new ymaps.control.ZoomControl());

    myMap.geoObjects
            .add(geoObjectPlacemark)
            .add(geoObjectPolyline)
            .add(geoObjectPolygon)
            .add(geoObjectRectangle)
            .add(geoObjectRectangle)
            .add(geoObjectCircle)
            .add(placemark)
            .add(polyline)
            .add(polygon)
            .add(rectangle)
            .add(circle);
}
</script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
<div id="map1" style="height: 512px; width: 512px; margin-left: 550px; margin-top: -512px"></div>
</body>
</html>