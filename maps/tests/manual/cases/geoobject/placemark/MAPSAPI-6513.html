<!DOCTYPE HTML>
<!--
Title:
Геообъект: множественные пресеты

Description:
Проверка возможности задания строковых id в опцию preset.
Памятка по терминам: https://wiki.yandex-team.ru/eva/testing/Projects/maps-api/

Components: 
geoobject

Estimated time:
180000

Precondition:
Открыть ссылку ${currentPagePath}

Step:
  Action:
  Осмотреть карту и элементы на ней. 
  
  Expectation:
  Карта отобразилась корректно.
  На спане карты множество светло-голубых круглых меток, светло-голубые метки с точкой внутри, светло-голубые метки запятые, голубые метки с контентом "lalala".
  Сверху слева кнопки "offset", "color".

Step:
  Action:
  Поводить курсором по светло-гобым меткам на спане карты.
  
  Expectation:
  При наведении курсора на метки, у них меняется пресет, метки меняют цвет на темно-синий.

Step:
  Action:
  Выполнить клик в кнопку "offset".
  
  Expectation:
  Происходит смещение меток на спане карты.

Step:
  Action:
  Поводить курсором по светло-гобым меткам на спане карты.
  
  Expectation:
  При наведении курсора на метки, у них меняется пресет, метки меняют цвет на темно-синий.

Step:
  Action:
  Выполнить клик в кнопку "color".
  
  Expectation:
  Все метки на спане карты меняют цвет, метки на спане разноцветные.

Step:
  Action:
  Поводить курсором по меткам на спане карты.
  
  Expectation:
  При наведении курсора на метки, у них меняется пресет, метки меняют цвет на темно-синий.
  При наведении курсора на метки с контентом "lalala", метка меняет цвет на голубой, контент метки отображается.

Step:
  Action:
  Выполнить клик в кнопку "color".
  
  Expectation:
  Все метки на спане карты меняют цвет, метки становятся светло-голубого цвета, метки с контентом "lalala" голубого цвета.
-->
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<script src="../../../helper.js"></script>
<script type=text/javascript>

Api('init');

//todo: узнать должна ли отображаться тянущаяся метка если задать ей цвет

function init(ymaps) {
    ymaps = ym; // hack

    var map = myMap = new ym.Map('map', {
        center: [55.716901946294286, 37.30336807048247],
        zoom: 15,
        behaviors: ['default', 'scrollZoom'],
        controls: ['fullscreenControl']
    });

    addGrid(myMap);
    var log = new Log();

    log.info('iconColor and iconOffset now can be changed along with presets');
    log.info('iconColor and iconOffset have higher priority');

    var collection = new ymaps.GeoObjectCollection();

    var placemark1 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.711, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#blueCircleIcon', iconColor: '#00ffff'});
    var placemark2 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.712, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#darkblueCircleIcon', iconColor: '#00ffff'});
    var placemark3 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.713, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#darkgreenCircleIcon', iconColor: '#00ffff'});
    var placemark4 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.714, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#darkorangeCircleIcon', iconColor: '#00ffff'});
    var placemark5 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.715, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#greenCircleIcon', iconColor: '#00ffff'});
    var placemark6 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.716, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#greyCircleIcon', iconColor: '#00ffff'});
    var placemark7 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.717, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#lightblueCircleIcon', iconColor: '#00ffff'});
    var placemark8 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.718, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#nightCircleIcon', iconColor: '#00ffff'});
    var placemark9 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.719, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#orangeCircleIcon', iconColor: '#00ffff'});
    var placemark10 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.720, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#pinkCircleIcon', iconColor: '#00ffff'});
    var placemark11 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.721, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#redCircleIcon', iconColor: '#00ffff'});
    var placemark12 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.722, 37.297] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#violetCircleIcon', iconColor: '#00ffff'});
    var placemark13 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.711, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#oliveCircleIcon', iconColor: '#00ffff'});
    var placemark14 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.712, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#yellowCircleIcon', iconColor: '#00ffff'});
    var placemark15 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.713, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#brownCircleIcon', iconColor: '#00ffff'});
    var placemark16 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.714, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#blackCircleIcon', iconColor: '#00ffff'});
    var placemark17 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.715, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#grayCircleCircleIcon', iconColor: '#00ffff'});

    var placemark18 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.716, 37.300] }, properties: {custom: true, iconContent: 'lalala'}
    }, {id: 'geoObjectPlacemark', preset: 'islands#grayStretchyIcon', iconColor: '#00ffff'});
    var placemark19 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.717, 37.298] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#grayDotIcon', iconColor: '#00ffff'});
    var placemark20 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.719, 37.299] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#grayCircleDotIcon', iconColor: '#00ffff'});

    var placemark21 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.712, 37.304] }, properties: {custom: true, iconContent: 'lalala'}
    }, {id: 'geoObjectPlacemark', preset: 'islands#redStretchyIcon', iconColor: '#00ffff'});
    var placemark22 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.713, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#redDotIcon', iconColor: '#00ffff'});
    var placemark23 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.715, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#redCircleDotIcon', iconColor: '#00ffff'});

    var placemark24 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.716, 37.304] }, properties: {custom: true, iconContent: 'lalala'}
    }, {id: 'geoObjectPlacemark', preset: 'islands#yellowStretchyIcon', iconColor: '#00ffff'});
    var placemark25 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.717, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#yellowDotIcon', iconColor: '#00ffff'});
    var placemark26 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.719, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#yellowCircleDotIcon', iconColor: '#00ffff'});

    var placemark27 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.720, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#redIcon', iconColor: '#00ffff'});
    var placemark28 = new ymaps.GeoObject({
        geometry: { type: "Point", coordinates: [55.721, 37.303] }, properties: {custom: true}
    }, {id: 'geoObjectPlacemark', preset: 'islands#yellowIcon', iconColor: '#00ffff'});

    myMap.geoObjects
            .add(placemark1)
            .add(placemark2)
            .add(placemark3)
            .add(placemark4)
            .add(placemark5)
            .add(placemark6)
            .add(placemark7)
            .add(placemark8)
            .add(placemark9)
            .add(placemark10)
            .add(placemark11)
            .add(placemark12)
            .add(placemark13)
            .add(placemark14)
            .add(placemark15)
            .add(placemark16)
            .add(placemark17)
            .add(placemark18)
            .add(placemark19)
            .add(placemark20)
            .add(placemark21)
            .add(placemark22)
            .add(placemark23)
            .add(placemark24)
            .add(placemark25)
            .add(placemark26)
            .add(placemark27)
            .add(placemark28);

    var colorButton = new ymaps.control.Button({data: {content: 'color'}, options: {selectOnClick: true}});
    colorButton.events
            .add('select', function () {
                placemark1.options.unset('iconColor');
                placemark2.options.unset('iconColor');
                placemark3.options.unset('iconColor');
                placemark4.options.unset('iconColor');
                placemark5.options.unset('iconColor');
                placemark6.options.unset('iconColor');
                placemark7.options.unset('iconColor');
                placemark8.options.unset('iconColor');
                placemark9.options.unset('iconColor');
                placemark10.options.unset('iconColor');
                placemark11.options.unset('iconColor');
                placemark12.options.unset('iconColor');
                placemark13.options.unset('iconColor');
                placemark14.options.unset('iconColor');
                placemark15.options.unset('iconColor');
                placemark16.options.unset('iconColor');
                placemark17.options.unset('iconColor');
                placemark18.options.unset('iconColor');
                placemark19.options.unset('iconColor');
                placemark20.options.unset('iconColor');
                placemark21.options.unset('iconColor');
                placemark22.options.unset('iconColor');
                placemark23.options.unset('iconColor');
                placemark24.options.unset('iconColor');
                placemark25.options.unset('iconColor');
                placemark26.options.unset('iconColor');
                placemark27.options.unset('iconColor');
                placemark28.options.unset('iconColor');
            })
            .add('deselect', function () {
                placemark1.options.set('iconColor', '#00ffff');
                placemark2.options.set('iconColor', '#00ffff');
                placemark3.options.set('iconColor', '#00ffff');
                placemark4.options.set('iconColor', '#00ffff');
                placemark5.options.set('iconColor', '#00ffff');
                placemark6.options.set('iconColor', '#00ffff');
                placemark7.options.set('iconColor', '#00ffff');
                placemark8.options.set('iconColor', '#00ffff');
                placemark9.options.set('iconColor', '#00ffff');
                placemark10.options.set('iconColor', '#00ffff');
                placemark11.options.set('iconColor', '#00ffff');
                placemark12.options.set('iconColor', '#00ffff');
                placemark13.options.set('iconColor', '#00ffff');
                placemark14.options.set('iconColor', '#00ffff');
                placemark15.options.set('iconColor', '#00ffff');
                placemark16.options.set('iconColor', '#00ffff');
                placemark17.options.set('iconColor', '#00ffff');
                placemark18.options.set('iconColor', '#00ffff');
                placemark19.options.set('iconColor', '#00ffff');
                placemark20.options.set('iconColor', '#00ffff');
                placemark21.options.set('iconColor', '#00ffff');
                placemark22.options.set('iconColor', '#00ffff');
                placemark23.options.set('iconColor', '#00ffff');
                placemark24.options.set('iconColor', '#00ffff');
                placemark25.options.set('iconColor', '#00ffff');
                placemark26.options.set('iconColor', '#00ffff');
                placemark27.options.set('iconColor', '#00ffff');
                placemark28.options.set('iconColor', '#00ffff');
            });

    myMap.controls.add(colorButton);

    var offsetButton = new ymaps.control.Button({data: {content: 'offset'}, options: {selectOnClick: true}});
    offsetButton.events
            .add('deselect', function () {
                placemark1.options.unset('iconOffset');
                placemark2.options.unset('iconOffset');
                placemark3.options.unset('iconOffset');
                placemark4.options.unset('iconOffset');
                placemark5.options.unset('iconOffset');
                placemark6.options.unset('iconOffset');
                placemark7.options.unset('iconOffset');
                placemark8.options.unset('iconOffset');
                placemark9.options.unset('iconOffset');
                placemark10.options.unset('iconOffset');
                placemark11.options.unset('iconOffset');
                placemark12.options.unset('iconOffset');
                placemark13.options.unset('iconOffset');
                placemark14.options.unset('iconOffset');
                placemark15.options.unset('iconOffset');
                placemark16.options.unset('iconOffset');
                placemark17.options.unset('iconOffset');
                placemark18.options.unset('iconOffset');
                placemark19.options.unset('iconOffset');
                placemark20.options.unset('iconOffset');
                placemark21.options.unset('iconOffset');
                placemark22.options.unset('iconOffset');
                placemark23.options.unset('iconOffset');
                placemark24.options.unset('iconOffset');
                placemark25.options.unset('iconOffset');
                placemark26.options.unset('iconOffset');
                placemark27.options.unset('iconOffset');
                placemark28.options.unset('iconOffset');
            })
            .add('select', function () {
                placemark1.options.set('iconOffset', [14, 14]);
                placemark2.options.set('iconOffset', [14, 14]);
                placemark3.options.set('iconOffset', [14, 14]);
                placemark4.options.set('iconOffset', [14, 14]);
                placemark5.options.set('iconOffset', [14, 14]);
                placemark6.options.set('iconOffset', [14, 14]);
                placemark7.options.set('iconOffset', [14, 14]);
                placemark8.options.set('iconOffset', [14, 14]);
                placemark9.options.set('iconOffset', [14, 14]);
                placemark10.options.set('iconOffset', [14, 14]);
                placemark11.options.set('iconOffset', [14, 14]);
                placemark12.getOverlay()
                        .then(function (overlay) {
                            overlay.options.set('offset', [50, 50]);
                        });
                placemark13.options.set('iconOffset', [14, 14]);
                placemark14.options.set('iconOffset', [14, 14]);
                placemark15.options.set('iconOffset', [14, 14]);
                placemark16.options.set('iconOffset', [14, 14]);
                placemark17.options.set('iconOffset', [14, 14]);
                placemark18.options.set('iconOffset', [14, 14]);
                placemark19.options.set('iconOffset', [14, 14]);
                placemark20.options.set('iconOffset', [14, 14]);
                placemark21.options.set('iconOffset', [14, 14]);
                placemark22.options.set('iconOffset', [14, 14]);
                placemark23.options.set('iconOffset', [14, 14]);
                placemark24.options.set('iconOffset', [14, 14]);
                placemark25.options.set('iconOffset', [14, 14]);
                placemark26.options.set('iconOffset', [14, 14]);
                placemark27.options.set('iconOffset', [14, 14]);
                placemark28.options.set('iconOffset', [14, 14]);
            });
    //add MAPSAPI-9232
    myMap.geoObjects.events.add('mouseenter', function (e) {
        var pm = e.get('target'),
                old = pm.options.get('iconColor');
        pm.options.set('iconColor', '#224080');
        pm.events.once('mouseleave', function () {
            pm.options.set('iconColor', old);
        }, 1000);
    });

    myMap.controls.add(offsetButton)

}
</script>
</head>
<body style="position: relative; padding: 0; margin: 0;">
<div id="map" style="height: 512px; width: 512px;"></div>
</body>
</html>