{
    "solomon": {
        "project_id": "maps-analytics",
        "alerts": [
            {
                "id": "maps-analytics_reactor-quota-exceeded",
                "projectId": "maps-analytics",
                "name": "Reactor quota for maps-analytics",
                "channels": [
                    {
                        "id": "MapsAnalyticsMonitorings",
                        "config": {
                            "notifyAboutStatuses": [
                                "ALARM",
                                "ERROR",
                                "NO_DATA",
                                "OK",
                                "WARN"
                            ],
                            "repeatDelaySecs": 0
                        }
                    }
                ],
                "type": {
                    "expression": {
                        "program": " let ALERT_THRESHOLD = 0.45;\n let alert_threshold_str = to_fixed(ALERT_THRESHOLD * 100, 0);\n\n\n// artifact total number\n let artifact_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='artifact.total_number', sensor='currentValue'});\n let artifact_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='artifact.total_number', sensor='maxValue'});\n let artifact_total_number = artifact_total_number_used/artifact_total_number_limit;\n let artifact_total_number_percent_str = to_fixed(artifact_total_number * 100, 0);\n let is_artifact_total_number_alert = artifact_total_number > ALERT_THRESHOLD;\n\n\n// artifact instance total number\n let artifact_instance_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='artifact.instance.total_number', sensor='currentValue'});\n let artifact_instance_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='artifact.instance.total_number', sensor='maxValue'});\n let artifact_instance_total_number_percent = artifact_instance_total_number_used/artifact_instance_total_number_limit;\n let artifact_instance_total_number_percent_str = to_fixed(artifact_instance_total_number_percent * 100, 0);\n let is_artifact_instance_total_number_alert = artifact_instance_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction active total number\n let reaction_active_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.active.total_number', sensor='currentValue'});\n let reaction_active_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.active.total_number', sensor='maxValue'});\n let reaction_active_total_number_percent = reaction_active_total_number_used/reaction_active_total_number_limit;\n let reaction_active_total_number_percent_str = to_fixed(reaction_active_total_number_percent * 100, 0);\n let is_reaction_active_total_number_alert = reaction_active_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction trigger active total number\n let reaction_trigger_active_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.trigger.active.total_number', sensor='currentValue'});\n let reaction_trigger_active_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.trigger.active.total_number', sensor='maxValue'});\n let reaction_trigger_active_total_number_percent = reaction_trigger_active_total_number_used/reaction_trigger_active_total_number_limit;\n let reaction_trigger_active_total_number_percent_str = to_fixed(reaction_trigger_active_total_number_percent * 100, 0);\n let is_reaction_trigger_active_total_number_alert = reaction_trigger_active_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction trigger history buffer total number\n let reaction_trigger_history_buffer_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.trigger.history_buffer.total_number', sensor='currentValue'});\n let reaction_trigger_history_buffer_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.trigger.history_buffer.total_number', sensor='maxValue'});\n let reaction_trigger_history_buffer_total_number_percent = reaction_trigger_history_buffer_total_number_used/reaction_trigger_history_buffer_total_number_limit;\n let reaction_trigger_history_buffer_total_number_percent_str = to_fixed(reaction_trigger_history_buffer_total_number_percent * 100, 0);\n let is_reaction_trigger_history_buffer_total_number_alert = reaction_trigger_history_buffer_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction total number\n let reaction_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.total_number', sensor='currentValue'});\n let reaction_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.total_number', sensor='maxValue'});\n let reaction_total_number_percent = reaction_total_number_used/reaction_total_number_limit;\n let reaction_total_number_percent_str = to_fixed(reaction_total_number_percent * 100, 0);\n let is_reaction_total_number_alert = reaction_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction instance running total number\n let reaction_instance_running_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.running.total_number', sensor='currentValue'});\n let reaction_instance_running_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.running.total_number', sensor='maxValue'});\n let reaction_instance_running_total_number_percent = reaction_instance_running_total_number_used/reaction_instance_running_total_number_limit;\n let reaction_instance_running_total_number_percent_str = to_fixed(reaction_instance_running_total_number_percent * 100, 0);\n let is_reaction_instance_running_total_number_alert = reaction_instance_running_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction instance timeout total number\n let reaction_instance_timeout_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.timeout.total_number', sensor='currentValue'});\n let reaction_instance_timeout_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.timeout.total_number', sensor='maxValue'});\n let reaction_instance_timeout_total_number_percent = reaction_instance_timeout_total_number_used/reaction_instance_timeout_total_number_limit;\n let reaction_instance_timeout_total_number_percent_str = to_fixed(reaction_instance_timeout_total_number_percent * 100, 0);\n let is_reaction_instance_timeout_total_number_alert = reaction_instance_timeout_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction instance queued total number\n let reaction_instance_queued_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.queued.total_number', sensor='currentValue'});\n let reaction_instance_queued_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.queued.total_number', sensor='maxValue'});\n let reaction_instance_queued_total_number_percent = reaction_instance_queued_total_number_used/reaction_instance_queued_total_number_limit;\n let reaction_instance_queued_total_number_percent_str = to_fixed(reaction_instance_queued_total_number_percent * 100, 0);\n let is_reaction_instance_queued_total_number_alert = reaction_instance_queued_total_number_percent > ALERT_THRESHOLD;\n\n\n// reaction instance total number\n let reaction_instance_total_number_used = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.total_number', sensor='currentValue'});\n let reaction_instance_total_number_limit = avg({project='reactor', cluster='prod', service='prod_pull', group='projectQuota', projectKey='maps-analytics', resourceTypeKey='reaction.instance.total_number', sensor='maxValue'});\n let reaction_instance_total_number_percent = reaction_instance_total_number_used/reaction_instance_total_number_limit;\n let reaction_instance_total_number_percent_str = to_fixed(reaction_instance_total_number_percent * 100, 0);\n let is_reaction_instance_total_number_alert = reaction_instance_total_number_percent > ALERT_THRESHOLD;\n\n\n\nalarm_if(is_artifact_total_number_alert);\n alarm_if(is_artifact_instance_total_number_alert);\n alarm_if(is_reaction_active_total_number_alert);\n alarm_if(is_reaction_trigger_active_total_number_alert);\n alarm_if(is_reaction_trigger_history_buffer_total_number_alert);\n alarm_if(is_reaction_total_number_alert);\n alarm_if(is_reaction_instance_running_total_number_alert);\n alarm_if(is_reaction_instance_timeout_total_number_alert);\n alarm_if(is_reaction_instance_queued_total_number_alert);\n alarm_if(is_reaction_instance_total_number_alert);\n",
                        "checkExpression": ""
                    }
                },
                "annotations": {
                    "solomon_dashboard_id": "",
                    "description": "{{#expression.is_artifact_total_number_alert}} Reactor artifact total number quota usage ({{expression.artifact_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_artifact_total_number_alert}}\n{{#expression.is_artifact_instance_total_number_alert}} Reactor artifact instance total number quota usage ({{expression.artifact_instance_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_artifact_instance_total_number_alert}}\n{{#expression.is_reaction_active_total_number_alert}} Reactor reaction active total number quota usage ({{expression.reaction_active_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_active_total_number_alert}}\n{{#expression.is_reaction_trigger_active_total_number_alert}} Reactor reacting trigger active total number quota usage ({{expression.reaction_trigger_active_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_trigger_active_total_number_alert}}\n{{#expression.is_reaction_trigger_history_buffer_total_number_alert}} Reactor reaction trigger history buffer total number quota usage ({{expression.reaction_trigger_history_buffer_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_trigger_history_buffer_total_number_alert}}\n{{#expression.is_reaction_total_number_alert}} Reactor reaction total number quota usage ({{expression.reaction_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_total_number_alert}}\n{{#expression.is_reaction_instance_running_total_number_alert}} Reactor reaction instance running total number quota usage ({{expression.reaction_instance_running_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_instance_running_total_number_alert}}\n{{#expression.is_reaction_instance_timeout_total_number_alert}} Reactor reaction instance timeout total number quota usage ({{expression.reaction_instance_timeout_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_instance_timeout_total_number_alert}}\n{{#expression.is_reaction_instance_queued_total_number_alert}} Reactor reaction instance queued total number quota usage ({{expression.reaction_instance_queued_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_instance_queued_total_number_alert}}\n{{#expression.is_reaction_instance_total_number_alert}} Reactor reaction instance total number quota usage ({{expression.reaction_instance_total_number_percent_str}}%) is exceeded threshold limit {{expression.alert_threshold_str}}%. {{/expression.is_reaction_instance_total_number_alert}}\n",
                    "juggler_host": "maps-analytics",
                    "juggler_service": "maps-analytics_reactor-quota-exceeded"
                },
                "windowSecs": 300,
                "delaySecs": 0,
                "resolvedEmptyPolicy": "RESOLVED_EMPTY_DEFAULT",
                "noPointsPolicy": "NO_POINTS_DEFAULT"
            }
        ]
    }
}