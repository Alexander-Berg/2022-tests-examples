{
    "test_bs_outlay_acting.test_bs_outlay_acting": {
        "next_unacted_rows_path": [
            {
                "ActRowID": "1",
                "BillableAmount": 6.0,
                "BlockID": 1,
                "Clicks": 0,
                "ClientID": 1,
                "ContractID": 1,
                "DSPID": 1,
                "DT": "2020-09-01T00:00:00+0300",
                "PageID": 1,
                "ProductID": 1,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 6.0,
                "RUBTurnoverWithoutNDS": 7.0,
                "Shows": 1
            },
            {
                "ActRowID": "3",
                "BillableAmount": 3.0,
                "BlockID": 1,
                "Clicks": 0,
                "ClientID": 1,
                "ContractID": 1,
                "DSPID": 1,
                "DT": "2020-08-01T00:00:00+0300",
                "PageID": 1,
                "ProductID": 1,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 3.0,
                "RUBTurnoverWithoutNDS": 5.0,
                "Shows": 7
            },
            {
                "ActRowID": "5",
                "BillableAmount": 6.0,
                "BlockID": 1,
                "Clicks": 0,
                "ClientID": 1,
                "ContractID": 3,
                "DSPID": 1,
                "DT": "2020-09-01T00:00:00+0300",
                "PageID": 1,
                "ProductID": 1,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 6.0,
                "RUBTurnoverWithoutNDS": 7.0,
                "Shows": 1
            }
        ],
        "output_acted_rows_path": [
            {
                "ActCurrency": "RUB",
                "ActEndDatetime": "2020-10-31 00:00:00",
                "ActRowID": "2",
                "ActStartDatetime": "2020-10-01 00:00:00",
                "BillableAmount": 6.0,
                "BlockID": 2,
                "Clicks": 1,
                "ClientID": 2,
                "ContractID": 2,
                "ContractStateData": {
                    "uri": "file://test_bs_outlay_acting.test_bs_outlay_acting/extracted"
                },
                "DSPID": 2,
                "DT": "2020-09-01T00:00:00+0300",
                "PageID": 2,
                "ProductID": 2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 6.0,
                "RUBTurnoverWithoutNDS": 7.0,
                "Shows": 0
            },
            {
                "ActCurrency": "RUB",
                "ActEndDatetime": "2020-10-31 00:00:00",
                "ActRowID": "4",
                "ActStartDatetime": "2020-10-01 00:00:00",
                "BillableAmount": 3.0,
                "BlockID": 2,
                "Clicks": 7,
                "ClientID": 2,
                "ContractID": 2,
                "ContractStateData": {
                    "uri": "file://test_bs_outlay_acting.test_bs_outlay_acting/extracted.0"
                },
                "DSPID": 2,
                "DT": "2020-08-01T00:00:00+0300",
                "PageID": 2,
                "ProductID": 2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 3.0,
                "RUBTurnoverWithoutNDS": 5.0,
                "Shows": 0
            }
        ],
        "output_dropped_rows_path": [
            {
                "ActCurrency": "RUB",
                "ActEndDatetime": "2020-10-31 00:00:00",
                "ActRowID": "6",
                "ActStartDatetime": "2020-10-01 00:00:00",
                "BillableAmount": 6.0,
                "BlockID": 3,
                "Clicks": 0,
                "ClientID": 3,
                "ContractID": 4,
                "ContractStateData": {
                    "uri": "file://test_bs_outlay_acting.test_bs_outlay_acting/extracted.1"
                },
                "DSPID": 3,
                "DT": "2020-09-01T00:00:00+0300",
                "PageID": 3,
                "ProductID": 3,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 6.0,
                "RUBTurnoverWithoutNDS": 7.0,
                "Shows": 1
            }
        ]
    },
    "test_bs_outlay_group_rows.test_bs_outlay_group_rows": {
        "next_unacted_events": [
            {
                "BillableAmount": 0.1,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": null,
                "CostCur": null,
                "DSPID": 1,
                "EventCostVATCorrected": null,
                "EventDate": 1605042000,
                "EventTime": null,
                "FakePrice": null,
                "ImpID": 1,
                "LBMessageUID": "5",
                "OutputProductID": 1,
                "OutputStatus": "tariffed",
                "OwnerID": null,
                "PageID": 1,
                "PartnerCost": null,
                "PartnerPrice": null,
                "PartnerStatID": null,
                "PlaceID": null,
                "Price": null,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 0.1,
                "RUBTurnoverWithoutNDS": 0.2,
                "TypeID": null,
                "UnixTime": null,
                "YandexPrice": null,
                "_BillingTS": null,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            }
        ],
        "output_dropped_events": [
            {
                "BillableAmount": -0.5,
                "BillableEventType": "undo-block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": null,
                "CostCur": null,
                "DSPID": 1,
                "EventCostVATCorrected": null,
                "EventDate": 1602363600,
                "EventTime": null,
                "FakePrice": null,
                "ImpID": 1,
                "LBMessageUID": "0",
                "OutputProductID": 1,
                "OutputStatus": "dropped_untarffed",
                "OwnerID": null,
                "PageID": 1,
                "PartnerCost": null,
                "PartnerPrice": null,
                "PartnerStatID": null,
                "PlaceID": null,
                "Price": null,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -0.5,
                "RUBTurnoverWithoutNDS": -0.6,
                "TypeID": null,
                "UnixTime": null,
                "YandexPrice": null,
                "_BillingTS": null,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 0.1,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": null,
                "CostCur": null,
                "DSPID": 1,
                "EventCostVATCorrected": null,
                "EventDate": 1599771600,
                "EventTime": null,
                "FakePrice": null,
                "ImpID": 1,
                "LBMessageUID": "4",
                "OutputProductID": 1,
                "OutputStatus": "tariffed",
                "OwnerID": null,
                "PageID": 1,
                "PartnerCost": null,
                "PartnerPrice": null,
                "PartnerStatID": null,
                "PlaceID": null,
                "Price": null,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 0.1,
                "RUBTurnoverWithoutNDS": 0.2,
                "TypeID": null,
                "UnixTime": null,
                "YandexPrice": null,
                "_BillingTS": null,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            }
        ],
        "output_prepared_rows": [
            {
                "ActRowID": "2020-10-01T00:00:00+0300@1@1@1@1@1",
                "BillableAmount": 0.4,
                "BlockID": 1,
                "Clicks": 0,
                "ClientID": 1,
                "ContractID": 1,
                "DSPID": 1,
                "DT": "2020-10-01T00:00:00+0300",
                "PageID": 1,
                "ProductID": 1,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 0.4,
                "RUBTurnoverWithoutNDS": 0.5,
                "Shows": 1
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@2@2@2@2@2",
                "BillableAmount": 0.3,
                "BlockID": 2,
                "Clicks": 1,
                "ClientID": 2,
                "ContractID": 2,
                "DSPID": 2,
                "DT": "2020-10-01T00:00:00+0300",
                "PageID": 2,
                "ProductID": 2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 0.3,
                "RUBTurnoverWithoutNDS": 0.4,
                "Shows": 0
            }
        ],
        "output_reverse_events_index": [
            {
                "ActRowID": "2020-10-01T00:00:00+0300@1@1@1@1@1",
                "LBMessageUID": "1"
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@1@1@1@1@1",
                "LBMessageUID": "2"
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@1@1@1@1@1",
                "LBMessageUID": "3"
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@2@2@2@2@2",
                "LBMessageUID": "6"
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@2@2@2@2@2",
                "LBMessageUID": "7"
            },
            {
                "ActRowID": "2020-10-01T00:00:00+0300@2@2@2@2@2",
                "LBMessageUID": "8"
            }
        ]
    },
    "test_bs_outlay_retariffication.test_bs_outlay_retariffication[no_published_retariffication_data]": {
        "output_retariffed_events_path": [
            {
                "BillableAmount": -1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.4\"}",
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -13.5,
                "RUBTurnoverWithoutNDS": -30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_no_published_retariffication_data_/extracted"
                },
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 27.0,
                "RUBTurnoverWithoutNDS": 30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_no_published_retariffication_data_/extracted.0"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1578085200,
                "EventTime": 1578085201,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_completion_out_of_contract_bounds_3",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 1,
                "PageID": 20,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1578085201,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 41,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.6\"}",
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 40,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_no_published_retariffication_data_/extracted.1"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": null,
                "BillableEventType": "undo-block-show",
                "ClientID": null,
                "ContractID": null,
                "ContractObject": null,
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": -1.2,
                "EventDate": 1580418000,
                "EventTime": 1580504399,
                "FakePrice": -1.2,
                "ImpID": null,
                "LBMessageUID": "_dropped_undo_6",
                "OutputProductID": 100002,
                "OutputStatus": "untariffed-uptariffed",
                "OwnerID": null,
                "PageID": 21,
                "PartnerCost": -1.2,
                "PartnerPrice": -1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": -1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": null,
                "RUBTurnoverWithoutNDS": null,
                "TypeID": 0,
                "UnixTime": 1580677201,
                "YandexPrice": -1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            }
        ]
    },
    "test_bs_outlay_retariffication.test_bs_outlay_retariffication[published_retariffication_data_with_rollbacks]": {
        "output_retariffed_events_path": [
            {
                "BillableAmount": -1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.4\"}",
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -13.5,
                "RUBTurnoverWithoutNDS": -30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.4\"}",
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-rollback-published_rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 13.5,
                "RUBTurnoverWithoutNDS": 30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted"
                },
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 27.0,
                "RUBTurnoverWithoutNDS": 30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted.0"
                },
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -27.0,
                "RUBTurnoverWithoutNDS": -30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted.1"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1578085200,
                "EventTime": 1578085201,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_completion_out_of_contract_bounds_3",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 1,
                "PageID": 20,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1578085201,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted.2"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1578085200,
                "EventTime": 1578085201,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_completion_out_of_contract_bounds_3",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 1,
                "PageID": 20,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1578085201,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 41,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.6\"}",
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 41,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.6\"}",
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-rollback-published_rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 40,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted.3"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 40,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_with_rollbacks_/extracted.4"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": null,
                "BillableEventType": "undo-block-show",
                "ClientID": null,
                "ContractID": null,
                "ContractObject": null,
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": -1.2,
                "EventDate": 1580418000,
                "EventTime": 1580504399,
                "FakePrice": -1.2,
                "ImpID": null,
                "LBMessageUID": "_dropped_undo_6",
                "OutputProductID": 100002,
                "OutputStatus": "untariffed-uptariffed",
                "OwnerID": null,
                "PageID": 21,
                "PartnerCost": -1.2,
                "PartnerPrice": -1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": -1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": null,
                "RUBTurnoverWithoutNDS": null,
                "TypeID": 0,
                "UnixTime": 1580677201,
                "YandexPrice": -1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": null,
                "BillableEventType": "undo-block-show",
                "ClientID": null,
                "ContractID": null,
                "ContractObject": null,
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": -1.2,
                "EventDate": 1580418000,
                "EventTime": 1580504399,
                "FakePrice": -1.2,
                "ImpID": null,
                "LBMessageUID": "_dropped_undo_6",
                "OutputProductID": 100002,
                "OutputStatus": "untariffed-uptariffed-published_rollback",
                "OwnerID": null,
                "PageID": 21,
                "PartnerCost": -1.2,
                "PartnerPrice": -1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": -1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": null,
                "RUBTurnoverWithoutNDS": null,
                "TypeID": 0,
                "UnixTime": 1580677201,
                "YandexPrice": -1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            }
        ]
    },
    "test_bs_outlay_retariffication.test_bs_outlay_retariffication[published_retariffication_data_without_rollbacks]": {
        "output_retariffed_events_path": [
            {
                "BillableAmount": -1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.4\"}",
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -13.5,
                "RUBTurnoverWithoutNDS": -30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.4\"}",
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-rollback-published_rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 13.5,
                "RUBTurnoverWithoutNDS": 30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted"
                },
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 27.0,
                "RUBTurnoverWithoutNDS": 30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "click",
                "ClientID": 2,
                "ContractID": 2,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted.0"
                },
                "CostCur": 1.2,
                "DSPID": null,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_collateral_pct_change_7",
                "OutputProductID": 542,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 2,
                "PageID": 200,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": 542,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -27.0,
                "RUBTurnoverWithoutNDS": -30.0,
                "TypeID": 0,
                "UnixTime": 1577826001,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted.1"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1578085200,
                "EventTime": 1578085201,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_completion_out_of_contract_bounds_3",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 1,
                "PageID": 20,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1578085201,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 1,
                "ContractID": 1,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted.2"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1578085200,
                "EventTime": 1578085201,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_completion_out_of_contract_bounds_3",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 1,
                "PageID": 20,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1578085201,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 41,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.6\"}",
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 41,
                "ContractObject": "{\"uri\": \"file://test_bs_outlay.test_tariffication_layout_cases_bsp_log_/extracted.6\"}",
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-rollback-published_rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": 1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 40,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted.3"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": 1.2,
                "RUBTurnoverWithoutNDS": 0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": -1.2,
                "BillableEventType": "block-show",
                "ClientID": 4,
                "ContractID": 40,
                "ContractObject": {
                    "uri": "file://test_bs_outlay_retariffication.test_bs_outlay_retariffication_published_retariffication_data_without_rollbacks_/extracted.4"
                },
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": 1.2,
                "EventDate": 1577826000,
                "EventTime": 1577826001,
                "FakePrice": 1.2,
                "ImpID": null,
                "LBMessageUID": "_contracts_dt_overlap_1",
                "OutputProductID": 100002,
                "OutputStatus": "tariffed-uptariffed-published_rollback",
                "OwnerID": 4,
                "PageID": 400,
                "PartnerCost": 1.2,
                "PartnerPrice": 1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": 1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": -1.2,
                "RUBTurnoverWithoutNDS": -0.0,
                "TypeID": 0,
                "UnixTime": 1577864101,
                "YandexPrice": 1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": null,
                "BillableEventType": "undo-block-show",
                "ClientID": null,
                "ContractID": null,
                "ContractObject": null,
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": -1.2,
                "EventDate": 1580418000,
                "EventTime": 1580504399,
                "FakePrice": -1.2,
                "ImpID": null,
                "LBMessageUID": "_dropped_undo_6",
                "OutputProductID": 100002,
                "OutputStatus": "untariffed-uptariffed",
                "OwnerID": null,
                "PageID": 21,
                "PartnerCost": -1.2,
                "PartnerPrice": -1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": -1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": null,
                "RUBTurnoverWithoutNDS": null,
                "TypeID": 0,
                "UnixTime": 1580677201,
                "YandexPrice": -1.2,
                "_RollbackPublished": 0,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            },
            {
                "BillableAmount": null,
                "BillableEventType": "undo-block-show",
                "ClientID": null,
                "ContractID": null,
                "ContractObject": null,
                "CostCur": 1.2,
                "DSPID": 1,
                "EventCostVATCorrected": -1.2,
                "EventDate": 1580418000,
                "EventTime": 1580504399,
                "FakePrice": -1.2,
                "ImpID": null,
                "LBMessageUID": "_dropped_undo_6",
                "OutputProductID": 100002,
                "OutputStatus": "untariffed-uptariffed-published_rollback",
                "OwnerID": null,
                "PageID": 21,
                "PartnerCost": -1.2,
                "PartnerPrice": -1.2,
                "PartnerStatID": 0,
                "PlaceID": null,
                "Price": -1.2,
                "RUBAggregatorRewardWithoutNDS": null,
                "RUBRewardWithoutNDS": null,
                "RUBTurnoverWithoutNDS": null,
                "TypeID": 0,
                "UnixTime": 1580677201,
                "YandexPrice": -1.2,
                "_RollbackPublished": 1,
                "_chunk_record_index": null,
                "_offset": null,
                "_partition": null,
                "_topic": null,
                "_topic_cluster": null
            }
        ]
    },
    "test_generate_act_meta.test_generate_act_meta": {
        "log_no_meta_when_not_acted": [
            [
                "generate_act_meta",
                20,
                "Last generated interval hasn't been processed yet"
            ]
        ],
        "new_meta_07": {
            "act_dt": "2020-07-31",
            "drop_events_after_month_day": 2,
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 1,
                                "next_offset": 3,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            },
            "prev_run_id": "2020-06-30",
            "ref_contracts_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 0,
                                "next_offset": 2,
                                "partition": 1
                            }
                        ],
                        "topic": "contr"
                    }
                ]
            },
            "run_id": "2020-07-31",
            "tariffed_till_meta": {
                "log_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 1,
                                    "next_offset": 3,
                                    "partition": 1
                                }
                            ],
                            "topic": "log"
                        }
                    ]
                },
                "ref_contracts_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 0,
                                    "next_offset": 2,
                                    "partition": 1
                                }
                            ],
                            "topic": "contr"
                        }
                    ]
                },
                "run_id": "2020-08-03T11:00:00"
            }
        },
        "new_meta_08_shift_10": {
            "act_dt": "2020-08-31",
            "drop_events_after_month_day": 10,
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 3,
                                "next_offset": 7,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            },
            "prev_run_id": "2020-07-31",
            "ref_contracts_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 0,
                                "next_offset": 4,
                                "partition": 1
                            }
                        ],
                        "topic": "contr"
                    }
                ]
            },
            "run_id": "2020-08-31",
            "tariffed_till_meta": {
                "log_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 5,
                                    "next_offset": 7,
                                    "partition": 1
                                }
                            ],
                            "topic": "log"
                        }
                    ]
                },
                "ref_contracts_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 0,
                                    "next_offset": 4,
                                    "partition": 1
                                }
                            ],
                            "topic": "contr"
                        }
                    ]
                },
                "run_id": "2020-09-11T11:00:00"
            }
        },
        "new_meta_08_shift_2": {
            "act_dt": "2020-08-31",
            "drop_events_after_month_day": 2,
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 3,
                                "next_offset": 5,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            },
            "prev_run_id": "2020-07-31",
            "ref_contracts_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 0,
                                "next_offset": 3,
                                "partition": 1
                            }
                        ],
                        "topic": "contr"
                    }
                ]
            },
            "run_id": "2020-08-31",
            "tariffed_till_meta": {
                "log_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 3,
                                    "next_offset": 5,
                                    "partition": 1
                                }
                            ],
                            "topic": "log"
                        }
                    ]
                },
                "ref_contracts_interval": {
                    "topics": [
                        {
                            "cluster": "c1",
                            "partitions": [
                                {
                                    "first_offset": 0,
                                    "next_offset": 3,
                                    "partition": 1
                                }
                            ],
                            "topic": "contr"
                        }
                    ]
                },
                "run_id": "2020-09-03T11:00:00"
            }
        },
        "new_meta_09_error": "AssertionError('Not enough tariffed tables')",
        "no_meta_when_not_acted": null
    },
    "test_generate_act_meta.test_generate_act_meta_raw_log[mnclose_trigger_date_01]": {
        "act_dt": "2020-07-31",
        "drop_events_after_month_day": 1,
        "log_interval": {
            "topics": [
                {
                    "cluster": "c1",
                    "partitions": [
                        {
                            "first_offset": 1,
                            "next_offset": 8,
                            "partition": 1
                        }
                    ],
                    "topic": "log"
                }
            ]
        },
        "prev_run_id": "2020-06-30",
        "run_id": "2020-07-31",
        "tariffed_till_meta": {
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 7,
                                "next_offset": 8,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            }
        }
    },
    "test_generate_act_meta.test_generate_act_meta_raw_log[mnclose_trigger_date_01_wo_time]": {
        "act_dt": "2020-07-31",
        "drop_events_after_month_day": 1,
        "log_interval": {
            "topics": [
                {
                    "cluster": "c1",
                    "partitions": [
                        {
                            "first_offset": 1,
                            "next_offset": 3,
                            "partition": 1
                        }
                    ],
                    "topic": "log"
                }
            ]
        },
        "prev_run_id": "2020-06-30",
        "run_id": "2020-07-31",
        "tariffed_till_meta": {
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 1,
                                "next_offset": 3,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            }
        }
    },
    "test_generate_act_meta.test_generate_act_meta_raw_log[mnclose_trigger_date_03]": {
        "act_dt": "2020-07-31",
        "drop_events_after_month_day": 2,
        "log_interval": {
            "topics": [
                {
                    "cluster": "c1",
                    "partitions": [
                        {
                            "first_offset": 1,
                            "next_offset": 14,
                            "partition": 1
                        }
                    ],
                    "topic": "log"
                }
            ]
        },
        "prev_run_id": "2020-06-30",
        "run_id": "2020-07-31",
        "tariffed_till_meta": {
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 13,
                                "next_offset": 14,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            }
        }
    },
    "test_generate_act_meta.test_generate_act_meta_raw_log[shift_days]": {
        "act_dt": "2020-07-31",
        "drop_events_after_month_day": 1,
        "log_interval": {
            "topics": [
                {
                    "cluster": "c1",
                    "partitions": [
                        {
                            "first_offset": 1,
                            "next_offset": 13,
                            "partition": 1
                        }
                    ],
                    "topic": "log"
                }
            ]
        },
        "prev_run_id": "2020-06-30",
        "run_id": "2020-07-31",
        "tariffed_till_meta": {
            "log_interval": {
                "topics": [
                    {
                        "cluster": "c1",
                        "partitions": [
                            {
                                "first_offset": 10,
                                "next_offset": 13,
                                "partition": 1
                            }
                        ],
                        "topic": "log"
                    }
                ]
            }
        }
    },
    "test_generate_act_meta.test_generate_act_meta_raw_log[wrong_mnclose_act_dt]": "AssertionError('MNClose Act Date or The New Act Date is incorrect')"
}
