# -*- coding: utf-8 -*-

import datetime
import urlparse

from temp.MTestlib import MTestlib as mtl

rpc = mtl.rpc
test_rpc = mtl.test_rpc

after = datetime.datetime(2015, 7, 6, 11, 0, 0)
disc_dt = datetime.datetime(2015, 7, 6, 11, 0, 0)

begin_dt = after
request_dt = after  ##не меняется
invoice_dt = after
campaigns_dt = after
act_dt = after

manager_id = None
manager_uid = None
contract_id = None
agency_id = None

# # -------- firm_id = 1 -------
person_type = 'ur'  # ЮЛ резидент РФ
paysys_id = 1003  # Банк для юридических лиц
service_id = 7  # Директ
product_id = 1475  # Рекламная кампания

contract_type = 'no_agency'

# contract_type = 'no_agency_post'

# contract_type = 'comm_pre'

# contract_type = 'comm_post'

msr = 'Bucks'

qty = 80

client_id = None or mtl.create_client({'IS_AGENCY': 0, 'NAME': u'Petrov3'})
order_owner = client_id
invoice_owner = client_id

# # -------- Постоплата в кредит под агентством -------
# credit = 1
# agency_id = mtl.create_client({'IS_AGENCY': 1, 'NAME': u'LastMan'})
# invoice_owner = agency_id

# # -------- Предоплата под агентством -------
# agency_id = mtl.create_client({'IS_AGENCY': 1, 'NAME': u'LastMan'})
# invoice_owner = agency_id
# credit = 0

# # -------- Постоплата клиент -------
credit = 1

# # -------- Предоплата клиент -------
# credit = 0

mtl.link_client_uid(invoice_owner, 'torvald-test-0')

if order_owner == invoice_owner: agency_id = None

person_id = mtl.create_person(invoice_owner, person_type, {'phone': '234'})
service_order_id = mtl.get_next_service_order_id(service_id)
order_id = mtl.create_or_update_order(order_owner, product_id, service_id, service_order_id,
                                      {'TEXT': 'Py_Test order'}, agency_id=agency_id, manager_uid=manager_uid)
orders_list = [
    {'ServiceID': service_id, 'ServiceOrderID': service_order_id, 'Qty': qty, 'BeginDT': begin_dt}
]

contract_id = mtl.create_contract2(contract_type,
                                   {'client_id': invoice_owner, 'person_id': person_id, 'dt': '2015-04-30T00:00:00',
                                    'FINISH_DT': '2016-06-30T00:00:00',
                                    'is_signed': '2015-01-01T00:00:00'})  # перевод на маркет СРА предоплата ДС
col = urlparse.parse_qsl(
    '''col-new-num=01&col-new-collateral-type=1033&col-new-print-form-type=0&col-new-dt=2015-05-02T00%3A00%3A00&col-new-memo=&col-new-group02-grp-10-pp-1137-checkpassed=1&col-new-group02-grp-1000-commission-payback-pct=8+%25&col-new-group02-grp-1000-commission-type=48&col-new-group02-grp-1000-commission-declared-sum=&col-new-group02-grp-1000-supercommission=0&col-new-group02-grp-1014-supercommission-bonus=1&col-new-group02-grp-50-supercommission=0&col-new-group02-grp-80-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1021-commission-charge-type=1&col-new-group02-grp-1021-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1021-commission-payback-type=2&col-new-group02-grp-1021-commission-type=48&col-new-group02-grp-1021-supercommission-bonus=1&col-new-group02-grp-1021-supercommission=0&col-new-group02-grp-1021-commission-declared-sum=&col-new-group02-grp-1021-named-client-declared-sum=&col-new-group02-grp-1021-linked-contracts=1&limitcol-new-group02-grp-1021-linked-contracts=&col-new-group02-grp-1021-payment-type=3&col-new-group02-grp-1021-credit-type=2&col-new-group02-grp-1021-payment-term=25&col-new-group02-grp-1021-payment-term-max=&col-new-group02-grp-1021-credit-limit=17&limitcol-new-group02-grp-1021-credit-limit=&col-new-group02-grp-1021-credit-limit-single=500000&col-new-group02-grp-1021-turnover-forecast=17&limitcol-new-group02-grp-1021-turnover-forecast=&col-new-group02-grp-1021-services=1&col-new-group02-grp-1021-services-7=7&col-new-group02-grp-1021-services-11=11&col-new-group02-grp-1021-services-70=70&col-new-group02-grp-1022-fixed-market-discount-pct=&col-new-group02-grp-1006-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1008-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1008-commission-type=48&col-new-group02-grp-1008-commission-declared-sum=&col-new-group02-grp-1008-supercommission=0&col-new-group02-grp-1009-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1009-commission-type=48&col-new-group02-grp-1009-supercommission=0&col-new-group02-grp-1009-commission-declared-sum=&col-new-group02-grp-1009-payment-term=25&col-new-group02-grp-1009-credit-limit=17&limitcol-new-group02-grp-1009-credit-limit=&col-new-group02-grp-1009-credit-limit-single=500000&col-new-group02-grp-1009-turnover-forecast=17&limitcol-new-group02-grp-1009-turnover-forecast=&col-new-group02-grp-1010-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1010-payment-term=25&col-new-group02-grp-1010-credit-limit=17&limitcol-new-group02-grp-1010-credit-limit=&col-new-group02-grp-1010-credit-limit-single=500000&col-new-group02-grp-1010-turnover-forecast=17&limitcol-new-group02-grp-1010-turnover-forecast=&col-new-group02-grp-1019-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1019-discount-policy-type=0&col-new-group02-grp-1019-discount-fixed=0&col-new-group02-grp-1019-declared-sum=&col-new-group02-grp-1019-fixed-discount-pct=&col-new-group02-grp-1019-budget-discount-pct=&col-new-group02-grp-1019-discount-pct=&col-new-group02-grp-1019-discount-findt=&col-new-group02-grp-1013-commission-charge-type=1&col-new-group02-grp-1013-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1013-commission-payback-type=2&col-new-group02-grp-1013-commission-type=48&col-new-group02-grp-1013-supercommission=0&col-new-group02-grp-1013-commission-declared-sum=&col-new-group02-grp-1032-commission-payback-pct=8+%25&col-new-group02-grp-1020-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1020-credit-type=2&col-new-group02-grp-1020-payment-term=25&col-new-group02-grp-1020-payment-term-max=&col-new-group02-grp-1020-repayment-on-consume-checkpassed=1&col-new-group02-grp-1020-credit-limit=17&limitcol-new-group02-grp-1020-credit-limit=&col-new-group02-grp-1020-turnover-forecast=17&limitcol-new-group02-grp-1020-turnover-forecast=&col-new-group02-grp-1020-credit-limit-single=500000&col-new-group02-grp-90-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-100-personal-account-checkpassed=1&col-new-group02-grp-100-credit-limit=17&limitcol-new-group02-grp-100-credit-limit=&col-new-group02-grp-100-credit-limit-single=500000&col-new-group02-grp-100-turnover-forecast=17&limitcol-new-group02-grp-100-turnover-forecast=&col-new-group02-grp-110-commission-payback-pct=8+%25&col-new-group02-grp-110-credit-type=2&col-new-group02-grp-110-payment-term=25&col-new-group02-grp-110-payment-term-max=&col-new-group02-grp-110-calc-defermant=0&col-new-group02-grp-110-repayment-on-consume-checkpassed=1&col-new-group02-grp-110-credit-limit=17&limitcol-new-group02-grp-110-credit-limit=&col-new-group02-grp-110-credit-limit-single=500000&col-new-group02-grp-110-turnover-forecast=17&limitcol-new-group02-grp-110-turnover-forecast=&col-new-group02-grp-1031-commission-payback-pct=8+%25&col-new-group02-grp-1031-supercommission-bonus=1&col-new-group02-grp-1031-credit-type=2&col-new-group02-grp-1031-payment-term=25&col-new-group02-grp-1031-payment-term-max=&col-new-group02-grp-1031-calc-defermant=0&col-new-group02-grp-1031-repayment-on-consume-checkpassed=1&col-new-group02-grp-1031-credit-limit=17&limitcol-new-group02-grp-1031-credit-limit=&col-new-group02-grp-1031-turnover-forecast=17&limitcol-new-group02-grp-1031-turnover-forecast=&col-new-group02-grp-1031-credit-limit-single=500000&col-new-group02-grp-1033-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1033-supercommission-bonus=1&col-new-group02-grp-1033-payment-term=25&col-new-group02-grp-1033-credit-limit=17&limitcol-new-group02-grp-1033-credit-limit=&col-new-group02-grp-1033-turnover-forecast=17&limitcol-new-group02-grp-1033-turnover-forecast=&col-new-group02-grp-1033-credit-limit-single=500000&col-new-group02-grp-1035-client-limits=%5B%5D&col-new-group02-grp-1034-finish-dt=2016-06-30T00%3A00%3A00&col-new-group02-grp-1034-supercommission-bonus=1&col-new-group02-grp-1036-calc-termination=&col-new-group02-grp-1037-commission-categories=%5B%5D&col-new-group02-grp-1004-credit-type=2&col-new-group02-grp-1004-payment-term=25&col-new-group02-grp-1004-payment-term-max=&col-new-group02-grp-1004-credit-limit=17&limitcol-new-group02-grp-1004-credit-limit=&col-new-group02-grp-1004-turnover-forecast=17&limitcol-new-group02-grp-1004-turnover-forecast=&col-new-group02-grp-1004-credit-limit-single=500000&col-new-group02-grp-1039-adfox-products=%5B%7B%22id%22%3A%221%22%2C%22num%22%3A504400%2C%22name%22%3A%22ADFOX.Sites1+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%222%22%2C%22num%22%3A504401%2C%22name%22%3A%22ADFOX.Nets+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%223%22%2C%22num%22%3A504402%2C%22name%22%3A%22ADFOX.Mobile+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%224%22%2C%22num%22%3A504403%2C%22name%22%3A%22ADFOX.Exchange+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%225%22%2C%22num%22%3A504404%2C%22name%22%3A%22ADFOX.Adv+%28standart%29+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%226%22%2C%22num%22%3A504405%2C%22name%22%3A%22ADFOX.Sites1+%28shows%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%227%22%2C%22num%22%3A504406%2C%22name%22%3A%22ADFOX.Sites2+%28requests%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%228%22%2C%22num%22%3A504407%2C%22name%22%3A%22ADFOX.Sites%2Bmobile+%28shows%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%229%22%2C%22num%22%3A504408%2C%22name%22%3A%22ADFOX.Nets%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2210%22%2C%22num%22%3A504409%2C%22name%22%3A%22ADFOX.Mobile%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2211%22%2C%22num%22%3A504410%2C%22name%22%3A%22ADFOX.Exchange%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2212%22%2C%22num%22%3A504411%2C%22name%22%3A%22ADFOX.Adv+%28standart%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2213%22%2C%22num%22%3A504412%2C%22name%22%3A%22%D0%92%D1%8B%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0+%D0%BB%D0%BE%D0%B3%D0%BE%D0%B2+%D0%B8%D0%B7+%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2214%22%2C%22num%22%3A504413%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83+%D0%B8+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Sites%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2215%22%2C%22num%22%3A504414%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83+%D0%B8+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Sites%2BMobile%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2216%22%2C%22num%22%3A504415%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83+%D0%B8+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Nets%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2217%22%2C%22num%22%3A504416%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83+%D0%B8+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Mobile%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2218%22%2C%22num%22%3A504417%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83+%D0%B8+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Adv%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2219%22%2C%22num%22%3A504418%2C%22name%22%3A%22%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0+%D0%BD%D0%B5%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D0%BE%D0%B9+%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9+%D0%BE%D1%82%D1%87%D0%B5%D1%82%D0%BD%D0%BE%D1%81%D1%82%D0%B8%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2220%22%2C%22num%22%3A504419%2C%22name%22%3A%22%D0%9D%D0%B5%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D0%B0%D1%8F+%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F+%D0%BE%D1%82%D1%87%D0%B5%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C+%28%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2221%22%2C%22num%22%3A504420%2C%22name%22%3A%22%D0%97%D0%B0%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5+%D1%80%D0%B5%D0%BA%D0%BB%D0%B0%D0%BC%D0%BD%D0%BE%D0%B9+%D0%BA%D0%B0%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2222%22%2C%22num%22%3A504421%2C%22name%22%3A%22%D0%97%D0%B0%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5+%D1%80%D0%B5%D0%BA%D0%BB%D0%B0%D0%BC%D0%BD%D0%BE%D0%B9+%D0%BA%D0%B0%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8+Adv%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2223%22%2C%22num%22%3A504422%2C%22name%22%3A%22%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F+%5C%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8E%5C%22+%D0%B4%D0%BB%D1%8F+ADFOX.Sites1+%28shows%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2224%22%2C%22num%22%3A504423%2C%22name%22%3A%22%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F+%C2%AB%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8E%C2%BB+%D0%B4%D0%BB%D1%8F+ADFOX.Sites%2BMobile%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2225%22%2C%22num%22%3A504424%2C%22name%22%3A%22%D0%9A%D0%B0%D1%81%D1%82%D0%BE%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F+%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%B0%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2226%22%2C%22num%22%3A504440%2C%22name%22%3A%22ADFOX.Sites%2Bmobile+%28requests%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2227%22%2C%22num%22%3A504441%2C%22name%22%3A%22ADFOX.Sites%2Bmobile+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2228%22%2C%22num%22%3A504642%2C%22name%22%3A%22ADFOX.Adv+%28agency%29+default%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2229%22%2C%22num%22%3A504643%2C%22name%22%3A%22ADFOX.Adv+%28agency%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2230%22%2C%22num%22%3A504644%2C%22name%22%3A%22%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F+%5C%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8E%5C%22+%D0%B4%D0%BB%D1%8F+ADFOX.Sites2+%28requests%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2231%22%2C%22num%22%3A504930%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+ADFOX.Adv+%28AA-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2232%22%2C%22num%22%3A504931%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+Adv+%28%D0%90%D0%B3%D0%B5%D0%BD%D1%82%D1%81%D1%82%D0%B2%D0%BE%29+%28AA-AG-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2233%22%2C%22num%22%3A504932%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+Mobile+%28AM-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2234%22%2C%22num%22%3A504933%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+Nets+%28AN-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2235%22%2C%22num%22%3A504934%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+Sites+%28AS-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2236%22%2C%22num%22%3A504935%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+Sites%2BMobile+%28AS%2BM-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2237%22%2C%22num%22%3A504936%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%2C+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83+%D0%B8+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83+%D0%B4%D0%BB%D1%8F+Sites-R+%28AS-R-PVD%29%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2238%22%2C%22num%22%3A505139%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%BF%D0%BE%D0%BB%D1%83%5Cr%5Cn%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2239%22%2C%22num%22%3A505140%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%B2%D0%BE%D0%B7%D1%80%D0%B0%D1%81%D1%82%D1%83%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%2C%7B%22id%22%3A%2240%22%2C%22num%22%3A505141%2C%22name%22%3A%22%D0%A2%D0%B0%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%9C%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%BE%D0%B2+%D0%BF%D0%BE+%D0%B4%D0%BE%D1%85%D0%BE%D0%B4%D1%83%22%2C%22scale%22%3A%22%22%2C%22account%22%3A%22%22%7D%5D&col-new-group02-grp-1017-payment-term-max=&col-new-group02-grp-1040-autoru-q-plan=&col-new-group02-grp-1005-credit-type=2&col-new-group02-grp-1005-payment-term=25&col-new-group02-grp-1005-payment-term-max=&col-new-group02-grp-1005-repayment-on-consume-checkpassed=1&col-new-group02-grp-1005-credit-limit=17&limitcol-new-group02-grp-1005-credit-limit=&col-new-group02-grp-1005-turnover-forecast=17&limitcol-new-group02-grp-1005-turnover-forecast=&col-new-group02-grp-1005-credit-limit-single=500000&col-new-group02-grp-1012-calc-defermant=0&col-new-group02-grp-115-declared-sum=&col-new-group02-grp-115-discount-pct=&col-new-group02-grp-115-discount-findt=&col-new-group02-grp-1011-discount-policy-type=0&col-new-group02-grp-1011-discount-fixed=0&col-new-group02-grp-1011-declared-sum=&col-new-group02-grp-1011-fixed-discount-pct=&col-new-group02-grp-1011-budget-discount-pct=&col-new-group02-grp-1011-discount-pct=&col-new-group02-grp-1011-discount-findt=&col-new-group02-grp-1015-federal-budget=&col-new-group02-grp-1015-belarus-budget=&col-new-group02-grp-1015-ukr-budget=&col-new-group02-grp-1015-federal-declared-budget=&col-new-group02-grp-1015-federal-annual-program-budget=&col-new-group02-grp-1015-year-product-discount=&col-new-group02-grp-1015-year-planning-discount=&col-new-group02-grp-1015-consolidated-discount=&col-new-group02-grp-1015-use-ua-cons-discount-checkpassed=1&col-new-group02-grp-1015-use-consolidated-discount-checkpassed=1&col-new-group02-grp-1015-regional-budget=&col-new-group02-grp-1015-use-regional-cons-discount-checkpassed=1&col-new-group02-grp-1015-pda-budget=&col-new-group02-grp-1015-autoru-budget=&col-new-group02-grp-1001-supercommission-bonus=1&col-new-group02-grp-1001-services=1&col-new-group02-grp-1001-services-7=7&col-new-group02-grp-1001-services-11=11&col-new-group02-grp-1001-services-70=70&col-new-group02-grp-1023-currency=810&col-new-group02-grp-1023-bank-details-id=21&col-new-group02-grp-1024-loyal-clients=%5B%5D&col-new-group02-grp-1025-pp-1137-checkpassed=1&col-new-group02-grp-1026-brand-clients=%5B%5D&col-new-group02-grp-1027-retro-discount=&col-new-group02-grp-1028-partner-max-commission-sum=&col-new-group02-grp-1028-partner-min-commission-sum=&col-new-group02-grp-2222-advance-payment-sum=&col-new-group02-grp-1030-partner-commission-type=1&col-new-group02-grp-1030-partner-commission-pct2=&col-new-group02-grp-1030-partner-commission-pct=&col-new-group02-grp-1030-partner-commission-sum=&col-new-group02-grp-1030-partner-max-commission-sum=&col-new-group02-grp-1030-partner-min-commission-sum=&col-new-group02-grp-1038-service-min-cost=&col-new-is-booked-checkpassed=1&col-new-is-booked-dt=&col-new-is-faxed-checkpassed=1&col-new-is-signed=&col-new-is-signed-checkpassed=1&col-new-is-signed-date=10+%D0%B8%D1%8E%D0%BB+2015+%D0%B3.&col-new-is-signed-dt=2015-07-10T00%3A00%3A00&col-new-sent-dt-checkpassed=1&col-new-collateral-form=&id=''' + str(
        contract_id))
collateral_id = rpc.Balance.CreateContract(16571028, {k: v.decode('utf-8') for k, v in col})
print 'Collateral: ' + str(collateral_id) + ')'
sql = "update t_contract_collateral set is_signed = date'2014-12-05' where contract2_id = %s and collateral_type_id = 1033" % str(
    contract_id)
test_rpc.ExecuteSQL(sql);
test_rpc.ExecuteSQL('commit')

for x in range(1, 11):
    request_id = mtl.create_request(invoice_owner, orders_list, request_dt)
    invoice_id1 = mtl.create_invoice(request_id, person_id, paysys_id, credit, contract_id=contract_id, overdraft=0,
                                     endbuyer_id=None)

mtl.do_campaigns(service_id, service_order_id, {msr: 780}, 0, campaigns_dt)

mtl.act_accounter(invoice_owner, 1, datetime.datetime.today())
# mtl.do_campaigns(service_id, service_order_id, {msr: 140}, 0, campaigns_dt)
# numbers = [i for i in range(1, 101) if i % 10 == 0]
# print numbers
#
# for x in numbers:
#     mtl.do_campaigns(service_id, service_order_id, {msr: x}, 0, campaigns_dt)
#     mtl.act_accounter(invoice_owner,1,datetime.datetime.today())
# mtl.do_campaigns(service_id, service_order_id, {msr: 10}, 0, campaigns_dt)
