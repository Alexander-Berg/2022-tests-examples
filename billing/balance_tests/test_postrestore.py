# coding=utf-8

from sqlalchemy.exc import DatabaseError

EXPECTED_CONSTRAINTS = [
    ('BO', 'PLSQL_PROFILER_DATA', 'RUNID', 'BO', 'PLSQL_PROFILER_UNITS', 'RUNID'),
    ('BO', 'PLSQL_PROFILER_DATA', 'RUNID', 'BO', 'PLSQL_PROFILER_UNITS', 'UNIT_NUMBER'),
    ('BO', 'PLSQL_PROFILER_DATA', 'UNIT_NUMBER', 'BO', 'PLSQL_PROFILER_UNITS', 'RUNID'),
    ('BO', 'PLSQL_PROFILER_DATA', 'UNIT_NUMBER', 'BO', 'PLSQL_PROFILER_UNITS', 'UNIT_NUMBER'),
    ('BO', 'PLSQL_PROFILER_UNITS', 'RUNID', 'BO', 'PLSQL_PROFILER_RUNS', 'RUNID'),
    ('BO', 'T_ACCOUNT', 'INTERNAL', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_ACCOUNT', 'SIMPLE_CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ACL_2', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_ACL_2', 'PERM', 'BO', 'T_PERMITION', 'PERM'),
    ('BO', 'T_ACTED_COMPLETION', 'CONSUME_ID', 'BO', 'T_CONSUME', 'ID'),
    ('BO', 'T_ACT_INTERNAL', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_ACT_INTERNAL', 'STATE_ID', 'BO', 'T_ACT_STATE', 'ID'),
    ('BO', 'T_ACT_REFUNDMENT', 'ACT_ID', 'BO', 'T_ACT_INTERNAL', 'ID'),
    ('BO', 'T_ACT_TRANS', 'ACT_ID', 'BO', 'T_ACT_INTERNAL', 'ID'),
    ('BO', 'T_ACT_TRANS', 'BUDGET_ID', 'BO', 'T_ENDBUYER_BUDGET', 'ID'),
    ('BO', 'T_ACT_TRANS', 'CONSUME_ID', 'BO', 'T_CONSUME', 'ID'),
    ('BO', 'T_APPLE_INAPP_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_ASSIST_REESTR', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_BAD_DEBT_ACT', 'ACT_ID', 'BO', 'T_ACT_INTERNAL', 'ID'),
    ('BO', 'T_BANK_DETAILS', 'BANK_ID', 'BO', 'T_PAYMENT_BANK', 'ID'),
    ('BO', 'T_BANNED_CLIENT', 'BANNED_CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_BANNED_CLIENT', 'BANNED_INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_BANNED_CLIENT', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CART_ITEM', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CART_ITEM', 'SERVICE_ID', 'META', 'T_SERVICE', 'ID'),
    ('BO', 'T_CCARD_BOUND_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_BOUND_PAYMENT', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_CCARD_BOUND_PAYMENT', 'REQUEST_ID', 'BO', 'T_REQUEST', 'ID'),
    ('BO', 'T_CCARD_SIX_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_SIX_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_CCARD_TUR_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_UA_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_UA_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_CCARD_UA_PAY_REGISTER_LINE', 'PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_USA_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_USA_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CCARD_USA_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_CLIENT', 'PERSON_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_CLIENT', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_CLIENT_BANK', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_BANK', 'PERSON_CATEGORY', 'BO', 'T_PERSON_CATEGORY', 'CATEGORY'),
    ('BO', 'T_CLIENT_DIRECT_BUDGET', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_DISCOUNT_2010', 'PAYMENT_TERM_ID', 'BO', 'T_PAYMENT_TERM', 'ID'),
    ('BO', 'T_CLIENT_FRAUD_STATUS', 'ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_FRAUD_STATUS', 'SUSPICIOUS_PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_CLIENT_GROUP', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_GROUP', 'GROUP_ID', 'BO', 'T_GROUP', 'ID'),
    ('BO', 'T_CLIENT_LINK_HISTORY', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_OVERDRAFT', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CLIENT_OVERDRAFT', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_COMPLETION_HISTORY', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_COMPLETION_HISTORY_2015', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_COMPLETION_HISTORY_OLD', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_COMSN_TYPE_DISCOUNT_TYPES', 'CONTRACT_COMSN_TYPE_ID', 'BO', 'T_CONTRACT_COMSN_TYPE', 'ID'),
    ('BO', 'T_COMSN_TYPE_DISCOUNT_TYPES', 'DISCOUNT_TYPE_ID', 'META', 'T_DISCOUNT_TYPE', 'ID'),
    ('BO', 'T_CONSUME', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_CONSUME', 'PARENT_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_CONSUME', 'PROMO_CODE_ID', 'BO', 'T_PROMO_CODE', 'ID'),
    ('BO', 'T_CONTRACT2', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_CONTRACT2', 'PERSON_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_CONTRACT2', 'TYPE', 'BO', 'T_CONTRACT_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_ATTRIBUTES', 'COLLATERAL_ID', 'BO', 'T_CONTRACT_COLLATERAL', 'ID'),
    ('BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'PARENT_CODE', 'BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'CODE'),
    ('BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'PARENT_CODE', 'BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'TYPE', 'BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'CODE'),
    ('BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'TYPE', 'BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_ATTRIBUTE_TYPES', 'TYPE', 'BO', 'T_CONTRACT_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_COLLATERAL', 'CONTRACT2_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_CONTRACT_COLLATERAL_ATTRS', 'COLTYPE_ID', 'BO', 'T_CONTRACT_COLLATERAL_TYPES', 'ID'),
    ('BO', 'T_CONTRACT_COLLATERAL_ATTRS', 'CONTRACT_TYPE', 'BO', 'T_CONTRACT_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_COLLATERAL_TYPES', 'COLLATERAL_CLASS', 'BO', 'T_CONTRACT_COLLATERAL_CLASS', 'COLLATERAL_CLASS'),
    ('BO', 'T_CONTRACT_COLLATERAL_TYPES', 'CONTRACT_TYPE', 'BO', 'T_CONTRACT_TYPES', 'TYPE'),
    ('BO', 'T_CONTRACT_COMSN_TYPE_RATE', 'COMMISSION_TYPE_ID', 'BO', 'T_CONTRACT_COMSN_TYPE', 'ID'),
    ('BO', 'T_CONTRACT_PDF_EMAIL', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_CONTRACT_RULES', 'TYPE', 'BO', 'T_CONTRACT_TYPES', 'TYPE'),
    ('BO', 'T_COUNTRY_SERVICE_DATA', 'PAY_POLICY_ID', 'BO', 'T_PAY_POLICY', 'ID'),
    ('BO', 'T_COUNTRY_SERVICE_DATA', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_CRPAYMENT', 'CRPAYMENT_REPORT_ID', 'BO', 'T_CRPAYMENT_REPORT', 'ID'),
    ('BO', 'T_CRPAYMENT_INVOICE', 'CRPAYMENT_ID', 'BO', 'T_CRPAYMENT', 'ID'),
    ('BO', 'T_CRPAYMENT_INVOICE', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_CRPAYMENT_OEBS_BONUS', 'PERIOD_ID', 'BO', 'T_CRPAYMENT_REPORT', 'ID'),
    ('BO', 'T_CRPAYMENT_OEBS_DATA', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_CRPAYMENT_OEBS_DATA', 'PERIOD_ID', 'BO', 'T_CRPAYMENT_REPORT', 'ID'),
    ('BO', 'T_CRPAYMENT_OEBS_NC_BONUS', 'PERIOD_ID', 'BO', 'T_CRPAYMENT_REPORT', 'ID'),
    ('BO', 'T_CRPAYMENT_REPORT', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_DEFERPAY', 'OPERATION_ID', 'BO', 'T_OPERATION', 'ID'),
    ('BO', 'T_DEFERPAY', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_DEFERPAY', 'REQUEST_ID', 'BO', 'T_REQUEST', 'ID'),
    ('BO', 'T_DISTR_DOWNLOAD_SCALE_PROD', 'DOWNLOAD_SCALE_ID', 'BO', 'T_DISTR_DOWNLOAD_SCALE', 'ID'),
    ('BO', 'T_DISTR_DOWNLOAD_SCALE_PROD', 'DOWNLOAD_TYPE_ID', 'BO', 'T_DISTRIBUTION_DOWNLOAD_TYPES', 'ID'),
    ('BO', 'T_ECOMPAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_ECOM_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_ECOM_PAYMENT', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_EDO_OFFER', 'EDO_TYPE_ID', 'META', 'T_EDO_TYPES', 'ID'),
    ('BO', 'T_ENDBUYER_BUDGET', 'ENDBUYER_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_ENDBUYER_ORDER', 'BUDGET_ID', 'BO', 'T_ENDBUYER_BUDGET', 'ID'),
    ('BO', 'T_ENDBUYER_ORDER', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ENDBUYER_SUBCLIENT', 'AGENCY_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ENDBUYER_SUBCLIENT', 'BUDGET_ID', 'BO', 'T_ENDBUYER_BUDGET', 'ID'),
    ('BO', 'T_ENDBUYER_SUBCLIENT', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ENUMS_TREE', 'PARENT_ID', 'BO', 'T_ENUMS_TREE', 'ID'),
    ('BO', 'T_FIAS', 'PARENT_GUID', 'BO', 'T_FIAS', 'GUID'),
    ('BO', 'T_FIAS_HOUSE', 'PARENT_GUID', 'BO', 'T_FIAS', 'GUID'),
    ('BO', 'T_FIAS_POSTCODES', 'PARENT_GUID', 'BO', 'T_FIAS', 'GUID'),
    ('BO', 'T_FIRM_EXPORT', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_FIRM_INTERBRANCH', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_FIRM_INTERBRANCH', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_FIRM_INTERBRANCH', 'ROOT_FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_FISCAL_RECEIPT', 'PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_GOOGLE_INAPP_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_GROUP', 'PARENT_ID', 'BO', 'T_GROUP', 'ID'),
    ('BO', 'T_INVOICE', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_INVOICE', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_INVOICE', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_INVOICE', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_INVOICE', 'PAYMENT_METHOD_ID', 'META', 'T_PAYMENT_METHOD', 'ID'),
    ('BO', 'T_INVOICE', 'PAYMENT_TERM_ID', 'BO', 'T_PAYMENT_TERM', 'ID'),
    ('BO', 'T_INVOICE', 'PERSON_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_INVOICE', 'PROMO_CODE_ID', 'BO', 'T_PROMO_CODE', 'ID'),
    ('BO', 'T_INVOICE', 'REQUEST_ID', 'BO', 'T_REQUEST', 'ID'),
    ('BO', 'T_INVOICE_ORDER', 'PROMO_CODE_ID', 'BO', 'T_PROMO_CODE', 'ID'),
    ('BO', 'T_INVOICE_PAY_DT_EXTENSION', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_INVOICE_PAY_DT_EXTENSION', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_INVOICE_REFUND', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_INVOICE_REGISTER_ROW', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_INVOICE_REGISTER_ROW', 'REF_INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_INVOICE_TEMPLATE', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_INVOICE_TEMPLATE', 'OPER_UID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_KLADR_MIG', 'ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_OBJECT_BATCH_ITEM', 'BATCH_ID', 'BO', 'T_OBJECT_BATCH', 'BATCH_ID'),
    ('BO', 'T_OPERATION', 'COVERAGE_ID', 'BO', 'T_HASH_DATA', 'ID'),
    ('BO', 'T_OPERATION', 'CREATE_TRACEBACK_ID', 'BO', 'T_HASH_DATA', 'ID'),
    ('BO', 'T_OPERATION', 'DST_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_OPERATION', 'INSERT_TRACEBACK_ID', 'BO', 'T_HASH_DATA', 'ID'),
    ('BO', 'T_OPERATION', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_OPERATION', 'PARENT_OPERATION_ID', 'BO', 'T_OPERATION', 'ID'),
    ('BO', 'T_OPERATION', 'SRC_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_OPERATION', 'STATUS_ID', 'BO', 'T_OPERATION_STATUS', 'ID'),
    ('BO', 'T_OPERATION', 'TYPE_ID', 'BO', 'T_OPERATION_TYPE', 'ID'),
    ('BO', 'T_ORDER', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ORDER', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_ORDER', 'GROUP_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ORDER', 'LINKED_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ORDER', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_ORDER', 'RESPONSIBLE_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ORDER', 'SERVICE_PRODUCT_ID', 'BO', 'T_SERVICE_PRODUCT', 'ID'),
    ('BO', 'T_ORDER_GEOCONTEXT_DATA', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_ORDER_GEOCONTEXT_DATA', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ORDER_INVOICE_CACHE', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_ORDER_INVOICE_CACHE', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ORDER_MANAGER', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_OVERDRAFT_PARAMS', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_OVERDRAFT_PARAMS', 'PAYMENT_METHOD_CC', 'META', 'T_PAYMENT_METHOD', 'CC'),
    ('BO', 'T_OVERDRAFT_PARAMS', 'PERSON_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_OVERDRAFT_PARAMS', 'SERVICE_ID', 'META', 'T_SERVICE', 'ID'),
    ('BO', 'T_PARTNER_MULTISHIP_STAT', 'CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_PARTNER_MULTISHIP_STAT', 'PRODUCT_ID', 'BO', 'T_PRODUCT', 'ID'),
    ('BO', 'T_PARTNER_PAGE', 'PAGE_ID', 'BO', 'T_PAGE_DATA', 'PAGE_ID'),
    ('BO', 'T_PARTNER_REGISTER', 'PARTNER_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_PARTNER_REGISTER_LINE', 'REGISTER_ID', 'BO', 'T_PARTNER_REGISTER', 'ID'),
    ('BO', 'T_PARTNER_TAXI_STAT_PART', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_PAYCASH_PAYMENT_V3', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_PAYMASTER_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_PAYMASTER_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_PAYMENT', 'CHARGEBACK_LINE_ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_PAYMENT', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_PAYMENT', 'PARTNER_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_PAYMENT', 'PAYSYS_CODE', 'BO', 'T_INSTANT_PAYSYS', 'CODE'),
    ('BO', 'T_PAYMENT', 'REGISTER_ID', 'BO', 'T_PAYMENT_REGISTER', 'ID'),
    ('BO', 'T_PAYMENT', 'REGISTER_LINE_ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_PAYMENT_REGISTER', 'INCOMING_MAIL_ID', 'BO', 'T_INCOMING_MAIL', 'ID'),
    ('BO', 'T_PAYMENT_REGISTER', 'PAYSYS_CODE', 'BO', 'T_INSTANT_PAYSYS', 'CODE'),
    ('BO', 'T_PAYMENT_REGISTER', 'RAW_REGISTER_ID', 'BO', 'T_RAW_REGISTER', 'ID'),
    ('BO', 'T_PAYMENT_REGISTER_LINE', 'PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_PAYMENT_REGISTER_LINE', 'PAYSYS_CODE', 'BO', 'T_INSTANT_PAYSYS', 'CODE'),
    ('BO', 'T_PAYMENT_REGISTER_LINE', 'RAW_REGISTER_LINE_ID', 'BO', 'T_RAW_REGISTER_LINE', 'ID'),
    ('BO', 'T_PAYMENT_REGISTER_LINE', 'REGISTER_ID', 'BO', 'T_PAYMENT_REGISTER', 'ID'),
    ('BO', 'T_PAYMETHOD_AUTH_TYPE', 'PAYMETHOD_ID', 'BO', 'T_PAYMETHOD', 'ID'),
    ('BO', 'T_PAYMETHOD_COMMISSION', 'PAYMETHOD_ID', 'BO', 'T_PAYMETHOD', 'ID'),
    ('BO', 'T_PAYPAL_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_PAYSYS_SETTINGS', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PAYSYS_SETTINGS', 'PAYMENT_METHOD_ID', 'META', 'T_PAYMENT_METHOD', 'ID'),
    ('BO', 'T_PAYSYS_SETTINGS', 'PAYSYS_GROUP_ID', 'BO', 'T_PAYSYS_GROUP', 'ID'),
    ('BO', 'T_PAYSYS_SETTINGS', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_PAYSYS_SORT', 'PAYMENT_METHOD_ID', 'META', 'T_PAYMENT_METHOD', 'ID'),
    ('BO', 'T_PAYSYS_SORT', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_PAYSYS_SORT', 'SERVICE_ID', 'META', 'T_SERVICE', 'ID'),
    ('BO', 'T_PAY_POLICY_FIRM', 'CATEGORY', 'BO', 'T_PERSON_CATEGORY', 'CATEGORY'),
    ('BO', 'T_PAY_POLICY_FIRM', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PAY_POLICY_FIRM', 'PAY_POLICY_ID', 'BO', 'T_PAY_POLICY', 'ID'),
    ('BO', 'T_PAY_POLICY_PART', 'CATEGORY', 'BO', 'T_PERSON_CATEGORY', 'CATEGORY'),
    ('BO', 'T_PAY_POLICY_PART', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PAY_POLICY_PAYMETHOD', 'PAYMENT_METHOD_ID', 'META', 'T_PAYMENT_METHOD', 'ID'),
    ('BO', 'T_PAY_POLICY_PAYMETHOD', 'PAYSYS_GROUP_ID', 'BO', 'T_PAYSYS_GROUP', 'ID'),
    ('BO', 'T_PAY_POLICY_PAYMETHOD', 'PAY_POLICY_PART_ID', 'BO', 'T_PAY_POLICY_PART', 'ID'),
    ('BO', 'T_PAY_POLICY_ROUTING', 'PAY_POLICY_PART_ID', 'BO', 'T_PAY_POLICY_PART', 'ID'),
    ('BO', 'T_PAY_POLICY_ROUTING', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_PAY_POLICY_ROUTING', 'SERVICE_ID', 'META', 'T_SERVICE', 'ID'),
    ('BO', 'T_PERSON', 'TYPE', 'BO', 'T_PERSON_CATEGORY', 'CATEGORY'),
    ('BO', 'T_PERSON_CATEGORY', 'PAY_POLICY_ID', 'BO', 'T_PAY_POLICY', 'ID'),
    ('BO', 'T_PERSON_CATEGORY', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('BO', 'T_PERSON_FIRM', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PERSON_FIRM', 'PERSON_ID', 'BO', 'T_PERSON', 'ID'),
    ('BO', 'T_PLACE', 'CLID_TYPE', 'BO', 'T_DISTRIBUTION_CLID_TYPES', 'ID'),
    ('BO', 'T_PLACE', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_PLACE', 'PAYMENT_TYPE', 'BO', 'T_DISTRIBUTION_PRODUCTS', 'ID'),
    ('BO', 'T_PLACE', 'TAG_ID', 'BO', 'T_DISTRIBUTION_TAG', 'ID'),
    ('BO', 'T_PROMO_ACTION_USAGE', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_PROMO_ACTION_USAGE', 'PROMO_ACTION_ID', 'BO', 'T_PROMO_ACTION', 'ID'),
    ('BO', 'T_PROMO_CODE', 'EVENT_ID', 'BO', 'T_PROMO_CODE_EVENT', 'ID'),
    ('BO', 'T_PROMO_CODE', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PROMO_CODE', 'GROUP_ID', 'BO', 'T_PROMO_CODE_GROUP', 'ID'),
    ('BO', 'T_PROMO_CODE', 'SERIES', 'BO', 'T_PROMO_CODE_SERIES', 'ID'),
    ('BO', 'T_PROMO_CODE_GROUP', 'EVENT_ID', 'BO', 'T_PROMO_CODE_EVENT', 'ID'),
    ('BO', 'T_PROMO_CODE_GROUP', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_PROMO_CODE_RESERVATION', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_PROMO_CODE_RESERVATION', 'PROMOCODE_ID', 'BO', 'T_PROMO_CODE', 'ID'),
    ('BO', 'T_PYCRON_LOCK', 'NAME', 'BO', 'T_PYCRON_DESCR', 'NAME'),
    ('BO', 'T_PYCRON_RESPONSIBLE', 'TASK_NAME', 'BO', 'T_PYCRON_DESCR', 'NAME'),
    ('BO', 'T_PYCRON_SCHEDULE', 'NAME', 'BO', 'T_PYCRON_DESCR', 'NAME'),
    ('BO', 'T_PYCRON_STATE', 'ID', 'BO', 'T_PYCRON_LOCK', 'ID'),
    ('BO', 'T_QIWICAB_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_QIWICAB_PAY_REGISTER_LINE', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_QIWICAB_PAY_REGISTER_LINE', 'PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_QIWI_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_RAW_REGISTER', 'INCOMING_MAIL_ID', 'BO', 'T_INCOMING_MAIL', 'ID'),
    ('BO', 'T_RAW_REGISTER_LINE', 'RAW_REGISTER_ID', 'BO', 'T_RAW_REGISTER', 'ID'),
    ('BO', 'T_RBS_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_RBS_PAYMENT', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_RECEIPT', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_REFUND', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_REFUND', 'ORIG_PAYMENT_ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_REPAYMENT_ORDER', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_REPAYMENT_ORDER', 'REQUEST_ID', 'BO', 'T_REQUEST', 'ID'),
    ('BO', 'T_REPORT', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_REQUEST', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_REQUEST', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_REQUEST', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_REQUEST_ORDER', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_REQUEST_ORDER', 'PARENT_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_REQUEST_REGISTER_ROW', 'REF_INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_REQUEST_REGISTER_ROW', 'REQUEST_ID', 'BO', 'T_REQUEST', 'ID'),
    ('BO', 'T_REVERSE', 'PARENT_ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_REVERSE_COMPLETION', 'ORDER_ID', 'BO', 'T_ORDER', 'ID'),
    ('BO', 'T_ROLE', 'PERM', 'BO', 'T_PERMITION', 'PERM'),
    ('BO', 'T_ROLE', 'ROLE_ID', 'BO', 'T_ROLE_NAME', 'ID'),
    ('BO', 'T_ROLE_CLIENT_USER', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_ROLE_CLIENT_USER', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_ROLE_CLIENT_USER', 'ROLE_ID', 'BO', 'T_ROLE_NAME', 'ID'),
    ('BO', 'T_ROLE_GROUP', 'FIRM_ID', 'META', 'T_FIRM', 'ID'),
    ('BO', 'T_ROLE_GROUP', 'ROLE_ID', 'BO', 'T_ROLE_NAME', 'ID'),
    ('BO', 'T_ROLE_USER', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_ROLE_USER', 'ROLE_ID', 'BO', 'T_ROLE_NAME', 'ID'),
    ('BO', 'T_SERVICE_CLIENT', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_SERVICE_CLIENT', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_SERVICE_DISCOUNT_TYPES', 'DISCOUNT_TYPE_ID', 'META', 'T_DISCOUNT_TYPE', 'ID'),
    ('BO', 'T_SERVICE_PAYMETHOD', 'PAYMETHOD_ID', 'BO', 'T_PAYMETHOD', 'ID'),
    ('BO', 'T_SERVICE_PRICE', 'SERVICE_PRODUCT_ID', 'BO', 'T_SERVICE_PRODUCT', 'ID'),
    ('BO', 'T_SERVICE_PRODUCT', 'PARENT_ID', 'BO', 'T_SERVICE_PRODUCT', 'ID'),
    ('BO', 'T_SERVICE_PRODUCT', 'PARTNER_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_SHIPMENT_ACCEPTED', 'SERVICE_ID', 'BO', 'T_SHIPMENT', 'SERVICE_ID'),
    ('BO', 'T_SHIPMENT_ACCEPTED', 'SERVICE_ID', 'BO', 'T_SHIPMENT', 'SERVICE_ORDER_ID'),
    ('BO', 'T_SHIPMENT_ACCEPTED', 'SERVICE_ORDER_ID', 'BO', 'T_SHIPMENT', 'SERVICE_ID'),
    ('BO', 'T_SHIPMENT_ACCEPTED', 'SERVICE_ORDER_ID', 'BO', 'T_SHIPMENT', 'SERVICE_ORDER_ID'),
    ('BO', 'T_SUBAGENCY', 'AGENCY_CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_SUBAGENCY', 'BUDGET_CONTRACT_ID', 'BO', 'T_CONTRACT2', 'ID'),
    ('BO', 'T_SUBAGENCY', 'SUBAGENCY_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_T2', 'ID2', 'BO', 'T_T1', 'ID'),
    ('BO', 'T_TARIFF', 'TARIFF_GROUP_ID', 'BO', 'T_TARIFF_GROUP', 'ID'),
    ('BO', 'T_TARIFF_GROUP', 'SERVICE_ID', 'BO', 'BAK_T_SERVICE', 'ID'),
    ('BO', 'T_USER_GROUP', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_VERIFICATION_CODE', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('BO', 'T_VFL', 'INVOICE_ID', 'BO', 'T_INVOICE', 'ID'),
    ('BO', 'T_WEBMONEY_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_WEBMONEY_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_WINSTORE_INAPP_PAYMENT', 'ID', 'BO', 'T_PAYMENT', 'ID'),
    ('BO', 'T_YAMONEY_PAY_REGISTER_LINE', 'ID', 'BO', 'T_PAYMENT_REGISTER_LINE', 'ID'),
    ('BO', 'T_YAMONEY_WALLET', 'CLIENT_ID', 'BO', 'T_CLIENT', 'ID'),
    ('BO', 'T_YAMONEY_WALLET', 'PASSPORT_ID', 'BO', 'T_ACCOUNT', 'PASSPORT_ID'),
    ('META', 'T_ACQUIRER_TERMINAL_LINK', 'ACQUIRER_TERMINAL_ID', 'META', 'T_ACQUIRER_TERMINAL', 'ID'),
    ('META', 'T_ACQUIRER_TERMINAL_LINK', 'TERMINAL_ID', 'META', 'T_TERMINAL', 'ID'),
    ('META', 'T_BALANCE_SERVICE', 'ID', 'META', 'T_SERVICE', 'ID'),
    ('META', 'T_FIRM', 'REGION_ID', 'META', 'T_COUNTRY', 'REGION_ID'),
    ('META', 'T_FISCAL_SERVICE', 'ID', 'META', 'T_SERVICE', 'ID'),
    ('META', 'T_MCC_CODE', 'GROUP_ID', 'META', 'T_MCC_GROUP', 'ID'),
    ('META', 'T_SERVICE_TERMINAL', 'TERMINAL_ID', 'META', 'T_TERMINAL', 'ID'),
    ('META', 'T_TERMINAL', 'PAYMENT_METHOD_ID', 'META', 'T_PAYMENT_METHOD', 'ID'),
    ('META', 'T_TERMINAL', 'PROCESSING_ID', 'META', 'T_PROCESSING', 'ID'),
    ('META', 'T_TERMINAL_COMMISSION_LINK', 'TERMINAL_COMMISSION_ID', 'META', 'T_TERMINAL_COMMISSION', 'ID'),
    ('META', 'T_TERMINAL_COMMISSION_LINK', 'TERMINAL_ID', 'META', 'T_TERMINAL', 'ID'),
    ('META', 'T_TRUST_SERVICE', 'ID', 'META', 'T_SERVICE', 'ID'),
    ('META', 'T_TRUST_SERVICE', 'SCHEMA_NAME', 'META', 'T_SERVICE_SCHEMA', 'NAME'),
    ('META', 'T_TRUST_SERVICE', 'TRUST_SERVICE_GROUP_ID', 'META', 'T_TRUST_SERVICE_GROUP', 'ID'),
    ('META', 'T_TVM_APPLICATION', 'SERVICE_ID', 'META', 'T_SERVICE', 'ID'),
    ('META', 'T_TVM_APPLICATION', 'TRUST_SERVICE_GROUP_ID', 'META', 'T_TRUST_SERVICE_GROUP', 'ID'),
    ('META', 'T_TVM_APPLICATION_MAP', 'DST_ID', 'META', 'T_TVM_APPLICATION', 'ID'),
    ('META', 'T_TVM_APPLICATION_MAP', 'SRC_ID', 'META', 'T_TVM_APPLICATION', 'ID'),
]


def test_constraints_enabled(session):
    query = """
        select
          c.owner, c.table_name, cc.column_name,
          r.owner, r.table_name, rc.column_name
        from all_constraints c
        join all_cons_columns cc on cc.constraint_name = c.constraint_name
        join all_constraints r on c.r_constraint_name = r.constraint_name
        join all_cons_columns rc on rc.constraint_name = r.constraint_name
        where c.constraint_type = 'R'
          and c.status = 'ENABLED'
          and c.owner in ('BO', 'META')
    """

    actual = set(map(tuple, session.execute(query)))
    missing = []
    for constraint_tuple in EXPECTED_CONSTRAINTS:
        if constraint_tuple not in actual:
            missing.append(
                '{}.{}.{} -> {}.{}.{}'.format(*constraint_tuple)
            )

    assert not missing


EXPECTED_TRUNCATED_TABLES = [
    # Пока в эти таблицы пишут тесты траста :(
    # 'BO.T_ACCOUNT', 'BO.T_CCARD_BOUND_PAYMENT', 'BO.T_CLIENT', 'BO.T_ORDER', 'BO.T_PAYMENT', 'BO.T_REFUND',
    # 'BO.T_REFUND', 'BO.T_REQUEST', 'BO.T_REQUEST_ORDER', 'BO.T_ROLE_USER', 'BO.T_SERVICE_CLIENT',
    # 'BO.T_SERVICE_PRICE', 'BO.T_SERVICE_PRODUCT', 'BO.T_EXPORT', 'BO.T_EXPORT_HISTORY_2', 'BO.T_PROMO_CODE',
    # 'BO.T_CONTRACT2', 'BO.T_CONTRACT_COLLATERAL', 'BO.T_CONTRACT_ATTRIBUTES', 'BO.T_RAW_REGISTER_LINE',
    # 'BO.T_PAYMENT_FRAUD_STATUS',

    'BO.T_ACL_2', 'BO.T_ACTED_COMPLETION', 'BO.T_ACT_INTERNAL', 'BO.T_ACT_REFUNDMENT', 'BO.T_ACT_TRANS',
    'BO.T_APPLE_INAPP_PAYMENT', 'BO.T_ASSIST_REESTR', 'BO.T_BAD_DEBT_ACT', 'BO.T_BANNED_CLIENT', 'BO.T_CART_ITEM',
    'BO.T_CCARD_SIX_PAYMENT', 'BO.T_CCARD_SIX_PAY_REGISTER_LINE', 'BO.T_CCARD_TUR_PAYMENT',
    'BO.T_CCARD_UA_PAYMENT', 'BO.T_CCARD_UA_PAY_REGISTER_LINE', 'BO.T_CCARD_USA_PAYMENT',
    'BO.T_CCARD_USA_PAY_REGISTER_LINE',  'BO.T_CLIENT_BANK', 'BO.T_CLIENT_DIRECT_BUDGET',
    'BO.T_CLIENT_FRAUD_STATUS', 'BO.T_CLIENT_GROUP', 'BO.T_CLIENT_LINK_HISTORY', 'BO.T_CLIENT_OVERDRAFT',
    'BO.T_COMPLETION_HISTORY', 'BO.T_COMPLETION_HISTORY_2015', 'BO.T_COMPLETION_HISTORY_OLD', 'BO.T_CONSUME',
    'BO.T_CRPAYMENT_INVOICE', 'BO.T_CRPAYMENT_OEBS_BONUS', 'BO.T_CRPAYMENT_OEBS_DATA', 'BO.T_CRPAYMENT_OEBS_NC_BONUS',
    'BO.T_CRPAYMENT_REPORT', 'BO.T_DEFERPAY', 'BO.T_ECOMPAY_REGISTER_LINE', 'BO.T_ECOM_PAYMENT', 'BO.T_ENDBUYER_BUDGET',
    'BO.T_ENDBUYER_ORDER', 'BO.T_ENDBUYER_SUBCLIENT', 'BO.T_FIRM_INTERBRANCH', 'BO.T_FISCAL_RECEIPT',
    'BO.T_GOOGLE_INAPP_PAYMENT', 'BO.T_INVOICE', 'BO.T_INVOICE_ORDER', 'BO.T_INVOICE_PAY_DT_EXTENSION',
    'BO.T_INVOICE_REFUND', 'BO.T_INVOICE_REGISTER_ROW', 'BO.T_INVOICE_TEMPLATE', 'BO.T_KLADR_MIG', 'BO.T_OPERATION',
    'BO.T_ORDER_GEOCONTEXT_DATA', 'BO.T_ORDER_INVOICE_CACHE', 'BO.T_ORDER_MANAGER',
    'BO.T_OVERDRAFT_PARAMS', 'BO.T_PAID_ACTS', 'BO.T_PARTNER_MULTISHIP_STAT', 'BO.T_PARTNER_REGISTER',
    'BO.T_PARTNER_REGISTER_LINE', 'BO.T_PARTNER_TAXI_STAT_PART', 'BO.T_PAYCASH_PAYMENT_V3', 'BO.T_PAYMASTER_PAYMENT',
    'BO.T_PAYMASTER_PAY_REGISTER_LINE', 'BO.T_PAYMENT_REGISTER_LINE', 'BO.T_PAYPAL_PAYMENT',
    'BO.T_PERSON', 'BO.T_PERSON_FIRM', 'BO.T_PLACE', 'BO.T_PROMO_ACTION_USAGE', 'BO.T_PROMO_CODE_RESERVATION',
    'BO.T_QIWICAB_PAY_REGISTER_LINE', 'BO.T_QIWI_PAYMENT', 'BO.T_RBS_PAYMENT', 'BO.T_RECEIPT',
    'BO.T_REPAYMENT_ORDER', 'BO.T_REPORT', 'BO.T_REQUEST_REGISTER_ROW',
    'BO.T_REVERSE', 'BO.T_REVERSE_COMPLETION', 'BO.T_ROLE_CLIENT_USER',
    'BO.T_SHIPMENT', 'BO.T_SHIPMENT_ACCEPTED', 'BO.T_SUBAGENCY', 'BO.T_NIRVANA_BLOCK',
    'BO.T_USER_GROUP', 'BO.T_VERIFICATION_CODE', 'BO.T_VFL', 'BO.T_WEBMONEY_PAYMENT', 'BO.T_WEBMONEY_PAY_REGISTER_LINE',
    'BO.T_WINSTORE_INAPP_PAYMENT', 'BO.T_YAMONEY_PAY_REGISTER_LINE', 'BO.T_YAMONEY_WALLET', 'BO.T_MESSAGE',
    'BO.T_THIRDPARTY_TRANSACTIONS', 'BO.T_PARTNER_BALANCE_CACHE', 'BO.T_PARTNER_DSP_STAT', 'BO.T_PARTNER_TAGS_STAT3',
    'BO.MV_OEBS_AGENT_PAYMENT_DATA_NG3', 'BO.T_SHIPMENT_FAILED', 'BO.T_ORDER_CACHE', 'BO.T_PARTNER_COMPLETION_BUFFER',
    'BO.T_OEBS_CASH_PAYMENT_FACT', 'BO.T_PARTNER_ACT_DATA',
    'BO.T_RESTRICTED_DOMAIN', 'BO.T_ROLE_GROUP', 'BO.T_NIRVANA_MNCLOSE_SYNC', 'BO.T_PARTNER_ZEN_STAT',
    # https://st.yandex-team.ru/BALANCE-34957
    # 'BO.T_ENTITY_COMPLETION',
    'BO.T_ENTITY_COMPLETION_INT', 'BO.T_PARTNER_TAXI_STAT', 'BO.T_PARTNER_TAXI_STAT_PART',
    'BO.T_PARTNER_TAXI_STAT_AGGR', 'BO.T_PARTNER_TAXI_STAT_AGGR_TLOG',
    'BO.T_PARTNER_AVIA_SHOW', 'BO.T_PARTNER_DSP_TURNOVER', 'BO.T_THIRDPARTY_CORRECTIONS',
    'BO.T_PARTNER_TAGS_STAT', 'BO.T_PARTNER_TAGS_STAT3_INT', 'BO.T_PARTNER_AVIA_CLICK', 'BO.T_CRPAYMENT',
]


def test_tables_are_truncated(session):
    not_empty_tables = []
    for table in EXPECTED_TRUNCATED_TABLES:
        try:
            rows_count = session.execute(
                'select count(*) from {}'.format(table)
            ).scalar()
        except DatabaseError as e:
            # ORA-00942: table or view does not exist
            if e.orig.args[0].code == 942:
                continue
            raise
        if rows_count > 1000:
            not_empty_tables.append(table)

    assert not not_empty_tables
